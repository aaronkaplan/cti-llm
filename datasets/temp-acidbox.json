{"type": "bundle", "id": "bundle--6f40d0d9-a0a0-491d-9ba7-33419281da2a", "spec_version": "2.0", "objects": [{"type": "report", "id": "report--e06ff13e-810a-4f46-be1c-0ede839825d0", "created": "2020-06-04T15:11:37.652Z", "modified": "2021-09-29T15:55:04.815Z", "name": "AcidBox Malware", "description": "When the news broke in 2014 about a new sophisticated threat actor dubbed Turla, its kernelmode malware became also the first publicly described case which abuses a 3rd party device driver to disable Driver Signature Enforcement (DSE). This security mechanism was introduced in Windows Vista to prevent unsigned drivers from loading into kernel space. Turla exploited the signed VirtualBox driver VBoxDrv.sys v1.6.2 to deactivate DSE and load its unsigned payload drivers afterwards. According to the Estonian foreign intelligence service, Turla is believed to have Russian origins and operates on behalf of the FSB.\n\nThere is some confusion about this exploit as it\u2019s often generally referred to as CVE-2008-3431. Actually, the exploit used by Turla abuses two vulnerabilities of which only one was fixed in the aforementioned CVE. The other vulnerability was found by Turla authors and is used in the first version of their exploit along with CVE-2008-3431. The second version of their exploit, presumably introduced in 2014 of their kernelmode malware, only uses the unpatched vulnerability which we will discuss in more detail later.\n\nThis unpatched vulnerability can be exploited not only in VirtualBox VBoxDrv.sys driver v1.6.2, but also in all other versions smaller v3.0.0. This was also discovered by a yet unknown threat actor which targeted at least two different Russian organizations in 2017. The actors used a previously unknown malware family we have dubbed AcidBox - with the first part being an anagram of the malware\u2019s driver device name and the second part taken from VirtualBox. Because of the malware\u2019s complexity, its rarity and the fact that it\u2019s part of a bigger toolset, we believe it is used by an advanced threat actor for targeted attacks.\n\nAcidBox is a complex modular toolkit of which we have only some components. The toolkit consists of 64-bit usermode DLL files - one type of which appears to be an orchestrator containing the vulnerable VirtualBox driver and the AcidBox kernelmode component embedded. The VirtualBox driver is dropped to disk, loaded, and exploited in order to load the unsigned malware driver.\n\nHow the orchestrator DLL is loaded remains unknown, we only know that a passed parameter is checked by the DLL and it wont execute properly without it. The orchestrator and the other DLL modules also depend on registry keys to be present on the system in order to fully execute. These registry paths are present as encrypted strings in the resource sections and must be created by an unknown file or dropper at an earlier stage. The registry values contain encrypted data blobs that contain additional modules to be injected into a given process as well as additional data.", "published": "2020-07-30T16:55:51.309Z", "object_refs": ["intrusion-set--1541c4c8-a0c4-435f-aff8-60cecf72367a", "report--807b8b8f-2bcc-44fc-a9be-e31c7b1b855b"], "labels": ["intrusion-set"]}, {"type": "intrusion-set", "id": "intrusion-set--1541c4c8-a0c4-435f-aff8-60cecf72367a", "created": "2020-06-08T12:22:43.326Z", "modified": "2020-06-08T12:22:55.313Z", "name": "AcidBox"}, {"type": "attack-pattern", "id": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2020-02-05T16:27:37.784Z", "modified": "2020-02-10T19:51:01.601Z", "name": "T1553.002: Code Signing", "description": "Adversaries may create, acquire, or steal code signing materials to sign their malware or tools. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. (Citation: Wikipedia Code Signing) The certificates used during an operation may be created, acquired, or stolen by the adversary. (Citation: Securelist Digital Certificates) (Citation: Symantec Digital Certificates) Unlike [Invalid Code Signature](https://attack.mitre.org/techniques/T1036/001), this activity will result in a valid signature.\n\nCode signing to verify software on first run can be used on modern Windows and macOS/OS X systems. It is not used on Linux due to the decentralized nature of the platform. (Citation: Wikipedia Code Signing) \n\nCode signing certificates may be used to bypass security policies that require signed code to execute on a system. ", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "installation"}, {"kill_chain_name": "mitre-attack", "phase_name": "defense-evasion"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1553/002", "external_id": "T1553.002"}, {"source_name": "Wikipedia Code Signing", "url": "https://en.wikipedia.org/wiki/Code_signing", "description": "Wikipedia. (2015, November 10). Code Signing. Retrieved March 31, 2016."}, {"source_name": "Securelist Digital Certificates", "url": "https://securelist.com/why-you-shouldnt-completely-trust-files-signed-with-digital-certificates/68593/", "description": "Ladikov, A. (2015, January 29). Why You Shouldn\u2019t Completely Trust Files Signed with Digital Certificates. Retrieved March 31, 2016."}, {"source_name": "Symantec Digital Certificates", "url": "http://www.symantec.com/connect/blogs/how-attackers-steal-private-keys-digital-certificates", "description": "Shinotsuka, H. (2013, February 22). How Attackers Steal Private Keys from Digital Certificates. Retrieved March 31, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Collect and analyze signing certificate metadata on software that executes within the environment to look for unusual certificate characteristics and outliers.", "x_mitre_platforms": ["macOS", "Windows"], "x_mitre_data_sources": ["File: File Metadata"], "x_mitre_is_subtechnique": true, "x_mitre_defense_bypassed": ["Windows User Account Control"], "x_mitre_version": "1.0", "x_panw_parent_technique": "Subvert Trust Controls", "x_panw_parent_technique_subtechnique": "Subvert Trust Controls: Code Signing"}, {"type": "attack-pattern", "id": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2017-12-14T16:46:06.044Z", "modified": "2020-07-09T14:42:23.122Z", "name": "T1140: Deobfuscate/Decode Files or Information", "description": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system.\n\nOne such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016)\n\nSometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "installation"}, {"kill_chain_name": "mitre-attack", "phase_name": "defense-evasion"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1140", "external_id": "T1140"}, {"source_name": "Malwarebytes Targeted Attack against Saudi Arabia", "url": "https://blog.malwarebytes.com/cybercrime/social-engineering-cybercrime/2017/03/new-targeted-attack-saudi-arabia-government/", "description": "Malwarebytes Labs. (2017, March 27). New targeted attack against Saudi Arabia Government. Retrieved July 3, 2017."}, {"source_name": "Carbon Black Obfuscation Sept 2016", "url": "https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/", "description": "Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018."}, {"source_name": "Volexity PowerDuke November 2016", "url": "https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/", "description": "Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Detecting the action of deobfuscating or decoding files or information may be difficult depending on the implementation. If the functionality is contained within malware and uses the Windows API, then attempting to detect malicious behavior before or after the action may yield better results than attempting to perform analysis on loaded libraries or API calls. If scripts are used, then collecting the scripts for analysis may be necessary. Perform process and command-line monitoring to detect potentially malicious behavior related to scripts and system utilities such as [certutil](https://attack.mitre.org/software/S0160).\n\nMonitor the execution file paths and command-line arguments for common archive file applications and extensions, such as those for Zip and RAR archive tools, and correlate with other suspicious behavior to reduce false positives from normal user and administrator behavior.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_data_sources": ["File: File Modification", "Process: Process Creation", "Script: Script Execution"], "x_mitre_is_subtechnique": false, "x_mitre_permissions_required": ["User"], "x_mitre_defense_bypassed": ["Anti-virus", "Host intrusion prevention systems", "Network intrusion detection system", "Signature-based detection"], "x_mitre_contributors": ["Matthew Demaske, Adaptforward", "Red Canary"], "x_mitre_version": "1.1"}, {"type": "attack-pattern", "id": "attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2020-01-24T17:16:11.806Z", "modified": "2020-03-25T15:42:48.910Z", "name": "T1547.005: Security Support Provider", "description": "Adversaries may abuse security support providers (SSPs) to execute DLLs when the system boots. Windows SSP DLLs are loaded into the Local Security Authority (LSA) process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs.\n\nThe SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "act-on-objectives"}, {"kill_chain_name": "lockheed", "phase_name": "installation"}, {"kill_chain_name": "mitre-attack", "phase_name": "persistence"}, {"kill_chain_name": "mitre-attack", "phase_name": "privilege-escalation"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1547/005", "external_id": "T1547.005"}, {"source_name": "Graeber 2014", "url": "http://docplayer.net/20839173-Analysis-of-malicious-security-support-provider-dlls.html", "description": "Graeber, M. (2014, October). Analysis of Malicious Security Support Provider DLLs. Retrieved March 1, 2017."}, {"source_name": "Microsoft Configure LSA", "url": "https://technet.microsoft.com/en-us/library/dn408187.aspx", "description": "Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved June 24, 2015."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Monitor the Registry for changes to the SSP Registry keys. Monitor the LSA process for DLL loads. Windows 8.1 and Windows Server 2012 R2 may generate events when unsigned SSP DLLs try to load into the LSA by setting the Registry key <code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe</code> with AuditLevel = 8. (Citation: Graeber 2014) (Citation: Microsoft Configure LSA)", "x_mitre_platforms": ["Windows"], "x_mitre_data_sources": ["Command: Command Execution", "Module: Module Load", "Windows Registry: Windows Registry Key Modification"], "x_mitre_is_subtechnique": true, "x_mitre_permissions_required": ["Administrator"], "x_mitre_version": "1.0", "x_panw_parent_technique": "Boot or Logon Autostart Execution", "x_panw_parent_technique_subtechnique": "Boot or Logon Autostart Execution: Security Support Provider"}, {"type": "attack-pattern", "id": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2017-05-31T21:31:23.587Z", "modified": "2020-08-13T20:02:49.641Z", "name": "T1112: Modify Registry", "description": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.\n\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.\n\nRegistry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)\n\nThe Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "installation"}, {"kill_chain_name": "mitre-attack", "phase_name": "defense-evasion"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1112", "external_id": "T1112"}, {"source_name": "capec", "url": "https://capec.mitre.org/data/definitions/203.html", "external_id": "CAPEC-203"}, {"source_name": "Microsoft Reg", "url": "https://technet.microsoft.com/en-us/library/cc732643.aspx", "description": "Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015."}, {"source_name": "Microsoft Reghide NOV 2006", "url": "https://docs.microsoft.com/sysinternals/downloads/reghide", "description": "Russinovich, M. & Sharkey, K. (2006, January 10). Reghide. Retrieved August 9, 2018."}, {"source_name": "TrendMicro POWELIKS AUG 2014", "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/poweliks-malware-hides-in-windows-registry/", "description": "Santos, R. (2014, August 1). POWELIKS: Malware Hides In Windows Registry. Retrieved August 9, 2018."}, {"source_name": "SpectorOps Hiding Reg Jul 2017", "url": "https://posts.specterops.io/hiding-registry-keys-with-psreflect-b18ec5ac8353", "description": "Reitz, B. (2017, July 14). Hiding Registry keys with PSReflect. Retrieved August 9, 2018."}, {"source_name": "Microsoft Remote", "url": "https://technet.microsoft.com/en-us/library/cc754820.aspx", "description": "Microsoft. (n.d.). Enable the Remote Registry Service. Retrieved May 1, 2015."}, {"source_name": "Microsoft 4657 APR 2017", "url": "https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4657", "description": "Miroshnikov, A. & Hall, J. (2017, April 18). 4657(S): A registry value was modified. Retrieved August 9, 2018."}, {"source_name": "Microsoft RegDelNull July 2016", "url": "https://docs.microsoft.com/en-us/sysinternals/downloads/regdelnull", "description": "Russinovich, M. & Sharkey, K. (2016, July 4). RegDelNull v1.11. Retrieved August 10, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). (Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\n\nMonitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001), which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nMonitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. (Citation: Microsoft Reghide NOV 2006) Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) and RegDelNull (Citation: Microsoft RegDelNull July 2016).", "x_mitre_platforms": ["Windows"], "x_mitre_data_sources": ["Command: Command Execution", "Process: OS API Execution", "Process: Process Creation", "Windows Registry: Windows Registry Key Creation", "Windows Registry: Windows Registry Key Deletion", "Windows Registry: Windows Registry Key Modification"], "x_mitre_is_subtechnique": false, "x_mitre_permissions_required": ["Administrator", "SYSTEM", "User"], "x_mitre_defense_bypassed": ["Host forensic analysis"], "x_mitre_contributors": ["Bartosz Jerzman", "David Lu, Tripwire", "Travis Smith, Tripwire"], "x_mitre_version": "1.2"}, {"type": "attack-pattern", "id": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2017-05-31T21:30:55.066Z", "modified": "2021-04-22T16:13:34.896Z", "name": "T1068: Exploitation for Privilege Escalation", "description": "Adversaries may exploit software vulnerabilities in an attempt to elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions.\n\nWhen initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This could also enable an adversary to move from a virtualized environment, such as within a virtual machine or container, onto the underlying host. This may be a necessary step for an adversary compromising an endpoint system that has been properly configured and limits other privilege escalation methods.\n\nAdversaries may bring a signed vulnerable driver onto a compromised machine so that they can exploit the vulnerability to execute code in kernel mode. This process is sometimes referred to as Bring Your Own Vulnerable Driver (BYOVD).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020) Adversaries may include the vulnerable driver with files delivered during Initial Access or download it to a compromised system via [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) or [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570).", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "act-on-objectives"}, {"kill_chain_name": "mitre-attack", "phase_name": "privilege-escalation"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1068", "external_id": "T1068"}, {"source_name": "ESET InvisiMole June 2020", "url": "https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_InvisiMole.pdf", "description": "Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020."}, {"source_name": "Unit42 AcidBox June 2020", "url": "https://unit42.paloaltonetworks.com/acidbox-rare-malware/", "description": "Reichel, D. and Idrizovic, E. (2020, June 17). AcidBox: Rare Malware Repurposing Turla Group Exploit Targeted Russian Organizations. Retrieved March 16, 2021."}, {"source_name": "Microsoft Driver Block Rules", "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules", "description": "Microsoft. (2020, October 15). Microsoft recommended driver block rules. Retrieved March 16, 2021."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution or evidence of Discovery. Consider monitoring for the presence or loading (ex: Sysmon Event ID 6) of known vulnerable drivers that adversaries may drop and exploit to execute code in kernel mode.(Citation: Microsoft Driver Block Rules)\n\nHigher privileges are often necessary to perform additional actions such as some methods of [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Look for additional activity that may indicate an adversary has gained higher privileges.", "x_mitre_platforms": ["Containers", "Linux", "macOS", "Windows"], "x_mitre_data_sources": ["Driver: Driver Load"], "x_mitre_is_subtechnique": false, "x_mitre_permissions_required": ["User"], "x_mitre_effective_permissions": ["User"], "x_mitre_contributors": ["Idan Revivo, @idanr86, Team Nautilus Aqua Security", "Joas Antonio dos Santos, @C0d3Cr4zy, Inmetrics", "Yaniv Agman, @AgmanYaniv, Team Nautilus Aqua Security"], "x_mitre_version": "1.3"}, {"type": "attack-pattern", "id": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2017-05-31T21:30:32.662Z", "modified": "2021-04-24T13:19:18.594Z", "name": "T1027: Obfuscated Files or Information", "description": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. \n\nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as JavaScript. \n\nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016)\n\nAdversaries may also obfuscate commands executed from payloads or directly via a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017) ", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "installation"}, {"kill_chain_name": "mitre-attack", "phase_name": "defense-evasion"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1027", "external_id": "T1027"}, {"source_name": "capec", "url": "https://capec.mitre.org/data/definitions/267.html", "external_id": "CAPEC-267"}, {"source_name": "Volexity PowerDuke November 2016", "url": "https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/", "description": "Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017."}, {"source_name": "Linux/Cdorked.A We Live Security Analysis", "url": "https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/", "description": "Pierre-Marc Bureau. (2013, April 26). Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole. Retrieved September 10, 2017."}, {"source_name": "Carbon Black Obfuscation Sept 2016", "url": "https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/", "description": "Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018."}, {"source_name": "FireEye Obfuscation June 2017", "url": "https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html", "description": "Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018."}, {"source_name": "FireEye Revoke-Obfuscation July 2017", "url": "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf", "description": "Bohannon, D. & Holmes, L. (2017, July 27). Revoke-Obfuscation: PowerShell Obfuscation Detection Using Science. Retrieved February 12, 2018."}, {"source_name": "PaloAlto EncodedCommand March 2017", "url": "https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/", "description": "White, J. (2017, March 10). Pulling Back the Curtains on EncodedCommand PowerShell Attacks. Retrieved February 12, 2018."}, {"source_name": "GitHub Revoke-Obfuscation", "url": "https://github.com/danielbohannon/Revoke-Obfuscation", "description": "Bohannon, D. (2017, July 27). Revoke-Obfuscation. Retrieved February 12, 2018."}, {"source_name": "GitHub Office-Crackros Aug 2016", "url": "https://github.com/itsreallynick/office-crackros", "description": "Carr, N. (2016, August 14). OfficeCrackros. Retrieved February 12, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Detection of file obfuscation is difficult unless artifacts are left behind by the obfuscation process that are uniquely detectable with a signature. If detection of the obfuscation itself is not possible, it may be possible to detect the malicious activity that caused the obfuscated file (for example, the method that was used to write, read, or modify the file on the file system). \n\nFlag and analyze commands containing indicators of obfuscation and known suspicious syntax such as uninterpreted escape characters like '''^''' and '''\"'''. Windows' Sysmon and Event ID 4688 displays command-line arguments for processes. Deobfuscation tools can be used to detect these indicators in files/payloads. (Citation: GitHub Revoke-Obfuscation) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: GitHub Office-Crackros Aug 2016) \n\nObfuscation used in payloads for Initial Access can be detected at the network. Use network intrusion detection systems and email gateway filtering to identify compressed and encrypted attachments and scripts. Some email attachment detonation systems can open compressed and encrypted attachments. Payloads delivered over an encrypted connection from a website require encrypted network traffic inspection. \n\nThe first detection of a malicious tool may trigger an anti-virus or other security tool alert. Similar events may also occur at the boundary through network IDS, email scanning appliance, etc. The initial detection should be treated as an indication of a potentially more invasive intrusion. The alerting system should be thoroughly investigated beyond that initial alert for activity that was not detected. Adversaries may continue with an operation, assuming that individual events like an anti-virus detect will not be investigated or that an analyst will not be able to conclusively link that event to other activity occurring on the network. ", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_data_sources": ["Command: Command Execution", "Command: Command Execution", "File: File Content", "File: File Creation", "File: File Metadata", "Process: Process Creation"], "x_mitre_is_subtechnique": false, "x_mitre_defense_bypassed": ["Application control", "Application control by file name or path", "Host forensic analysis", "Host intrusion prevention systems", "Log analysis", "Signature-based detection"], "x_mitre_contributors": ["Christiaan Beek, @ChristiaanBeek", "Red Canary"], "x_mitre_version": "1.1"}, {"type": "attack-pattern", "id": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2018-04-18T17:59:24.739Z", "modified": "2020-03-28T19:06:02.690Z", "name": "T1203: Exploitation for Client Execution", "description": "Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.\n\nSeveral types exist:\n\n### Browser-based Exploitation\n\nWeb browsers are a common target through [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.\n\n### Office Applications\n\nCommon office and productivity applications such as Microsoft Office are also targeted through [Phishing](https://attack.mitre.org/techniques/T1566). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.\n\n### Common Third-party Applications\n\nOther applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "installation"}, {"kill_chain_name": "mitre-attack", "phase_name": "execution"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1203", "external_id": "T1203"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Detecting software exploitation may be difficult depending on the tools available. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the browser or Office processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_is_subtechnique": false, "x_mitre_system_requirements": ["Remote exploitation for execution requires a remotely accessible service reachable over the network or other vector of access such as spearphishing or drive-by compromise."], "x_mitre_remote_support": true, "x_mitre_version": "1.1"}, {"type": "attack-pattern", "id": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2017-05-31T21:31:16.408Z", "modified": "2020-03-20T15:42:48.595Z", "name": "T1105: Ingress Tool Transfer", "description": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "kill_chain_phases": [{"kill_chain_name": "lockheed", "phase_name": "command-and-control"}, {"kill_chain_name": "mitre-attack", "phase_name": "command-and-control"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1105", "external_id": "T1105"}, {"source_name": "University of Birmingham C2", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_detection": "Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as FTP, that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_data_sources": ["File: File Creation", "Network Traffic: Network Connection Creation", "Network Traffic: Network Traffic Content", "Network Traffic: Network Traffic Flow"], "x_mitre_is_subtechnique": false, "x_mitre_permissions_required": ["User"], "x_mitre_version": "2.0"}, {"type": "campaign", "id": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "created": "2020-06-08T12:22:43.326Z", "modified": "2020-06-08T17:57:10.848Z", "name": "Campaign 1 - AcidBox", "description": "Attacks were seen in 2017 by other security vendors. A sample was uploaded to VirusTotal in February 2019 that is related to the original samples.", "first_seen": "2017-06-01T00:00:00.000Z", "last_seen": "2017-06-01T00:00:00.000Z"}, {"type": "course-of-action", "id": "course-of-action--21ce34c9-4220-41cf-85c7-bc289bb2c79d", "name": "Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities, and set to default on medium, low, and informational vulnerabilities", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T19:00:11.067Z", "description": "Configure a Vulnerability Protection Profile set to block attacks against any critical or high vulnerabilities, at minimum, and set to default on any medium, low, or informational vulnerabilities. Configuring an alert action for low and informational, instead of default, will produce additional information at the expense of greater log utilization.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.7", "x_panw_coa_bp_title": "Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities, and set to default on medium, low, and informational vulnerabilities", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Configure a Vulnerability Protection Profile set to block attacks against any critical or high vulnerabilities, at minimum, and set to default on any medium, low, or informational vulnerabilities. Configuring an alert action for low and informational, instead of default, will produce additional information at the expense of greater log utilization.", "x_panw_coa_bp_rationale_statement": "A Vulnerability Protection Profile helps to protect assets by alerting on, or blocking, network attacks. The default action for attacks against many critical and high vulnerabilities is to only alert on the attack - not to block.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > Vulnerability Protection`.\n\nSet a Vulnerability Protection Profile to block attacks against any critical or high vulnerabilities (minimum), and to default on attacks against any medium, low, or informational vulnerabilities.", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > Vulnerability Protection`.\n\nVerify a Vulnerability Protection Profile is set to block attacks against any critical or high vulnerabilities (minimum), and set to default on attacks against any medium, low, or informational vulnerabilities.", "x_panw_coa_bp_impact_statement": "Not configuring a Vulnerability Protection Profile means that network attacks will not be logged, alerted on or blocked.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Deploy Network-based IPS Devices To Complement IDS Sensors CONTROL:v6 12.4 DESCRIPTION:Network-based IPS devices should be deployed to complement IDS by blocking known bad signatures or the behavior of potential attacks. As attacks become automated, methods such as IDS typically delay the amount of time it takes for someone to react to an attack. A properly configured network-based IPS can provide automation to block bad traffic. When evaluating network-based IPS products, include those using techniques other than signature-based detection (such as virtual machine or sandbox-based approaches) for consideration.;TITLE:Deploy Network-Based Intrusion Prevention Systems CONTROL:v7 12.7 DESCRIPTION:Deploy network-based Intrusion Prevention Systems (IPS) to block malicious network traffic at each of the organization's network boundaries.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;TITLE:Deploy Network-based IDS Sensors on DMZ Systems CONTROL:v6 12.3 DESCRIPTION:Deploy network-based IDS sensors on Internet and extranet DMZ systems and networks that look for unusual attack mechanisms and detect compromise of these systems. These network-based IDS sensors may detect attacks through the use of signatures, network behavior analysis, or other mechanisms to analyze traffic.;"], "x_panw_coa_bp_references": ["\u201cThreat Prevention Deployment Tech Note\u201d - https://live.paloaltonetworks.com/docs/DOC-3094:\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Profiles\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-profiles.html"]}, {"type": "course-of-action", "id": "course-of-action--28f61b3c-18a6-4991-8a17-7cfcd388136c", "name": "Setup File Blocking", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.803Z", "x_panw_coa_u42_id": "x.34", "x_panw_coa_u42_title": "Setup File Blocking"}, {"type": "course-of-action", "id": "course-of-action--2c886776-61fb-487c-a880-41f4b7195627", "name": "Ensure that PAN-DB URL Filtering is used", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Configure the device to use PAN-DB URL Filtering instead of BrightCloud.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.9", "x_panw_coa_bp_title": "Ensure that PAN-DB URL Filtering is used", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Configure the device to use PAN-DB URL Filtering instead of BrightCloud.", "x_panw_coa_bp_rationale_statement": "Standard URL filtering provides protection against inappropriate and malicious URLs and IP addresses. PAN-DB URL Filtering is slightly less granular than the BrightCloud URL filtering. However the PAN-DB Filter offers additional malware protection and PAN threat intelligence by using the Wildfire service as an additional input, which is currently not available in the BrightCloud URL Filtering license. This makes the PAN-DB filter more responsive to specific malware 'campaigns'.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Device > Licenses`.\n\nClick on `PAN-DB URL Filtering`.\n\nSet `Active` to `Yes`.", "x_panw_coa_bp_audit_procedure": "Navigate to `Device > Licenses`.\n\nClick on `PAN-DB URL Filtering`.\n\nVerify `Active` is set to `Yes`.", "x_panw_coa_bp_impact_statement": "Not having an effective URL Filtering configuration can leave an organization open to legal action, internal HR issues, non-compliance with regulatory policies or productivity loss.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy, Use, And Maintain Network-based URL Filters CONTROL:v6 7.6 DESCRIPTION:The organization shall maintain and enforce network based URL filters that limit a system's ability to connect to websites not approved by the organization. The organization shall subscribe to URL categorization services to ensure that they are up-to-date with the most recent website category definitions available. Uncategorized sites shall be blocked by default. This filtering shall be enforced for each of the organization's systems, whether they are physically at an organization's facilities or not.;TITLE:Maintain and Enforce Network-Based URL Filters CONTROL:v7 7.4 DESCRIPTION:Enforce network-based URL filters that limit a system's ability to connect to websites not approved by the organization. This filtering shall be enforced for each of the organization's systems, whether they are physically at an organization's facilities or not.;TITLE:Subscribe to URL-Categorization service CONTROL:v7 7.5 DESCRIPTION:Subscribe to URL categorization services to ensure that they are up-to-date with the most recent website category definitions available. Uncategorized sites shall be blocked by default.;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - URL Filtering\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html:\u201cPAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering/url-filtering-best-practices.html"]}, {"type": "course-of-action", "id": "course-of-action--2fd9769c-5e50-4528-985f-a1d117329991", "name": "Ensure that URL Filtering uses the action of \u201cblock\u201d or \u201coverride\u201d on the <enterprise approved value> URL categories", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Ideally, deciding which URL categories to block, and which to allow, is a joint effort between IT and another entity of authority within an organization\u2014such as the legal department or administration. For most organizations, blocking or requiring an override on the following categories represents a minimum baseline: adult, hacking, command-and-control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-and-anonymizers, and parked. Some organizations may add 'unknown' and 'dynamic-dns' to this list, at the expense of some support calls on those topics.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.10", "x_panw_coa_bp_title": "Ensure that URL Filtering uses the action of \u201cblock\u201d or \u201coverride\u201d on the <enterprise approved value> URL categories", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Ideally, deciding which URL categories to block, and which to allow, is a joint effort between IT and another entity of authority within an organization\u2014such as the legal department or administration. For most organizations, blocking or requiring an override on the following categories represents a minimum baseline: adult, hacking, command-and-control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-and-anonymizers, and parked. Some organizations may add 'unknown' and 'dynamic-dns' to this list, at the expense of some support calls on those topics.", "x_panw_coa_bp_rationale_statement": "Certain URL categories pose a technology-centric threat, such as command-and-control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-and-anonymizers, and parked. Users visiting websites in these categories, many times unintentionally, are at greater risk of compromising the security of their system. Other categories, such as adult, may pose a legal liability and will be blocked for those reasons.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > URL Filtering`.\n\nSet a URL filter so that all URL categories designated by the organization are listed.\nNavigate to the `Actions` tab. \nSet the action to `Block`.", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > URL Filtering`.\n\nVerify that all URL categories designated by the organization are listed, and the action is set to `Block`.", "x_panw_coa_bp_impact_statement": "Not having an effective URL Filtering configuration can leave an organization open to legal action, internal HR issues, non-compliance with regulatory policies or productivity loss.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy, Use, And Maintain Network-based URL Filters CONTROL:v6 7.6 DESCRIPTION:The organization shall maintain and enforce network based URL filters that limit a system's ability to connect to websites not approved by the organization. The organization shall subscribe to URL categorization services to ensure that they are up-to-date with the most recent website category definitions available. Uncategorized sites shall be blocked by default. This filtering shall be enforced for each of the organization's systems, whether they are physically at an organization's facilities or not.;TITLE:Maintain and Enforce Network-Based URL Filters CONTROL:v7 7.4 DESCRIPTION:Enforce network-based URL filters that limit a system's ability to connect to websites not approved by the organization. This filtering shall be enforced for each of the organization's systems, whether they are physically at an organization's facilities or not.;TITLE:Subscribe to URL-Categorization service CONTROL:v7 7.5 DESCRIPTION:Subscribe to URL categorization services to ensure that they are up-to-date with the most recent website category definitions available. Uncategorized sites shall be blocked by default.;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Profiles\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-profiles.html:\u201cPAN-OS Administrator's Guide 9.0 (English) - URL Filtering\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html:\u201cPAN-OS Admin Guide 9.0 (English) - URL Filtering Best Practices': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering/url-filtering-best-practices.html"]}, {"type": "course-of-action", "id": "course-of-action--38519f4f-e6e8-454b-a3f5-b46daef0e316", "name": "Deploy XSOAR Playbook - Block IP", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.805Z", "x_panw_coa_u42_id": "x.2", "x_panw_coa_u42_title": "Deploy XSOAR Playbook - Block IP"}, {"type": "course-of-action", "id": "course-of-action--41a5e724-166d-496a-bfa6-5f7d671c733e", "name": "Deploy XSOAR Playbook - Hunting C&C Communication Playbook", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.805Z", "x_panw_coa_u42_id": "x.22", "x_panw_coa_u42_title": "Deploy XSOAR Playbook - Hunting C&C Communication Playbook"}, {"type": "course-of-action", "id": "course-of-action--44bfcc9e-cb15-499f-b0fe-3c41e2c2655e", "name": "Deploy XSOAR Playbook - Block URL", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.805Z", "x_panw_coa_u42_id": "x.3", "x_panw_coa_u42_title": "Deploy XSOAR Playbook - Block URL"}, {"type": "course-of-action", "id": "course-of-action--49790670-d365-43f8-a906-8e45c3c80f63", "name": "Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T19:00:11.067Z", "description": "For any security rule allowing traffic, apply a securely configured Vulnerability Protection Profile. Careful analysis of the target environment should be performed before implementing this configuration, as outlined by PAN\u2019s \u201cThreat Prevention Deployment Tech Note\u201d in the references section.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.8", "x_panw_coa_bp_title": "Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "For any security rule allowing traffic, apply a securely configured Vulnerability Protection Profile. Careful analysis of the target environment should be performed before implementing this configuration, as outlined by PAN\u2019s \u201cThreat Prevention Deployment Tech Note\u201d in the references section.", "x_panw_coa_bp_rationale_statement": "A Vulnerability Protection Profile helps to protect assets by alerting on, or blocking network attacks. By applying a secure Vulnerability Protection Profile to all security rules permitting traffic, all network traffic traversing the firewall will be inspected for attacks. This protects both organizational assets from attack and organizational reputation from damage.\n\nNote that encrypted sessions do not allow for complete inspection.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Policies > Security`.\n\nFor each Policy, under the `Actions` tab, select `Vulnerability Protection`.\n\nSet it to use either the 'Strict' or the 'Default' profile, or a custom profile that complies with the organization's policies, legal and regulatory requirements.", "x_panw_coa_bp_audit_procedure": "Navigate to `Policies > Security`.\n\nFor each Policy, under the `Actions` tab, select `Vulnerability Protection`.\n\nVerify either the 'Strict' or the 'Default' profile is selected, or a custom profile that complies with the organization's policies, legal and regulatory requirements.", "x_panw_coa_bp_impact_statement": "Not configuring a Vulnerability Protection Profile means that network attacks will not be logged, alerted on or blocked.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Deploy Network-based IDS Sensors on DMZ Systems CONTROL:v6 12.3 DESCRIPTION:Deploy network-based IDS sensors on Internet and extranet DMZ systems and networks that look for unusual attack mechanisms and detect compromise of these systems. These network-based IDS sensors may detect attacks through the use of signatures, network behavior analysis, or other mechanisms to analyze traffic.;TITLE:Deploy Network-based IDS Sensor CONTROL:v7 12.6 DESCRIPTION:Deploy network-based Intrusion Detection Systems (IDS) sensors to look for unusual attack mechanisms and detect compromise of these systems at each of the organization's network boundaries.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;TITLE:Deploy Network-based IPS Devices To Complement IDS Sensors CONTROL:v6 12.4 DESCRIPTION:Network-based IPS devices should be deployed to complement IDS by blocking known bad signatures or the behavior of potential attacks. As attacks become automated, methods such as IDS typically delay the amount of time it takes for someone to react to an attack. A properly configured network-based IPS can provide automation to block bad traffic. When evaluating network-based IPS products, include those using techniques other than signature-based detection (such as virtual machine or sandbox-based approaches) for consideration.;"], "x_panw_coa_bp_references": ["\u201cThreat Prevention Deployment Tech Note\u201d - https://live.paloaltonetworks.com/docs/DOC-3094:\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Policies\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-policy.html:\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Profiles\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-profiles.html"]}, {"type": "course-of-action", "id": "course-of-action--55e53da8-b2ba-4bba-a641-c5c75a023bb5", "name": "Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.805Z", "description": "Create a pair of security rules at the top of the security policies ruleset to block traffic to and from IP addresses known to be malicious.\n\nNote: This recommendation (as written) requires a Palo Alto 'Active Threat License'. Third Party and Open Source Threat Intelligence Feeds can also be used for this purpose.", "x_panw_coa_bp_section_number": "7", "x_panw_coa_bp_recommendation_number": "7.3", "x_panw_coa_bp_title": "Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Create a pair of security rules at the top of the security policies ruleset to block traffic to and from IP addresses known to be malicious.\n\nNote: This recommendation (as written) requires a Palo Alto 'Active Threat License'. Third Party and Open Source Threat Intelligence Feeds can also be used for this purpose.", "x_panw_coa_bp_rationale_statement": "Creating rules that block traffic to/from known malicious sites from Trusted Threat Intelligence Sources protects you against IP addresses that Palo Alto Networks has proven to be used almost exclusively to distribute malware, initiate command-and-control activity, and launch attacks.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Policies > Security`\n\nCreate a Security Policy similar to: \n- `General` tab: `Name` set to `Deny to Malicious IP` \n- `Source` tab: `Source Zone` set to `Any`, \n- `Destination` tab: `Destination Zone` set to `Any`, `Destination Address` set to `Palo Alto Networks - Known malicious IP addresses`\n- `Application` tab: `Application` set to `Any`\n- `Service/URL Category` tab: `Service` set to `Any`\n- `Actions` tab: `Action` set to `Block`, `Profile Type` set to `None`\n\nCreate a Security Policy similar to with: \n- `General` tab: `Name` set to `Deny from Malicious IP` \n- `Source` tab: `Source Zone` set to `Any`, `Source Address` set to `Palo Alto Networks - Known malicious IP addresses`\n- `Destination` tab: `Destination Zone` set to `Any`\n- `Application` tab: `Application` set to `Any`\n- `Service/URL Category` tab: `Service` set to `Any`\n- `Actions` tab: `Action` set to `Block`, `Profile Type` set to `None`\n\nNote: This recommendation requires a Palo Alto 'Active Threat License'", "x_panw_coa_bp_audit_procedure": "Navigate to `Policies > Security`\n\nVerify a Security Policy exists similar to: \n- `General` tab: `Name` set to `Deny to Malicious IP` \n- `Source` tab: `Source Zone` set to `Any`, \n- `Destination` tab: `Destination Zone` set to `Any`, `Destination Address` set to `Palo Alto Networks - Known malicious IP addresses`\n- `Application` tab: `Application` set to `Any`\n- `Service/URL Category` tab: `Service` set to `Any`\n- `Actions` tab: `Action` set to `Block`, `Profile Type` set to `None`\n\nVerify a Security Policy exists with: \n- `General` tab: `Name` set to `Deny from Malicious IP` \n- `Source` tab: `Source Zone` set to `Any`, `Source Address` set to `Palo Alto Networks - Known malicious IP addresses`\n- `Destination` tab: `Destination Zone` set to `Any`\n- `Application` tab: `Application` set to `Any`\n- `Service/URL Category` tab: `Service` set to `Any`\n- `Actions` tab: `Action` set to `Block`, `Profile Type` set to `None`\n\nNote: This recommendation requires a Palo Alto 'Active Threat License'", "x_panw_coa_bp_impact_statement": "While not foolproof, simply blocking traffic from known malicious hosts allows more resources to be devoted to analyzing traffic from other sources for malicious content. This approach is a recommended part of most 'Defense in Depth' recommendations, allowing defenders to focus more deeply on traffic from uncategorized sources.", "x_panw_coa_bp_cis_controls": ["TITLE:Email and Web Browser Protections CONTROL:v7 7 DESCRIPTION:Email and Web Browser Protections;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;TITLE:Boundary Defense CONTROL:v7 12 DESCRIPTION:Boundary Defense;TITLE:Deny Communications with Known Malicious IP Addresses CONTROL:v7 12.3 DESCRIPTION:Deny communications with known malicious or unused Internet IP addresses and limit access only to trusted and necessary IP address ranges at each of the organization's network boundaries,.;"], "x_panw_coa_bp_references": ["PAN-OS 9.0 Admin Guide: Built-in External Dynamic Lists': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/use-an-external-dynamic-list-in-policy/built-in-edls.html#:'PAN-OS 9.0 Admin Guide: Create Rules Based on Trusted Threat Intelligence Sources': https://docs.paloaltonetworks.com/best-practices/9-0/internet-gateway-best-practices/best-practice-internet-gateway-security-policy/define-the-initial-internet-gateway-security-policy/step-1-create-rules-based-on-trusted-threat-intelligence-sources.html#"]}, {"type": "course-of-action", "id": "course-of-action--5839cd6c-7897-43c4-82f3-5c03096a51c4", "name": "Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Enable passive DNS monitoring within all anti-spyware profiles in use.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.5", "x_panw_coa_bp_title": "Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Enable passive DNS monitoring within all anti-spyware profiles in use.", "x_panw_coa_bp_rationale_statement": "Enabling passive DNS monitoring improves PAN\u2019s threat prevention and threat intelligence capabilities. This is performed without source information delivered to PAN to ensure sensitive DNS information of the organization is not compromised.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Device > Setup > Telemetry`. Set `Passive DNS Monitoring` to enabled", "x_panw_coa_bp_audit_procedure": "Navigate to `Device > Setup > Telemetry`. Ensure that `Passive DNS Monitoring` is enabled", "x_panw_coa_bp_cis_controls": ["TITLE:Enabled DNS Query Logging CONTROL:v6 8.6 DESCRIPTION:Enable domain name system (DNS) query logging to detect hostname lookup for known malicious C2 domains.;TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Enable DNS Query Logging CONTROL:v7 8.7 DESCRIPTION:Enable Domain Name System (DNS) query logging to detect hostname lookups for known malicious domains.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cWhat Information is Submitted to the Palo Alto Networks when Enabling the Passive DNS Feature\u201d - https://live.paloaltonetworks.com/docs/DOC-7256:'PAN-OS Administrator's Guide 9.0 (English) - DNS Security' - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-prevention/dns-security.html#"]}, {"type": "course-of-action", "id": "course-of-action--5c7619c9-3741-4bcb-920e-755769c77589", "name": "Configure Behavioral Threat Protection under the Malware Security Profile", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "x_panw_coa_u42_id": "x.24", "x_panw_coa_u42_title": "Configure Behavioral Threat Protection under the Malware Security Profile"}, {"type": "course-of-action", "id": "course-of-action--5cadeb2b-82c7-4238-8ebd-297df586971e", "name": "Enable Anti-Exploit", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "x_panw_coa_u42_id": "x.15", "x_panw_coa_u42_title": "Enable Anti-Exploit"}, {"type": "course-of-action", "id": "course-of-action--5e951942-0565-46f4-b09e-80426812b6b5", "name": "Ensure that access to every URL is logged", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "URL filters should not specify any categories as `Allow Categories`.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.11", "x_panw_coa_bp_title": "Ensure that access to every URL is logged", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "URL filters should not specify any categories as `Allow Categories`.", "x_panw_coa_bp_rationale_statement": "Setting a URL filter to have one or more entries under Allow Categories will cause no log entries to be produced in the URL Filtering logs for access to URLs in those categories. For forensic, legal, and HR purposes, it is advisable to log access to every URL. In many cases failure to log all URL access is a violation of corporate policy, legal requirements or regulatory requirements.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > URL Filtering`.\n\nFor each permitted category, set the `Site Access` actioun to `alert`", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > URL Filtering`.\n\nVerify that the for all allowed categories, that the `Site Access` action is set to `alert`", "x_panw_coa_bp_impact_statement": "Not having an effective URL Filtering configuration can leave an organization open to legal action, internal HR issues, non-compliance with regulatory policies or productivity loss.", "x_panw_coa_bp_cis_controls": ["TITLE:Log All URL Requests From Systems CONTROL:v6 7.4 DESCRIPTION:Log all URL requests from each of the organization's systems, whether onsite or a mobile device, in order to identify potentially malicious activity and assist incident handlers with identifying potentially compromised systems.;TITLE:Log all URL requests CONTROL:v7 7.6 DESCRIPTION:Log all URL requests from each of the organization's systems, whether onsite or a mobile device, in order to identify potentially malicious activity and assist incident handlers with identifying potentially compromised systems.;TITLE:Ensure Network Boundary Devices Log Verbosely CONTROL:v6 6.5 DESCRIPTION:Configure network boundary devices, including firewalls, network-based IPS, and inbound and outbound proxies, to verbosely log all traffic (both allowed and blocked) arriving at the device.;TITLE:Activate audit logging CONTROL:v7 6.2 DESCRIPTION:Ensure that local logging has been enabled on all systems and networking devices.;TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering/url-filtering-best-practices.html:\u201cPAN-OS Administrator's Guide 9.0 (English) - URL Filtering\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html"]}, {"type": "course-of-action", "id": "course-of-action--60e78a97-dcc6-4d67-a310-ed7f16e0218a", "name": "XDR BIOCs / ABIOCs", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T19:00:11.068Z", "x_panw_coa_u42_id": "x.29", "x_panw_coa_u42_title": "XDR BIOCs / ABIOCs"}, {"type": "course-of-action", "id": "course-of-action--645c6c45-116e-4265-98d2-e30f56325bc6", "name": "Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3'", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.803Z", "description": "Configure antivirus profiles to a value of 'block' for all decoders except imap and pop3 under both Action and WildFire Action. If required by the organization's email implementation, configure imap and pop3 decoders to 'alert' under both Action and WildFire Action.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.1", "x_panw_coa_bp_title": "Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3'", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Configure antivirus profiles to a value of 'block' for all decoders except imap and pop3 under both Action and WildFire Action. If required by the organization's email implementation, configure imap and pop3 decoders to 'alert' under both Action and WildFire Action.", "x_panw_coa_bp_rationale_statement": "Antivirus signatures produce low false positives. By blocking any detected malware through the specified decoders, the threat of malware propagation through the firewall is greatly reduced. It is recommended to mitigate malware found in pop3 and imap through a dedicated antivirus gateway. Due to the nature of the pop3 and imap protocols, the firewall is not able to block only a single email message containing malware. Instead, the entire session would be terminated, potentially affecting benign email messages.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > Antivirus.`\n\nSet antivirus profiles to have all decoders set to `block` for both `Action` and `Wildfire Action`. If `imap` and `pop3` are required in the organization, set the `imap` and `pop3` decoders to `alert` for both `Action` and `Wildfire Action`.", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > Antivirus`\n\nVerify that antivirus profiles have all decoders set to `block` for both `Action` and `Wildfire Action`. If `imap` and `pop3` are required in the organization, verify that the `imap` and `pop3` decoders are set to `alert` for both `Action` and `Wildfire Action`.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cThreat Prevention Deployment Tech Note\u201d - https://live.paloaltonetworks.com/docs/DOC-3094:\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Profiles\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-profiles.html"]}, {"type": "course-of-action", "id": "course-of-action--73a0424d-4238-48d2-9dca-676e986644f2", "name": "Deploy XSOAR - Endpoint Malware Investigation", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "x_panw_coa_u42_id": "x.14", "x_panw_coa_u42_title": "Deploy XSOAR - Endpoint Malware Investigation"}, {"type": "course-of-action", "id": "course-of-action--79fd0d10-6272-4191-8b8d-9c72f19358d0", "name": "Ensure that WildFire file size upload limits are maximized", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.803Z", "description": "Increase WildFire file size limits to the maximum file size supported by the environment. An organization with bandwidth constraints or heavy usage of unique files under a supported file type may require lower settings.\nThe recommendations account for the CPU load on smaller platforms. If an organization consistently has CPU to spare, it's recommended to set some or all of these values to the maximum.", "x_panw_coa_bp_section_number": "5", "x_panw_coa_bp_recommendation_number": "5.1", "x_panw_coa_bp_title": "Ensure that WildFire file size upload limits are maximized", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Increase WildFire file size limits to the maximum file size supported by the environment. An organization with bandwidth constraints or heavy usage of unique files under a supported file type may require lower settings.\nThe recommendations account for the CPU load on smaller platforms. If an organization consistently has CPU to spare, it's recommended to set some or all of these values to the maximum.", "x_panw_coa_bp_rationale_statement": "Increasing file size limits allows the devices to forward more files for WildFire analysis. This increases the chances of identifying, and later preventing, threats in larger files. The default values are configured for files small enough that the majority of files are not assessed by Wildfire.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Device > Setup > WildFire`.\n\nClick the `General Settings` edit icon.\n\nSet the maximum size for each file type are larger than the defaults, to a size that is as large enough to account for 'large' files, but not large enough to affect performance of the hardware. \n\nIn PAN-OS 9.x, the default file sizes for WildFire are: \n\n- pe (Portable Executable) - 16MB\n- apk (Android Application)- 10MB\n- pdf (Portable Document Format) - 3072KB\n- ms-office (Microsoft Office) \u2014 16384KB\n- jar (Packaged Java class file) \u2014 5MB\n- flash (Adobe Flash) \u2014 5MB\n- MacOSX (DMG/MAC-APP/MACH-O PKG files) \u2014 10MB\n- archive (RAR and 7z files) \u2014 50MB\n- linux (ELF files) \u2014 50MB\n- script (JScript, VBScript, PowerShell, and Shell Script)- 20KB\n\nIn PAN-OS 9.x, the maximum file sizes for Wildfire are:\n- pe (Portable Executable) - 50MB\n- apk (Android Application)- 50MB\n- pdf (Portable Document Format) - 51200KB\n- ms-office (Microsoft Office) \u2014 51200KB\n- jar (Packaged Java class file) \u2014 20MB\n- flash (Adobe Flash) \u2014 10MB\n- MacOSX (DMG/MAC-APP/MACH-O PKG files) \u2014 50MB\n- archive (RAR and 7z files) \u2014 50MB\n- linux (ELF files) \u2014 50MB\n- script (JScript, VBScript, PowerShell, and Shell Script)- 4096KB", "x_panw_coa_bp_audit_procedure": "Navigate to `Device > Setup > WildFire`.\n\nNavigate to the `General Settings` sections.\n\nVerify the maximum size for each file type are larger than the defaults, to a size that is as large enough to account for 'large' files, but not large enough to affect performance of the hardware.", "x_panw_coa_bp_impact_statement": "With the default values known, an attacker has only to send an infected file slightly over the 'maximum' size for that filetype to evade detection at the perimeter. Many of the values are significantly lower than is typical for each file size.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cWildfire Administrator's Guide 9.0 (English) - Increased Wildfire File Forwarding Capacity' - https://docs.paloaltonetworks.com/wildfire/u-v/wildfire-whats-new/wildfire-features-in-panos-90/increased-wildfire-file-forwarding-capacity:\u201cHow to Configure WildFire\u201d - https://live.paloaltonetworks.com/docs/DOC-3252:\u201cWildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-deployment-best-practices/wildfire-best-practices.html#:\u201cWildfire Administrator's Guide 9.0 (English) - Forward Files for Wildfire Analysis' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/submit-files-for-wildfire-analysis/forward-files-for-wildfire-analysis.html#"]}, {"type": "course-of-action", "id": "course-of-action--8190ac5a-8a5e-41bc-85dd-62e0f5cdd2ba", "name": "Ensure a WildFire Analysis profile is enabled for all security policies", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Ensure that all files traversing the firewall are inspected by WildFire by setting a Wildfire file blocking profile on all security policies.", "x_panw_coa_bp_section_number": "5", "x_panw_coa_bp_recommendation_number": "5.3", "x_panw_coa_bp_title": "Ensure a WildFire Analysis profile is enabled for all security policies", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Ensure that all files traversing the firewall are inspected by WildFire by setting a Wildfire file blocking profile on all security policies.", "x_panw_coa_bp_rationale_statement": "Traffic matching security policies that do not include a WildFire file blocking profile will not utilize WildFire for file analysis. Wildfire analysis is one of the key security measures available on this platform. Without Wildfire analysis enabled, inbound malware can only be analyzed by signature - which industry wide is roughly 40-60% effective. In a targeted attack, the success of signature-based-only analysis drops even further.", "x_panw_coa_bp_remediation_procedure": "To Set File Blocking Profile:\n\n- Navigate to `Objects > Security Profiles > WildFire Analysis Profile`.\n- Create a WildFire profile that has 'Application Any', 'File Types Any', and 'Direction Both' \n\nTo Set WildFire Analysis Rules: \n\n- Navigate to `Policies > Security`.\n- For each Security Policy Rule where the action is 'Allow', Navigate to `Actions > Profile Setting > WildFire Analysis` and set a WildFire Analysis profile.\n\n**Group Profiles** can also be used. To take this approach:\n- Navigate to `Objects > Security Profile Groups`. Create a Security Profile Group, and ensure that (among other settings) the `Wildfire Analysis Profile` is set to the created profile.\n- Navigate to `Policies > Security`. For each Security Policy Rule where the action is 'Allow', Navigate to `Actions > Profile Setting`. Modify the `Profile Type` to `Group`, and set the `Group Profile` to the created Security Profile Group.", "x_panw_coa_bp_audit_procedure": "To verify WildFire Analysis Profile:\n\n- Navigate to `Objects > Security Profiles > WildFire Analysis Profile` verify that a profile exists. \n\nTo verify File Blocking Rules:\n\n- For each Security Policy were the action is set to Allow, edit the Rule and navigate to `Actions > Profile Setting. Ensure that the WildFire Analysis` is set to `Allow` and verify that a profile is set.\n\nIf **Group Profiles** are used:\n- Navigate to `Policies > Security`\n- For each Security Policy were the action is set to Allow, edit the Rule and navigate to `Actions > Profile Setting`. Ensure that the `Profile Type` is set to `Group`.\n- Navigate to Objects > Security Profile Groups. Open the Security Profile Group used above, and ensure that the Wildfire Analysis Profile is set.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cWildfire Administrator's Guide 9.0 (English)' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html"]}, {"type": "course-of-action", "id": "course-of-action--911488bc-ccbb-45bb-a6b1-1c172c00beb2", "name": "Enable Anti-Malware Protection", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "x_panw_coa_u42_id": "x.16", "x_panw_coa_u42_title": "Enable Anti-Malware Protection"}, {"type": "course-of-action", "id": "course-of-action--922b1227-c493-43f6-8b4a-ae6d6963eb8b", "name": "Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T19:00:11.067Z", "description": "Configure SSL Inbound Inspection for all untrusted traffic destined for servers using SSL or TLS.", "x_panw_coa_bp_section_number": "8", "x_panw_coa_bp_recommendation_number": "8.2", "x_panw_coa_bp_title": "Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Configure SSL Inbound Inspection for all untrusted traffic destined for servers using SSL or TLS.", "x_panw_coa_bp_rationale_statement": "Without SSL Inbound Inspection, the firewall is not able to protect SSL or TLS-enabled webservers against many threats.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Policies > Decryption`.\n\nSet `SSL Inbound Inspection` appropriately for all untrusted traffic destined for servers using SSL or TLS.\n\nNavigate to `Policies > Decryption`. For each service published to the internet (or other untrusted zones), create a Policy and set the following options:\n- `General` tab: `Name` set to a descriptive name\n- `Source`: `Source Zone` set to the target zone (Internet in many cases). `Source Address` set to the target address space (`Any` for internet traffic)\n- `Destination` tab: `Destination Zone` should be set to the appropriate zone, or `Any`. `Destination Address` set to the target host address\n- `Options` tab: Type set to `SSL Inbound Inspection`", "x_panw_coa_bp_audit_procedure": "Navigate to `Policies > Decryption`.\n\nVerify `SSL Inbound Inspection` is set appropriately for all untrusted traffic destined for servers using SSL or TLS.\n\nNavigate to `Policies > Decryption`. For each service published to the internet (or other untrusted zones), verify the following settings:\n- `General` tab: `Name` set to a descriptive name\n- `Source`: `Source Zone` set to the target zone (Internet in many cases). `Source Address` set to the target address space (`Any` for internet traffic)\n- `Destination` tab: `Destination Zone` should be set to the appropriate zone, or `Any`. `Destination Address` set to the target host address\n- `Options` tab: Type set to `SSL Inbound Inspection`", "x_panw_coa_bp_impact_statement": "Not decrypting inbound traffic to TLS encrypted services means that inspection for many common attacks cannot occur on the firewall. This means that all defenses against these attacks are up to the host.", "x_panw_coa_bp_cis_controls": ["TITLE:Design Network Perimeters To Leverage Proxy CONTROL:v6 12.5 DESCRIPTION:Design and implement network perimeters so that all outgoing network traffic to the Internet must pass through at least one application layer filtering proxy server. The proxy should support decrypting network traffic, logging individual TCP sessions, blocking specific URLs, domain names, and IP addresses to implement a black list, and applying whitelists of allowed sites that can be accessed through the proxy while blocking all other sites. Organizations should force outbound traffic to the Internet through an authenticated proxy server on the enterprise perimeter.;TITLE:Boundary Defense CONTROL:v6 12 DESCRIPTION:Boundary Defense;TITLE:Deploy Application Layer Filtering Proxy Server CONTROL:v7 12.9 DESCRIPTION:Ensure that all network traffic to or from the Internet passes through an authenticated application layer proxy that is configured to filter unauthorized connections.;TITLE:Decrypt Network Traffic at Proxy CONTROL:v7 12.10 DESCRIPTION:Decrypt all encrypted network traffic at the boundary proxy prior to analyzing the content. However, the organization may use whitelists of allowed sites that can be accessed through the proxy without decrypting the traffic.;TITLE:Boundary Defense CONTROL:v7 12 DESCRIPTION:Boundary Defense;"], "x_panw_coa_bp_references": ["\u201cHow to Implement SSL Decryption\u201d - https://live.paloaltonetworks.com/docs/DOC- 1412:\u201cPAN-OS Administrator's Guide 9.0 (English) - Decryption (English)\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/decryption.html#"]}, {"type": "course-of-action", "id": "course-of-action--9bcdca50-296d-4032-8639-dc8bc56077a3", "name": "Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.805Z", "description": "Create security policies specifying application-default for the Service setting, in addition to the specific ports desired. The Service setting of `any` should not be used for any policies that allow traffic.", "x_panw_coa_bp_section_number": "7", "x_panw_coa_bp_recommendation_number": "7.2", "x_panw_coa_bp_title": "Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Create security policies specifying application-default for the Service setting, in addition to the specific ports desired. The Service setting of `any` should not be used for any policies that allow traffic.", "x_panw_coa_bp_rationale_statement": "App-ID requires a number of packets to traverse the firewall before an application can be identified and either allowed or dropped. Due to this behavior, even when an application is defined in a security policy, a service setting of `any` may allow a device in one zone to perform ports scans on IP addresses in a different zone. In addition, this recommendation helps to avoid an App-ID cache pollution attack.\n\nBecause of how App-ID works, configuring the service setting to 'Any' allows some initial traffic to reach the target host before App-ID can recognize and appropriately restrict the traffic. Setting the Service Setting to application specific at least restricts the traffic to the target applications or protocols for that initial volume of traffic.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Policies > Security`. \n\nFor each exposed host, set a Security Policy exists with:\n\n- `Source` tab: `Zone` set to `OUTSIDE` `Address` set to `any`\n- `Destination` tab: `Zone` set to `DMZ` / `Address` set to `` \n- `Application` tab: `Application` set to `web-browsing` (or appropriate application)\n- `Service` tab: `Service` set to `application-default`. The value of `any` should never be used", "x_panw_coa_bp_audit_procedure": "Navigate to `Policies > Security`. \n\nFor each exposed host, verify that a Security Policy exists with:\n\n- `Source` tab: `Zone` set to `OUTSIDE` `Address` set to `any`\n- `Destination` tab: `Zone` set to `DMZ` / `Address` set to `` \n- `Application` tab: `Application` set to `web-browsing` (or appropriate application)\n- `Service` tab: `Service` set to `application-default`. The value of `any` should never be used", "x_panw_coa_bp_cis_controls": ["TITLE:Limit Open Ports, Protocols, and Services CONTROL:v6 9.1 DESCRIPTION:Ensure that only ports, protocols, and services with validated business needs are running on each system.;TITLE:Ensure Only Approved Ports, Protocols and Services Are Running CONTROL:v7 9.2 DESCRIPTION:Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.;"], "x_panw_coa_bp_references": ["\u201cSecurity Policy Guidelines\u201d - https://live.paloaltonetworks.com/docs/DOC-3469:\u201cSecurity Bulletin: App-ID Cache Pollution\u201d - http://researchcenter.paloaltonetworks.com/2012/12/app-id-cache-pollution-response/:\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Policiy Overview \u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-web-interface-help/policies/policies-security/security-policy-overview.html#"]}, {"type": "course-of-action", "id": "course-of-action--a1294d38-0f0d-4973-a949-f38cccbc7469", "name": "Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "If a single rule exists within the anti-spyware profile, configure it to block on any spyware severity level, any category, and any threat. If multiple rules exist within the anti-spyware profile, ensure all spyware categories, threats, and severity levels are set to be blocked. Additional rules may exist for packet capture or exclusion purposes.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.3", "x_panw_coa_bp_title": "Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "If a single rule exists within the anti-spyware profile, configure it to block on any spyware severity level, any category, and any threat. If multiple rules exist within the anti-spyware profile, ensure all spyware categories, threats, and severity levels are set to be blocked. Additional rules may exist for packet capture or exclusion purposes.", "x_panw_coa_bp_rationale_statement": "Requiring a blocking policy for all spyware threats, categories, and severities reduces the risk of spyware traffic from successfully exiting the organization. Without an anti-spyware profile assigned to any potential hostile zone, the first protection in the path against malware is removed, leaving in most cases only the desktop endpoint protection application to detect and remediate any potential spyware.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > Anti-Spyware`.\n\nSet a rule within the anti-spyware profile that is configured to perform the `Block Action` on `any Severity` level, `any Category`, and `any Threat Name`.", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > Anti-Spyware`.\n\nVerify a rule exists within the anti-spyware profile that is configured to perform the `Block Action` on `any Severity` level, `any Category`, and `any Threat Name`.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Profiles': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-policy.html"]}, {"type": "course-of-action", "id": "course-of-action--a592acb0-98ba-4a8e-a5cf-2e78d2806e75", "name": "Ensure all WildFire session information settings are enabled", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Enable all options under Session Information Settings for WildFire.", "x_panw_coa_bp_section_number": "5", "x_panw_coa_bp_recommendation_number": "5.5", "x_panw_coa_bp_title": "Ensure all WildFire session information settings are enabled", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Enable all options under Session Information Settings for WildFire.", "x_panw_coa_bp_rationale_statement": "Permitting the firewall to send all of this information to WildFire creates more detailed reports, thereby making the process of tracking down potentially infected devices more efficient. This could prevent an infected system from further infecting the environment. Environments with security policies restricting sending this data to the WildFire cloud can instead utilize an on-premises WildFire appliance. In addition, risk can be analyzed in the context of the destination host and user account, either during analysis or during incident response.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Device > Setup > WildFire > Session Information Settings`.\n\nSet every option to be enabled.", "x_panw_coa_bp_audit_procedure": "Navigate to `Device > Setup > WildFire > Session Information Settings`.\n\nVerify that every option is enabled.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Ensure Network Boundary Devices Log Verbosely CONTROL:v6 6.5 DESCRIPTION:Configure network boundary devices, including firewalls, network-based IPS, and inbound and outbound proxies, to verbosely log all traffic (both allowed and blocked) arriving at the device.;TITLE:Activate audit logging CONTROL:v7 6.2 DESCRIPTION:Ensure that local logging has been enabled on all systems and networking devices.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;TITLE:Malware Defenses CONTROL:v6 8 DESCRIPTION:Malware Defenses;TITLE:Centralize Anti-malware Logging CONTROL:v7 8.6 DESCRIPTION:Send all malware detection events to enterprise anti-malware administration tools and event log servers for analysis and alerting.;"], "x_panw_coa_bp_references": ["\u201cWildfire Administrator's Guide 9.0 (English)' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html#:\u201cWildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices' - /https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-deployment-best-practices/wildfire-best-practices.html"]}, {"type": "course-of-action", "id": "course-of-action--a79d2365-61c7-48b9-b024-e2020b99bba0", "name": "Ensure alerts are enabled for malicious files detected  by WildFire", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Configure WildFire to send an alert when a malicious or greyware file is detected. This alert could be sent by whichever means is preferable, including email, SNMP trap, or syslog message.\n\nAlternatively, configure the WildFire cloud to generate alerts for malicious files. The cloud can generate alerts in addition to or instead of the local WildFire implementation. Note that the destination email address of alerts configured in the WildFire cloud portal is tied to the logged in account, and cannot be modified. Also, new systems added to the WildFire cloud portal will not be automatically set to email alerts.", "x_panw_coa_bp_section_number": "5", "x_panw_coa_bp_recommendation_number": "5.6", "x_panw_coa_bp_title": "Ensure alerts are enabled for malicious files detected  by WildFire", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Configure WildFire to send an alert when a malicious or greyware file is detected. This alert could be sent by whichever means is preferable, including email, SNMP trap, or syslog message.\n\nAlternatively, configure the WildFire cloud to generate alerts for malicious files. The cloud can generate alerts in addition to or instead of the local WildFire implementation. Note that the destination email address of alerts configured in the WildFire cloud portal is tied to the logged in account, and cannot be modified. Also, new systems added to the WildFire cloud portal will not be automatically set to email alerts.", "x_panw_coa_bp_rationale_statement": "WildFire analyzes files that have already been downloaded and possibly executed. A WildFire verdict of malicious indicates that a computer could already be infected. In addition, because WildFire only analyzes files it has not already seen that were not flagged by the firewall\u2019s antivirus filter, files deemed malicious by WildFire are more likely to evade detection by desktop antivirus products.", "x_panw_coa_bp_remediation_procedure": "From GUI, configure some combination of the following Server Profiles:\n\nConfigure the Email Server:\nSelect `Device > Server Profiles > Email`\nClick `Add` \nEnter a name for the Profile. \nSelect the virtual system from the Location drop down menu (if applicable) \nClick `Add`\n\nConfigure the Syslog Server: \nSelect `Device > Server Profiles > Syslog > Add` \nEnter `Name, Display Name, Syslog Server, Transport, Port, Format, Facility` \nClick `OK` \nClick `Commit` to save the configuration\n\nConfigure the SMTP Server: \nSelect `Device > Server Profiles > Email` \nSelect `Add, Name, Display Name, From, To, Additional Recipients, Gateway IP or Hostname` \nClick `OK` \nClick `Commit` to save the configuration\n\nNavigate to `Objects, Log Forwarding`\nChoose `Add`, set the log type to 'wildfire', add the filter '(verdict neq benign)', then add log destinations for SNMP, Syslog, Email or HTTP as required.", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Log Forwarding`.\n\nVerify that the `WildFire` log type is configured to generate alerts using the desired alerting mechanism(s).", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Ensure Network Boundary Devices Log Verbosely CONTROL:v6 6.5 DESCRIPTION:Configure network boundary devices, including firewalls, network-based IPS, and inbound and outbound proxies, to verbosely log all traffic (both allowed and blocked) arriving at the device.;TITLE:Activate audit logging CONTROL:v7 6.2 DESCRIPTION:Ensure that local logging has been enabled on all systems and networking devices.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;TITLE:Central Log Management CONTROL:v7 6.5 DESCRIPTION:Ensure that appropriate logs are being aggregated to a central log management system for analysis and review.;TITLE:Centralize Anti-malware Logging CONTROL:v7 8.6 DESCRIPTION:Send all malware detection events to enterprise anti-malware administration tools and event log servers for analysis and alerting.;"], "x_panw_coa_bp_references": ["\u201cWildFire Email Alerts: Subscribe or Add Additional Recipients\u201d - https://live.paloaltonetworks.com/docs/DOC-7740:\u201cWildfire Administrator's Guide 9.0 (English)' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html"]}, {"type": "course-of-action", "id": "course-of-action--b1f31bc6-40cd-4c64-805f-1680eda35801", "name": "Ensure 'SSL Forward Proxy Policy' for traffic destined to the Internet is configured", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T19:00:11.067Z", "description": "Configure SSL Forward Proxy for all traffic destined to the Internet. In most organizations, including all categories except `financial-services`, `government` and `health-and-medicine` is recommended.", "x_panw_coa_bp_section_number": "8", "x_panw_coa_bp_recommendation_number": "8.1", "x_panw_coa_bp_title": "Ensure 'SSL Forward Proxy Policy' for traffic destined to the Internet is configured", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Configure SSL Forward Proxy for all traffic destined to the Internet. In most organizations, including all categories except `financial-services`, `government` and `health-and-medicine` is recommended.", "x_panw_coa_bp_rationale_statement": "Without SSL inspection, the firewall cannot apply many of its protection features against encrypted traffic. The amount of encrypted malware traffic continues to rise, and legitimate websites using SSL encryption are hacked or tricked into delivering malware on a frequent basis. As encryption on the Internet continues to grow at a rapid rate, SSL inspection is no longer optional as a practical security measure. If proper decryption is not configured, it follows that the majority of traffic is not being fully inspected for malicious content or policy violations. This is a major exposure, allowing delivery of exploits and payloads direct to user desktops.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Policies > Decryption`.\nCreate a Policy for all traffic destined to the Internet. This Policy should include:\n- `Source` tab: The `Source Zone` and/or `Source Address` should include all target internal networks. `Source User` should include all target internal users\n- `Destination` tab: The `Destination Zone` should include the untrusted target zone (usually the `internet`). `Destination Address` is typically `Any` for an internet destination.\n- `Service/URL Category` tab: all `URL Category` entries should be included except `financial-services`, `government` and `health-and-medicine` (this list may vary depending on your organization and its policies).\n- `Options` tab: `Type` set to `SSL Forward Proxy`", "x_panw_coa_bp_audit_procedure": "Navigate to `Policies > Decryption`.\nVerify `SSL Forward Proxy` is set for all traffic destined to the Internet. \n\nVerify each Decryption Policy Rule:\n- `Source` tab: The `Source Zone` and/or `Source Address` should include all target internal networks. `Source User` should include all target internal users\n- `Destination` tab: The `Destination Zone` should include the untrusted target zone (usually the `internet`). `Destination Address` is typically `Any` for an internet destination.\n- `Service/URL Category` tab: Verify that all `URL Category` entries are included except `financial-services`, `government` and `health-and-medicine` (this list may vary depending on your organization and its policies).\n- `Options` tab: Verify that the `Type` is set to `SSL Forward Proxy`", "x_panw_coa_bp_impact_statement": "Failure to decrypt outbound traffic allows attackers to mask attacks, data exfiltration and/or command and control (C2) traffic by simply using standard TLS encryption.\nPrivacy concerns for your organization's users will dictate that some common categories should be exempted from inspection and decryption. Personal banking or healthcare information is almost always exempted, as are interactions with government entities. Exemptions and inclusions to decryption policies should be negotiated internally and governed by published Corporate Policies.", "x_panw_coa_bp_cis_controls": ["TITLE:Design Network Perimeters To Leverage Proxy CONTROL:v6 12.5 DESCRIPTION:Design and implement network perimeters so that all outgoing network traffic to the Internet must pass through at least one application layer filtering proxy server. The proxy should support decrypting network traffic, logging individual TCP sessions, blocking specific URLs, domain names, and IP addresses to implement a black list, and applying whitelists of allowed sites that can be accessed through the proxy while blocking all other sites. Organizations should force outbound traffic to the Internet through an authenticated proxy server on the enterprise perimeter.;TITLE:Boundary Defense CONTROL:v6 12 DESCRIPTION:Boundary Defense;TITLE:Deploy Application Layer Filtering Proxy Server CONTROL:v7 12.9 DESCRIPTION:Ensure that all network traffic to or from the Internet passes through an authenticated application layer proxy that is configured to filter unauthorized connections.;TITLE:Decrypt Network Traffic at Proxy CONTROL:v7 12.10 DESCRIPTION:Decrypt all encrypted network traffic at the boundary proxy prior to analyzing the content. However, the organization may use whitelists of allowed sites that can be accessed through the proxy without decrypting the traffic.;TITLE:Boundary Defense CONTROL:v7 12 DESCRIPTION:Boundary Defense;"], "x_panw_coa_bp_references": ["\u201cHow to Implement SSL Decryption\u201d - https://live.paloaltonetworks.com/docs/DOC- 1412:\u201c\u201cPAN-OS Administrator's Guide 9.0 (English) - Decryption (English)\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/decryption.html#"]}, {"type": "course-of-action", "id": "course-of-action--b4ed79f9-b72c-4423-9a9c-f29134fda870", "name": "Ensure that the Certificate used for Decryption is Trusted", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T19:00:11.068Z", "description": "The CA Certificate used for in-line HTTP Man in the Middle should be trusted by target users. For `SSL Forward Proxy` configurations, there are classes of users that need to be considered.\n\n1: Users that are members of the organization, users of machines under control of the organization. For these people and machines, ensure that the CA Certificate is in one of the Trusted CA certificate stores. This is easily done in Active Directory, using Group Policies for instance. A MDM (Mobile Device Manager) can be used to accomplish the same task for mobile devices such as telephones or tablets. Other central management or orchestration tools can be used for Linux or 'IoT' (Internet of Things) devices.\n\n2: Users that are not member of the organization - often these are classed as 'Visitors' in the policies of the organization. If a public CA Certificate is a possibility for your organization, then that is one approach. A second approach is to not decrypt affected traffic - this is easily done, but leaves the majority of 'visitor' traffic uninspected and potentially carrying malicious content. The final approach, and the one most commonly seen, is to use the same certificate as is used for the hosting organization. In this last case, visitors will see a certificate warning, but the issuing CA will be the organization that they are visiting.", "x_panw_coa_bp_section_number": "8", "x_panw_coa_bp_recommendation_number": "8.3", "x_panw_coa_bp_title": "Ensure that the Certificate used for Decryption is Trusted", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "not_scored", "x_panw_coa_bp_description": "The CA Certificate used for in-line HTTP Man in the Middle should be trusted by target users. For `SSL Forward Proxy` configurations, there are classes of users that need to be considered.\n\n1: Users that are members of the organization, users of machines under control of the organization. For these people and machines, ensure that the CA Certificate is in one of the Trusted CA certificate stores. This is easily done in Active Directory, using Group Policies for instance. A MDM (Mobile Device Manager) can be used to accomplish the same task for mobile devices such as telephones or tablets. Other central management or orchestration tools can be used for Linux or 'IoT' (Internet of Things) devices.\n\n2: Users that are not member of the organization - often these are classed as 'Visitors' in the policies of the organization. If a public CA Certificate is a possibility for your organization, then that is one approach. A second approach is to not decrypt affected traffic - this is easily done, but leaves the majority of 'visitor' traffic uninspected and potentially carrying malicious content. The final approach, and the one most commonly seen, is to use the same certificate as is used for the hosting organization. In this last case, visitors will see a certificate warning, but the issuing CA will be the organization that they are visiting.", "x_panw_coa_bp_rationale_statement": "Using a self-signed certificate, or any certificate that generates a warning in the browser, means that members of the organization have no method of determining if they are being presented with a legitimate certificate, or an attacker's 'man in the middle' certificate. It also very rapidly teaches members of the organization to bypass all security warnings of this type.", "x_panw_coa_bp_remediation_procedure": "Set the CA Certificate(s):\n\nNavigate to `Device > Certificate Management > Certificates`. Import the appropriate CA Certificates from any internal Certificate Authorities. \n\nAlternatively, generate a self-signed certificate for an internal CA on the firewall, and then import the root certificate for that CA into the trusted CA list of target clients. In an Active Directory environment this can be facilitated using a Group Policy.\n\nSet the Certificate Profile needed for the SSL Forward Proxy:\n- Navigate to `Device > Certificate Management > Certificate Profile`.\n\nSet the decryption profile to include the settings described in the `SSL Forward Proxy` guidance in this document", "x_panw_coa_bp_audit_procedure": "Verify the CA Certificate(s): \n\nNavigate to `Device > Certificate Management > Certificates`\n- Verify that appropriate internal certificates are imported, and that all certificates in the list are valid. In particular, verify the `Subject`, `Issuer`, `CA`, `Expires`, `Algorithm` and `Usage` fields\n- Alternatively, if an internal CA is implemented on the firewall, verify that target clients have the root certificate for this CA imported into their list of trusted certificate authorities.\n\nVerify the Certificate Profile needed for the SSL Forward Proxy:\n- Navigate to `Device > Certificate Management > Certificate Profile`. Verify that an appropriate profile is created.", "x_panw_coa_bp_cis_controls": ["TITLE:Design Network Perimeters To Leverage Proxy CONTROL:v6 12.5 DESCRIPTION:Design and implement network perimeters so that all outgoing network traffic to the Internet must pass through at least one application layer filtering proxy server. The proxy should support decrypting network traffic, logging individual TCP sessions, blocking specific URLs, domain names, and IP addresses to implement a black list, and applying whitelists of allowed sites that can be accessed through the proxy while blocking all other sites. Organizations should force outbound traffic to the Internet through an authenticated proxy server on the enterprise perimeter.;TITLE:Deploy Application Layer Filtering Proxy Server CONTROL:v7 12.9 DESCRIPTION:Ensure that all network traffic to or from the Internet passes through an authenticated application layer proxy that is configured to filter unauthorized connections.;TITLE:Decrypt Network Traffic at Proxy CONTROL:v7 12.10 DESCRIPTION:Decrypt all encrypted network traffic at the boundary proxy prior to analyzing the content. However, the organization may use whitelists of allowed sites that can be accessed through the proxy without decrypting the traffic.;TITLE:Boundary Defense CONTROL:v6 12 DESCRIPTION:Boundary Defense;TITLE:Boundary Defense CONTROL:v7 12 DESCRIPTION:Boundary Defense;"], "x_panw_coa_bp_references": ["How to Implement and Test SSL Decryption' - https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Implement-and-Test-SSL-Decryption/ta-p/59719:\u201cPAN-OS Administrator's Guide 9.0 (English) - Decryption (English)\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/decryption.html#:'SSL Certificates Resource List on Configuring and Troubleshooting' - https://live.paloaltonetworks.com/t5/Management-Articles/SSL-certificates-resource-list/ta-p/53068:'Certificates' - http://palo-alto.wikia.com/wiki/Certificates"]}, {"type": "course-of-action", "id": "course-of-action--befa473a-9ac8-4ff8-b0fe-be0e47821896", "name": "Ensure a secure antivirus profile is applied to all relevant security policies", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.803Z", "description": "Create a secure antivirus profile and apply it to all security policies that could pass HTTP, SMTP, IMAP, POP3, FTP, or SMB traffic. The antivirus profile may be applied to the security policies directly or through a profile group.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.2", "x_panw_coa_bp_title": "Ensure a secure antivirus profile is applied to all relevant security policies", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Create a secure antivirus profile and apply it to all security policies that could pass HTTP, SMTP, IMAP, POP3, FTP, or SMB traffic. The antivirus profile may be applied to the security policies directly or through a profile group.", "x_panw_coa_bp_rationale_statement": "By applying a secure antivirus profile to all applicable traffic, the threat of malware propagation through the firewall is greatly reduced. Without an antivirus profile assigned to any potential hostile zone, the first protection in the path against malware is removed, leaving in most cases only the desktop endpoint protection application to detect and remediate any potential malware.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Policies > Security `.\nFor each policy, navigate to `[Policy Name] > Actions`\n\nSet an `Antivirus profile` or a `Profile Group` containing an AV profile for each security policy passing traffic - regardless of protocol.", "x_panw_coa_bp_audit_procedure": "Navigate to `Policies > Security `.\nFor each policy, navigate to `[Policy Name] > Actions`\nVerify there is a secure `Antivirus profile` applied to all security policies passing traffic - regardless of protocol. This can be set by Profiles or by Profile Group.", "x_panw_coa_bp_impact_statement": "Not having an AV Profile on a Security Policy allows signature-based malware to transit the security boundary without blocks or alerts. In most cases this leaves only the Endpoint Security application to block or alert malware.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Policies \u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-policy.html:\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Profiles\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-profiles.html"]}, {"type": "course-of-action", "id": "course-of-action--c45b79a8-2d29-4d8c-95ab-acea7e478e50", "name": "Ensure DNS sinkholing is configured on all anti-spyware profiles in use", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Configure DNS sinkholing for all anti-spyware profiles in use. All internal requests to the selected sinkhole IP address must traverse the firewall. Any device attempting to communicate with the DNS sinkhole IP address should be considered infected.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.4", "x_panw_coa_bp_title": "Ensure DNS sinkholing is configured on all anti-spyware profiles in use", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Configure DNS sinkholing for all anti-spyware profiles in use. All internal requests to the selected sinkhole IP address must traverse the firewall. Any device attempting to communicate with the DNS sinkhole IP address should be considered infected.", "x_panw_coa_bp_rationale_statement": "DNS sinkholing helps to identify infected clients by spoofing DNS responses for malware domain queries. Without sinkholing, the DNS server itself may be seen as infected, while the truly infected device remains unidentified. In addition, sinkholing also ensures that DNS queries that might be indicators of compromise do not transit the internet, where they could be potentially used to negatively impact the 'ip reputation' of the organization's internet network subnets.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > Anti-Spyware`.\n\nWithin the each anti-spyware profile, under its `DNS Signatures` tab, set the `DNS Signature Source` List:\n`Palo Alto Networks Content DNS Signatures` should have as its `Action on DNS Queries` set to `sinkhole`\nIf licensed, the `Palo Alto Networks Cloud DNS Security` should have as its `Action on DNS Queries` set to `sinkhole`\n\nVerify the '`Sinkhole IPv4`' IP address is correct. This should be set to `sinkhole.paloaltnetworks.com`, or if an internal host is set then that host IP or FQDN should be in that field\n\nVerify the '`Sinkhole IPv6`' IP address is correct. This should be set to `IPv6 Loopback IP (::1)`, or if an internal DNS Sinkhole host is set then that host IP or FQDN should be in that field\n\nNavigate to `Policies > Security Policies`\nFor each outbound security Policy, in the `Actions` tab, set the `Anti-Spyware` setting to include the Spyware Profile created, either explicitly or as a `Group Profile`", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > Anti-Spyware`.\n\nWithin the each anti-spyware profile, under its `DNS Signatures` tab, verify the `DNS Signature Source` List:\n`Palo Alto Networks Content DNS Signatures` should have as its `Action on DNS Queries` set to `sinkhole`\nIf licensed, the `Palo Alto Networks Cloud DNS Security` should have as its `Action on DNS Queries` set to `sinkhole`\n\nVerify the '`Sinkhole IPv4`' IP address is correct. This should be set to `sinkhole.paloaltnetworks.com`, or if an internal host is set then that host IP or FQDN should be in that field\n\nVerify the '`Sinkhole IPv6`' IP address is correct. This should be set to `IPv6 Loopback IP (::1)`, or if an internal DNS Sinkhole host is set then that host IP or FQDN should be in that field\n\nNavigate to `Policies > Security Policies`\nFor each outbound security Policy, in the `Actions` tab, verify that the `Anti-Spyware` setting includes the Spyware Profile created, either explicitly or as a `Group Profile`\n\nTo verify correct operation of DNS Security, from an internal station make a DNS request to each of the following hosts:\n- `test-malware.testpanw.com` to test `Malware` DNS Signature checks\n- `test-c2.testpanw.com` to test `C2` DNS Signature checks\n- `test-dga.testpanw.com` to test `DGA` (Domain Generation Algorithm) DNS attack checks \n- `test-dnstun.testpanw.com` to test `DNS Tunneling` attack checks\nEach of these DNS requests should be redirected to the configured DNS Sinkhole server IP address\nEach of these DNS requests should appear in the firewall logs, under `Monitor > Logs > Threat`. If configured, each of these requests should generate an alert in the organization's SIEM.", "x_panw_coa_bp_cis_controls": ["TITLE:Enabled DNS Query Logging CONTROL:v6 8.6 DESCRIPTION:Enable domain name system (DNS) query logging to detect hostname lookup for known malicious C2 domains.;TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Enable DNS Query Logging CONTROL:v7 8.7 DESCRIPTION:Enable Domain Name System (DNS) query logging to detect hostname lookups for known malicious domains.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cHow to Deal with Conficker using DNS Sinkhole\u201d - https://live.paloaltonetworks.com/docs/DOC-6628:\u201cThreat Prevention Deployment Tech Note\u201d - https://live.paloaltonetworks.com/docs/DOC-3094:'PANOS Administrator's Guide 9.0 (English) - Security Profiles': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-profiles.html:'PAN-OS Administrator's Guide 9.0 (English) - DNS Security' - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-prevention/dns-security.html#"]}, {"type": "course-of-action", "id": "course-of-action--c5148c0d-4c4a-4ad6-b2c7-942f9eb91673", "name": "Deploy XSOAR Playbook - PAN-OS Query Logs for Indicators", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.805Z", "x_panw_coa_u42_id": "x.23", "x_panw_coa_u42_title": "Deploy XSOAR Playbook - PAN-OS Query Logs for Indicators"}, {"type": "course-of-action", "id": "course-of-action--d3c39d4c-3074-4350-832e-9eea942ac353", "name": "Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.805Z", "description": "When permitting traffic from an untrusted zone, such as the Internet or guest network, to a more trusted zone, such as a DMZ segment, create security policies specifying which specific applications are allowed. \n\n**Enhanced Security Recommendation: **\nRequire specific application policies when allowing `any` traffic, regardless of the trust level of a zone. Do not rely solely on port permissions. This may require SSL interception, and may also not be possible in all environments.", "x_panw_coa_bp_section_number": "7", "x_panw_coa_bp_recommendation_number": "7.1", "x_panw_coa_bp_title": "Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "When permitting traffic from an untrusted zone, such as the Internet or guest network, to a more trusted zone, such as a DMZ segment, create security policies specifying which specific applications are allowed. \n\n**Enhanced Security Recommendation: **\nRequire specific application policies when allowing `any` traffic, regardless of the trust level of a zone. Do not rely solely on port permissions. This may require SSL interception, and may also not be possible in all environments.", "x_panw_coa_bp_rationale_statement": "To avoid unintentionally exposing systems and services, rules allowing traffic from untrusted zones to trusted zones should be as specific as possible. Application-based rules, as opposed to service/port rules, further tighten what traffic is allowed to pass.\nSimilarly, traffic from trusted to untrusted networks should have a security policy set, with application-based rules. A 'catch-all' rule that allows all applications will also allow malware traffic. The goal should be to understand both inbound and outbound traffic, permit what is known, and block all other traffic.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Policies > Security`. \n\nFor all `Security Policies` that transit from a less trusted to a more trusted interface, set the `Application` and `Service` values to match the exposed application. For instance, for a web server exposed to the internet from a DMZ:\n`Source` tab: `Zone` set to `OUTSIDE` / `Address` set to `Any` \n`Destination` tab: `Zone` set to `DMZ` / `Address` set to `[DMZ Host Object]` \n`Application` tab: set to `web-browsing` \n`Service/URL Category` tab: set `Service` to ether:\n- `application-default`\nor:\n- `service-http` and/or `service-https`\n\n**Enhanced Security Recommendation: **\n\nSet these values for Policies on all Interfaces, for traffic in all directions. For each `Security Policy`, set the `Application` and `Service` values to match the exposed application.", "x_panw_coa_bp_audit_procedure": "Navigate to `Policies > Security`. \n\nFor all Security Policies that transit from a less trusted to a more trusted interface, that the appropriate `Application` and `Service` values are set. For instance, for a web server exposed to the internet from a DMZ:\n`Source` tab: `Zone` set to `OUTSIDE` / `Address` set to `Any` \n`Destination` tab: `Zone` set to `DMZ` / `Address` set to `[DMZ Host Object]` \n`Application` tab: set to `web-browsing` \n`Service/URL Category` tab: set `Service` to ether:\n- `application-default`\nor:\n- `service-http` and/or `service-https`\n\n**Enhanced Security Recommendation: **\n\nAssess this setting for Policies on all Interfaces, for traffic in all directions. Ensure that for each Security Policy that the appropriate settings are set for both `Application` and `Service`", "x_panw_coa_bp_impact_statement": "Setting application based rules on both inbound and outbound traffic ensures that the traffic on the protocol and port being specified is actually the application that you expect. For outbound traffic, the days of 'we trust our users' is well past us, that statement also implies that we trust the malware on the user workstations, which is obviously not the case. \nFor traffic from trusted to less trusted interfaces, the applications should be characterized over time, with the end goal being that all applications in in the rules, and a final 'block all' rule is in place. \nNot having this goal gives both attackers and malware the leeway they need to accomplish their goals. \nTrusting only Port permissions to control traffic exposes an organization to 'tunneling' style attacks that can exfiltrate data or facilitate Command and Control (C2) sessions.", "x_panw_coa_bp_cis_controls": ["TITLE:Controlled Access Based on the Need to Know CONTROL:v6 14 DESCRIPTION:Controlled Access Based on the Need to Know;TITLE:Controlled Access Based on the Need to Know CONTROL:v7 14 DESCRIPTION:Controlled Access Based on the Need to Know;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Policies / Applications and Usage \u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-web-interface-help/policies/policies-security/applications-and-usage.html#"]}, {"type": "course-of-action", "id": "course-of-action--d84f79f8-219c-43cb-a918-ab7dd235413a", "name": "Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Create one or more anti-spyware profiles and collectively apply them to all security policies permitting traffic to the Internet. The anti-spyware profiles may be applied to the security policies directly or through a profile group.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.6", "x_panw_coa_bp_title": "Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Create one or more anti-spyware profiles and collectively apply them to all security policies permitting traffic to the Internet. The anti-spyware profiles may be applied to the security policies directly or through a profile group.", "x_panw_coa_bp_rationale_statement": "By applying secure anti-spyware profiles to all applicable traffic, the threat of sensitive data exfiltration or command-and-control traffic successfully passing through the firewall is greatly reduced. Anti-spyware profiles are not restricted to particular protocols like antivirus profiles, so anti-spyware profiles should be applied to all security policies permitting traffic to the Internet. Assigning an anti-spyware profile to each trusted zone will quickly and easily identify trusted hosts that have been infected with spyware, by identifying the infection from their outbound network traffic. In addition, that outbound network traffic will be blocked by the profile.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > Anti-Spyware`.\n\nAlso navigate to `Policies > Security`.\n\nSet one or more anti-spyware profiles to collectively apply to all inside to outside traffic from any address to any address and any application and service.", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > Anti-Spyware`.\n\nAlso navigate to `Policies > Security`.\n\nVerify there are one or more anti-spyware profiles that collectively apply to all inside to outside traffic from any address to any address and any application and service.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cThreat Prevention Deployment Tech Note\u201d - https://live.paloaltonetworks.com/docs/DOC-3094:\u201cPAN-OS Administrator's Guide 9.0 (English) - Security Profiles\u201d - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/policy/security-profiles.html"]}, {"type": "course-of-action", "id": "course-of-action--dff22e97-a89e-4ff7-b615-0165258bf8d5", "name": "Ensure all HTTP Header Logging options are enabled", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Enable all options (User-Agent, Referer, and X-Forwarded-For) for HTTP header logging.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.12", "x_panw_coa_bp_title": "Ensure all HTTP Header Logging options are enabled", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Enable all options (User-Agent, Referer, and X-Forwarded-For) for HTTP header logging.", "x_panw_coa_bp_rationale_statement": "Logging HTTP header information provides additional information in the URL logs, which may be useful during forensic investigations. The User-Agent option logs which browser was used during the web session, which could provide insight to the vector used for malware retrieval. The Referer option logs the source webpage responsible for referring the user to the logged webpage. The X-Forwarded-For option is useful for preserving the user\u2019s source IP address, such as if a user traverses a proxy server prior to the firewall. Un-checking the Log container page only box produces substantially more information about web activity, with the expense of producing far more entries in the URL logs. If this option remains checked, a URL filter log entry showing details of a malicious file download may not exist.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > URL Filtering > URL Filtering Profile > URL Filtering Settings`.\n\nSet the following four settings:\n\n a. `Log container page only` box is un-checked\n\n b. Check the `User-Agent` box\n\n c. Check the `Referer` box\n\n d. Check the `X-Forwarded-For` box", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > URL Filtering > URL Filtering Profile > URL Filtering Settings`.\n\nVerify these four settings:\n\n a. `Log container page only` box is un-checked\n\n b. `User-Agent` box is checked\n\n c. `Referer` box is checked\n\n d. `X-Forwarded-For` box is checked", "x_panw_coa_bp_impact_statement": "Not having an effective URL Filtering configuration can leave an organization open to legal action, internal HR issues, non-compliance with regulatory policies or productivity loss.", "x_panw_coa_bp_cis_controls": ["TITLE:Log All URL Requests From Systems CONTROL:v6 7.4 DESCRIPTION:Log all URL requests from each of the organization's systems, whether onsite or a mobile device, in order to identify potentially malicious activity and assist incident handlers with identifying potentially compromised systems.;TITLE:Ensure Network Boundary Devices Log Verbosely CONTROL:v6 6.5 DESCRIPTION:Configure network boundary devices, including firewalls, network-based IPS, and inbound and outbound proxies, to verbosely log all traffic (both allowed and blocked) arriving at the device.;TITLE:Log all URL requests CONTROL:v7 7.6 DESCRIPTION:Log all URL requests from each of the organization's systems, whether onsite or a mobile device, in order to identify potentially malicious activity and assist incident handlers with identifying potentially compromised systems.;TITLE:Activate audit logging CONTROL:v7 6.2 DESCRIPTION:Ensure that local logging has been enabled on all systems and networking devices.;TITLE:Enable Detailed Logging CONTROL:v7 6.3 DESCRIPTION:Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering/url-filtering-best-practices.html"]}, {"type": "course-of-action", "id": "course-of-action--ef5f68d8-9522-40b4-890c-31ece644687d", "name": "Ensure 'WildFire Update Schedule' is set to download and install updates every minute", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Set the WildFire update schedule to download and install updates every minute.", "x_panw_coa_bp_section_number": "5", "x_panw_coa_bp_recommendation_number": "5.7", "x_panw_coa_bp_title": "Ensure 'WildFire Update Schedule' is set to download and install updates every minute", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Set the WildFire update schedule to download and install updates every minute.", "x_panw_coa_bp_rationale_statement": "WildFire definitions may contain signatures to block immediate, active threats to the environment. With a 1 minute update schedule, the firewall can ensure threats with new definitions are quickly mitigated.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Device > Dynamic Updates > WildFire Update Schedule`.\n\nSet `Action` to `Download and Install`.\n\nSet `Recurrence` to `Every Minute`.", "x_panw_coa_bp_audit_procedure": "Navigate to `Device > Dynamic Updates > WildFire Update Schedule`.\n\nVerify that `Action` is set to `Download and Install`.\n\nVerify that `Recurrence` is set to `Every Minute`.", "x_panw_coa_bp_cis_controls": ["TITLE:Boundary Defense CONTROL:v6 12 DESCRIPTION:Boundary Defense;TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Use Automated Patch Management And Software Update Tools CONTROL:v6 4.5 DESCRIPTION:Deploy automated patch management tools and software update tools for operating system and software/applications on all systems for which such tools are available and safe. Patches should be applied to all systems, even systems that are properly air gapped.;TITLE:Deploy Automated Operating System Patch Management Tools CONTROL:v7 3.4 DESCRIPTION:Deploy automated software update tools in order to ensure that the operating systems are running the most recent security updates provided by the software vendor.;TITLE:Deploy Automated Software Patch Management Tools CONTROL:v7 3.5 DESCRIPTION:Deploy automated software update tools in order to ensure that third-party software on all systems is running the most recent security updates provided by the software vendor.;TITLE:Boundary Defense CONTROL:v7 12 DESCRIPTION:Boundary Defense;"], "x_panw_coa_bp_references": ["\u201cWildfire Administrator's Guide 9.0 (English)' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html:\u201cHow to Configure WildFire\u201d - https://live.paloaltonetworks.com/docs/DOC-3252:\u201cTips for Managing Content Updates\u201d - https://live.paloaltonetworks.com/docs/DOC- 1578"]}, {"type": "course-of-action", "id": "course-of-action--f4a8da12-c6f0-4a33-ae42-590c5602be99", "name": "Ensure secure URL filtering is enabled for all security policies allowing traffic to the Internet", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Apply a secure URL filtering profile to all security policies permitting traffic to the Internet. The URL Filtering profile may be applied to the security policies directly or through a profile group.", "x_panw_coa_bp_section_number": "6", "x_panw_coa_bp_recommendation_number": "6.13", "x_panw_coa_bp_title": "Ensure secure URL filtering is enabled for all security policies allowing traffic to the Internet", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Apply a secure URL filtering profile to all security policies permitting traffic to the Internet. The URL Filtering profile may be applied to the security policies directly or through a profile group.", "x_panw_coa_bp_rationale_statement": "URL Filtering policies dramatically reduce the risk of users visiting malicious or inappropriate websites. In addition, a complete URL history log for all devices is invaluable when performing forensic analysis in the event of a security incident. Applying complete and approved URL filtering to outbound traffic is a frequent requirement in corporate policies, legal requirements or regulatory requirements.", "x_panw_coa_bp_remediation_procedure": "To Set URL Filtering:\nFor each Security Profile that transits traffic to the internet, navigate to `Policies > Security > Security Profiles > [Policy Name] > Actions`.\n\nSet a URL Filtering profile that complies with the policies of the organization is applied to all Security Policies that transit traffic to the public internet.", "x_panw_coa_bp_audit_procedure": "To Verify URL Filtering:\n\nFor each Security Policy that transits traffic to the public internet, navigate to `Policies > Security > Security Profiles > [Policy Name] > Actions`.\n\nVerify there is a URL Filtering profile that complies with the policies of the organization is applied to all Security Policies that transit traffic to the public internet.", "x_panw_coa_bp_impact_statement": "Not having an effective URL Filtering configuration can leave an organization open to legal action, internal HR issues, non-compliance with regulatory policies or productivity loss.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy, Use, And Maintain Network-based URL Filters CONTROL:v6 7.6 DESCRIPTION:The organization shall maintain and enforce network based URL filters that limit a system's ability to connect to websites not approved by the organization. The organization shall subscribe to URL categorization services to ensure that they are up-to-date with the most recent website category definitions available. Uncategorized sites shall be blocked by default. This filtering shall be enforced for each of the organization's systems, whether they are physically at an organization's facilities or not.;TITLE:Maintain and Enforce Network-Based URL Filters CONTROL:v7 7.4 DESCRIPTION:Enforce network-based URL filters that limit a system's ability to connect to websites not approved by the organization. This filtering shall be enforced for each of the organization's systems, whether they are physically at an organization's facilities or not.;TITLE:Subscribe to URL-Categorization service CONTROL:v7 7.5 DESCRIPTION:Subscribe to URL categorization services to ensure that they are up-to-date with the most recent website category definitions available. Uncategorized sites shall be blocked by default.;"], "x_panw_coa_bp_references": ["\u201cPAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices': https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering/url-filtering-best-practices.html"]}, {"type": "course-of-action", "id": "course-of-action--f4d50de0-ecc5-4f9e-b8f7-214cdfe28d39", "name": "Ensure forwarding is enabled for all applications and file types in WildFire file blocking profiles", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Set Applications and File Types fields to any in WildFire file blocking profiles. With a WildFire license, seven file types are supported, while only PE (Portable Executable) files are supported without a license.\nFor the 'web browsing' application, the action 'continue' can be selected. This still forwards the file to the Wildfire service, but also presents the end user with a confirmation message before they receive the file. Selecting 'continue' for any other application will block the file (because the end user will not see the prompt).\nIf there is a 'continue' rule, there should still be an 'any traffic / any application / forward' rule after that in the list.", "x_panw_coa_bp_section_number": "5", "x_panw_coa_bp_recommendation_number": "5.2", "x_panw_coa_bp_title": "Ensure forwarding is enabled for all applications and file types in WildFire file blocking profiles", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Set Applications and File Types fields to any in WildFire file blocking profiles. With a WildFire license, seven file types are supported, while only PE (Portable Executable) files are supported without a license.\nFor the 'web browsing' application, the action 'continue' can be selected. This still forwards the file to the Wildfire service, but also presents the end user with a confirmation message before they receive the file. Selecting 'continue' for any other application will block the file (because the end user will not see the prompt).\nIf there is a 'continue' rule, there should still be an 'any traffic / any application / forward' rule after that in the list.", "x_panw_coa_bp_rationale_statement": "Selecting 'Any' application and file type ensures WildFire is analyzing as many files as possible.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Objects > Security Profiles > File Blocking`.\n\nSet a rule so that `Applications` is set to `any`, `File Type` is set to `any`, and `Action` is set to `forward`.", "x_panw_coa_bp_audit_procedure": "Navigate to `Objects > Security Profiles > File Blocking`.\n\nVerify an appropriate rule exists with `Applications` set to `any`, `File Type` set to `any`, and `Action` set to `forward`.", "x_panw_coa_bp_cis_controls": ["TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201c\u201cWildfire Administrator's Guide 9.0 (English) -WildFire Best Practices\u201d - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-deployment-best-practices/wildfire-best-practices.html#"]}, {"type": "course-of-action", "id": "course-of-action--fd0da09e-a0b2-4018-9476-1a7edd809b59", "name": "Ensure forwarding of decrypted content to WildFire is enabled", "created": "2020-06-23T19:50:31.722Z", "modified": "2020-06-26T13:02:55.804Z", "description": "Allow the firewall to forward decrypted content to WildFire. Note that SSL Forward-Proxy must also be enabled and configured for this setting to take effect on inside-to-outside traffic flows.", "x_panw_coa_bp_section_number": "5", "x_panw_coa_bp_recommendation_number": "5.4", "x_panw_coa_bp_title": "Ensure forwarding of decrypted content to WildFire is enabled", "x_panw_coa_bp_status": "published", "x_panw_coa_bp_scoring_status": "full", "x_panw_coa_bp_description": "Allow the firewall to forward decrypted content to WildFire. Note that SSL Forward-Proxy must also be enabled and configured for this setting to take effect on inside-to-outside traffic flows.", "x_panw_coa_bp_rationale_statement": "As encrypted Internet traffic continues to proliferate, WildFire becomes less effective unless it is allowed to act on decrypted content. For example, if a user downloads a malicious pdf over SSL, WildFire can only provide analysis if 1) the session is decrypted by the firewall and 2) forwarding of decrypted content is enabled. In today's internet, roughly 70-80% of all user traffic is encrypted. If Wildfire is not configured to analyze encrypted content, the effectiveness of Wildfire is drastically reduced.", "x_panw_coa_bp_remediation_procedure": "Navigate to `Device > Setup > Content-ID > Content-ID Settings`.\n\nSet `Allow forwarding of decrypted content` to be checked.\nNote that SSL Forward Proxy must be configured for this setting to be effective.", "x_panw_coa_bp_audit_procedure": "Navigate to `Device > Setup > Content-ID > Content-ID Settings`.\n\nVerify that `Allow forwarding of decrypted content` is checked.", "x_panw_coa_bp_cis_controls": ["TITLE:Design Network Perimeters To Leverage Proxy CONTROL:v6 12.5 DESCRIPTION:Design and implement network perimeters so that all outgoing network traffic to the Internet must pass through at least one application layer filtering proxy server. The proxy should support decrypting network traffic, logging individual TCP sessions, blocking specific URLs, domain names, and IP addresses to implement a black list, and applying whitelists of allowed sites that can be accessed through the proxy while blocking all other sites. Organizations should force outbound traffic to the Internet through an authenticated proxy server on the enterprise perimeter.;TITLE:Deploy Application Layer Filtering Proxy Server CONTROL:v7 12.9 DESCRIPTION:Ensure that all network traffic to or from the Internet passes through an authenticated application layer proxy that is configured to filter unauthorized connections.;TITLE:Decrypt Network Traffic at Proxy CONTROL:v7 12.10 DESCRIPTION:Decrypt all encrypted network traffic at the boundary proxy prior to analyzing the content. However, the organization may use whitelists of allowed sites that can be accessed through the proxy without decrypting the traffic.;TITLE:Deploy Network-based Anti-malware Tools CONTROL:v6 8.5 DESCRIPTION:Use network-based anti-malware tools to identify executables in all network traffic and use techniques other than signature-based detection to identify and filter out malicious content before it arrives at the endpoint.;TITLE:Malware Defenses CONTROL:v7 8 DESCRIPTION:Malware Defenses;TITLE:Malware Defenses CONTROL:v6 8 DESCRIPTION:Malware Defenses;"], "x_panw_coa_bp_references": ["\u201cWildFire Fails Forwarding File to Cloud for Encrypted Traffic\u201d - https://live.paloaltonetworks.com/docs/DOC-6845:\u201cWildfire Administrator's Guide 9.0 (English) - Forward Decrypted SSL Traffic for Wildfire Analysis' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/submit-files-for-wildfire-analysis/forward-decrypted-ssl-traffic-for-wildfire-analysis.html#:\u201cWildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices' - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-deployment-best-practices/wildfire-best-practices.html#"]}, {"type": "identity", "id": "identity--72b1e547-5e3e-4862-8c01-d22602821063", "identity_class": "unknown", "name": "Identity (Campaign 1 - AcidBox)", "created": "2020-06-08T12:33:42.527Z", "modified": "2020-06-10T13:43:23.039Z", "x_cta_country": ["RU"]}, {"type": "indicator", "id": "indicator--03076eee-a3a9-4794-b745-681a46391390", "created": "2020-06-04T16:39:47.957Z", "modified": "2020-06-08T12:22:55.313Z", "name": "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Class\\{4D36E96A-E325-11CE-BFC1-08002BE10318}\\0000\\DriverData", "pattern": "[windows-registry-key:key = 'HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E96A-E325-11CE-BFC1-08002BE10318}\\\\0000\\\\DriverData']", "valid_from": "2020-06-04T16:39:47.957Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--10750290-4efd-4e7b-8dda-cc1a9ae4a8b4", "created": "2020-06-05T16:24:06.621Z", "modified": "2020-06-08T12:22:55.313Z", "name": "VBoxDrv.sys", "pattern": "[file:name = 'VBoxDrv.sys']", "valid_from": "2020-06-05T16:24:06.621Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--22359bb6-e940-4414-9971-fbf7317dfe9b", "created": "2020-06-12T12:46:54.919Z", "modified": "2020-06-12T15:26:26.571Z", "name": "[x509-certificate:issuer = '/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)04/CN=VeriSign Class 3 Code Signing 2004 CA' AND x509-certificate:serial_number = '69:3a:64:81:8c:1e:08:6b:1b:15:ae:e6:3f:a0:54:a2' AND x509-certificate:validity_not_before = '2007-06-14T12:00:00Z' AND x509-certificate:validity_not_after = '2012-06-14T12:00:00Z']", "pattern": "[x509-certificate:issuer = '/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)04/CN=VeriSign Class 3 Code Signing 2004 CA' AND x509-certificate:serial_number = '69:3a:64:81:8c:1e:08:6b:1b:15:ae:e6:3f:a0:54:a2' AND x509-certificate:validity_not_before = '2007-06-14T12:00:00Z' AND x509-certificate:validity_not_after = '2012-06-14T12:00:00Z']", "valid_from": "2020-06-12T12:46:54.919Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--39f865c8-b888-4535-aabd-3a57bbba7fbb", "created": "2020-06-05T16:24:06.621Z", "modified": "2020-06-08T12:22:55.313Z", "name": "78827fa00ea48d96ac9af8d1c1e317d02ce11793e7f7f6e4c7aac7b5d7dd490f", "pattern": "[file:hashes.'SHA-256' = '78827fa00ea48d96ac9af8d1c1e317d02ce11793e7f7f6e4c7aac7b5d7dd490f']", "valid_from": "2020-06-05T16:24:06.621Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--484f3c69-2329-4642-b1fc-5c1fb3301895", "created": "2020-06-04T16:18:47.646Z", "modified": "2020-06-08T12:22:55.313Z", "name": "3ad20ca49a979e5ea4a5e154962e7caff17e4ca4f00bec7f3ab89275fcc8f58c", "pattern": "[file:hashes.'SHA-256' = '3ad20ca49a979e5ea4a5e154962e7caff17e4ca4f00bec7f3ab89275fcc8f58c']", "valid_from": "2020-06-04T16:18:47.646Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--4f9613ed-d27e-4c0d-95dd-df64571e6748", "created": "2020-06-04T16:39:47.957Z", "modified": "2020-06-08T12:22:55.313Z", "name": "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Class\\{4D36E97D-E325-11CE-BFC1-08002BE10318}\\0003\\DriverData", "pattern": "[windows-registry-key:key = 'HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E97D-E325-11CE-BFC1-08002BE10318}\\\\0003\\\\DriverData']", "valid_from": "2020-06-04T16:39:47.957Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--5e97af12-fdf8-4663-9b7d-dfa9fe27070b", "created": "2020-06-04T16:18:47.646Z", "modified": "2020-06-08T12:22:55.313Z", "name": "3ef071e0327e7014dd374d96bed023e6c434df6f98cce88a1e7335a667f6749d", "pattern": "[file:hashes.'SHA-256' = '3ef071e0327e7014dd374d96bed023e6c434df6f98cce88a1e7335a667f6749d']", "valid_from": "2020-06-04T16:18:47.646Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--c3c69da9-8cca-4269-8f8a-1c10503ca9b0", "created": "2020-06-08T15:10:38.597Z", "modified": "2020-06-17T12:47:20.010Z", "name": "[file:name = 'VBoxDrv.sys' AND file:hashes.'SHA-256' = '78827fa00ea48d96ac9af8d1c1e317d02ce11793e7f7f6e4c7aac7b5d7dd490f']", "pattern": "[file:name = 'VBoxDrv.sys' AND file:hashes.'SHA-256' = '78827fa00ea48d96ac9af8d1c1e317d02ce11793e7f7f6e4c7aac7b5d7dd490f']", "valid_from": "2020-06-08T15:10:38.597Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--e2a55d9a-25a6-40bd-b1f2-cef2d32e8d83", "created": "2020-06-04T16:18:47.646Z", "modified": "2020-06-08T12:22:55.313Z", "name": "b3166c417d49e94f3d9eab9b1e8ab853b58ba59f734f774b5de75ee631a9b66d", "pattern": "[file:hashes.'SHA-256' = 'b3166c417d49e94f3d9eab9b1e8ab853b58ba59f734f774b5de75ee631a9b66d']", "valid_from": "2020-06-04T16:18:47.646Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--ed06166f-34d7-48fe-9b4d-2c1be6fe256b", "created": "2020-06-04T16:18:47.646Z", "modified": "2020-06-08T12:22:55.313Z", "name": "003669761229d3e1db0f5a5b333ef62b3dffcc8e27c821ce9018362e0a2df7e9", "pattern": "[file:hashes.'SHA-256' = '003669761229d3e1db0f5a5b333ef62b3dffcc8e27c821ce9018362e0a2df7e9']", "valid_from": "2020-06-04T16:18:47.646Z", "labels": ["malicious-activity"]}, {"type": "indicator", "id": "indicator--ee7c674f-4326-4d6b-b24c-c0901e0d2f34", "created": "2020-06-04T16:18:47.646Z", "modified": "2020-06-08T12:22:55.313Z", "name": "eb30a1822bd6f503f8151cb04bfd315a62fa67dbfe1f573e6fcfd74636ecedd5", "pattern": "[file:hashes.'SHA-256' = 'eb30a1822bd6f503f8151cb04bfd315a62fa67dbfe1f573e6fcfd74636ecedd5']", "valid_from": "2020-06-04T16:18:47.646Z", "labels": ["malicious-activity"]}, {"type": "relationship", "id": "relationship--0021f86a-b604-4cbf-b48d-ad778ce6fcf0", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--c5148c0d-4c4a-4ad6-b2c7-942f9eb91673", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["XSOAR"]}, {"type": "relationship", "id": "relationship--011f773f-010e-4f8e-901d-7ffc2cb41ac0", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"type": "relationship", "id": "relationship--04dd51c4-aaa5-4128-bf07-1e8ebfa23681", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--d3c39d4c-3074-4350-832e-9eea942ac353", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["NGFW"]}, {"type": "relationship", "id": "relationship--068ee331-72ba-45b0-9dc5-e785e116fdb4", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--b1f31bc6-40cd-4c64-805f-1680eda35801", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["NGFW"]}, {"type": "relationship", "id": "relationship--076d5ade-2e17-4fac-9884-78e285587a0b", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.077Z", "relationship_type": "mitigates", "source_ref": "course-of-action--60e78a97-dcc6-4d67-a310-ed7f16e0218a", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--07995dc6-5bee-41d3-9cb7-2bfb325bc06e", "created": "2020-06-12T13:02:54.330Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "AcidBox DLL module", "source_ref": "indicator--e2a55d9a-25a6-40bd-b1f2-cef2d32e8d83", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "id": "relationship--0d246a3a-aa03-41d8-b994-6ae14ffecd4f", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.074Z", "relationship_type": "mitigates", "source_ref": "course-of-action--911488bc-ccbb-45bb-a6b1-1c172c00beb2", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--0ec7450f-6ee5-4a25-8739-8b6bdaf10c72", "created": "2020-06-12T13:02:54.330Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "AcidBox kernel-mode driver", "source_ref": "indicator--5e97af12-fdf8-4663-9b7d-dfa9fe27070b", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "id": "relationship--0ee01038-6226-422e-8a64-6aa4a20036b7", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.605Z", "relationship_type": "mitigates", "source_ref": "course-of-action--8190ac5a-8a5e-41bc-85dd-62e0f5cdd2ba", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--0ef405ef-5863-4a41-a10a-e787a37bd8bd", "created": "2020-06-12T13:02:54.330Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "Hash of the Sun Microsystems Virtual Box system driver", "source_ref": "indicator--39f865c8-b888-4535-aabd-3a57bbba7fbb", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "id": "relationship--0f0cdf26-8605-45a5-b5be-d2ca480e4731", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.605Z", "relationship_type": "mitigates", "source_ref": "course-of-action--f4d50de0-ecc5-4f9e-b8f7-214cdfe28d39", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--1030d5e4-5181-485b-be47-3cf30cee917d", "created": "2020-06-08T17:51:45.316Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "indicates", "source_ref": "indicator--03076eee-a3a9-4794-b745-681a46391390", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--13a8fcf0-9890-4e1a-89ff-d6a2b1c2d56c", "created": "2020-06-12T13:03:12.806Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"type": "relationship", "id": "relationship--15515310-419b-452d-8040-1f59b9443ae1", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--fd0da09e-a0b2-4018-9476-1a7edd809b59", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--190404eb-2b23-4cdf-8be4-5185c86f4aef", "created": "2020-06-12T13:02:54.330Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "File staged to support execution. Orchestrator DLL", "source_ref": "indicator--ee7c674f-4326-4d6b-b24c-c0901e0d2f34", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "id": "relationship--1bd446d7-771d-483f-b33c-4a9be9c03e19", "created": "2020-06-12T13:03:29.186Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "VBoxDrv.sys - filename for the Sun Microsystems Virtual Box system driver", "source_ref": "indicator--10750290-4efd-4e7b-8dda-cc1a9ae4a8b4", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082"}, {"type": "relationship", "id": "relationship--1c4fdebe-db04-4c33-8875-95d2daeeee12", "created": "2020-06-08T17:53:22.473Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "uses", "description": "Vulnerable VirtualBox kernel driver used to load unsigned kernel driver", "source_ref": "indicator--c3c69da9-8cca-4269-8f8a-1c10503ca9b0", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"type": "relationship", "id": "relationship--1f3a5fce-b42b-4b7e-bec6-b172f3b5b861", "created": "2020-06-08T17:50:21.937Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "uses", "description": "Vulnerable VirtualBox kernel driver used to load unsigned kernel driver", "source_ref": "indicator--c3c69da9-8cca-4269-8f8a-1c10503ca9b0", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63"}, {"type": "relationship", "id": "relationship--214cef56-a85e-4cdf-abbf-f724abf8744f", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.605Z", "relationship_type": "mitigates", "source_ref": "course-of-action--79fd0d10-6272-4191-8b8d-9c72f19358d0", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--21675b90-de06-4e3c-9d53-5c1bea947222", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.074Z", "relationship_type": "mitigates", "source_ref": "course-of-action--21ce34c9-4220-41cf-85c7-bc289bb2c79d", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "relationship", "id": "relationship--2249a7c5-6e76-450f-877b-7557d12a1842", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.608Z", "relationship_type": "mitigates", "source_ref": "course-of-action--5c7619c9-3741-4bcb-920e-755769c77589", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--261b2cc3-3459-48ca-908a-d7c9a8b6827d", "created": "2020-06-08T14:58:19.405Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63"}, {"type": "relationship", "id": "relationship--262bc6f7-1167-4b5f-8f0d-622e9c38ce02", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.077Z", "relationship_type": "mitigates", "source_ref": "course-of-action--f4a8da12-c6f0-4a33-ae42-590c5602be99", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["URL Filtering"]}, {"type": "relationship", "id": "relationship--2ad20cb7-4111-4685-a6cf-1eb8733f2735", "created": "2020-06-11T19:25:17.829Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--10750290-4efd-4e7b-8dda-cc1a9ae4a8b4", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--2b994c5f-e281-4808-92d6-fd0c210cbf5a", "created": "2020-06-12T13:02:07.669Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "[x509-certificate:issuer = '/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)04/CN=VeriSign Class 3 Code Signing 2004 CA' AND x509-certificate:serial_number = '69:3a:64:81:8c:1e:08:6b:1b:15:ae:e6:3f:a0:54:a2' AND x509-certificate:validity_not_before = '2007-06-14T12:00:00Z' AND x509-certificate:validity_not_after = '2012-06-14T12:00:00Z']", "source_ref": "indicator--22359bb6-e940-4414-9971-fbf7317dfe9b", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082"}, {"type": "relationship", "id": "relationship--3557feae-dc4d-485a-a7ae-6879730ae3bc", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--79fd0d10-6272-4191-8b8d-9c72f19358d0", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--35fc4e0e-008f-45c8-94c6-d1a40630b543", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a592acb0-98ba-4a8e-a5cf-2e78d2806e75", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--36d411d3-72eb-44e3-ae6f-de5e76b608d6", "created": "2020-06-08T16:49:02.328Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"type": "relationship", "id": "relationship--3950e32e-d243-4f21-8cce-7938d4f3c9ed", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--8190ac5a-8a5e-41bc-85dd-62e0f5cdd2ba", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--3b3a1f26-d6bb-4e29-8614-8a6a407b8b99", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "id": "relationship--3d924f97-d12f-4cb6-b163-08aac65a84e7", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--55e53da8-b2ba-4bba-a641-c5c75a023bb5", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["NGFW"]}, {"type": "relationship", "id": "relationship--3f49f221-c134-4951-a87d-7debb88e230f", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--fd0da09e-a0b2-4018-9476-1a7edd809b59", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--47503d1c-a408-45bd-8167-3de7ffdef8f7", "created": "2020-06-11T19:25:17.829Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--39f865c8-b888-4535-aabd-3a57bbba7fbb", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--4dee57c3-124b-49e3-a3b3-1e64eb40cb71", "created": "2020-06-08T17:50:21.937Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "indicates", "source_ref": "indicator--c3c69da9-8cca-4269-8f8a-1c10503ca9b0", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--4e5c0bbe-fb62-4295-a02b-a29426cc83ad", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a592acb0-98ba-4a8e-a5cf-2e78d2806e75", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--511e5815-6908-4ae0-8d36-42bca2bc177f", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--911488bc-ccbb-45bb-a6b1-1c172c00beb2", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--54ac7711-48c1-4f22-865d-3b5deb5d179c", "created": "2020-06-08T17:51:59.647Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "indicates", "source_ref": "indicator--4f9613ed-d27e-4c0d-95dd-df64571e6748", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--5c3a4815-1dff-4af2-af0a-d108501c7ab5", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"type": "relationship", "id": "relationship--5d22d838-1cb1-4204-9e1a-a55a754ffe59", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--38519f4f-e6e8-454b-a3f5-b46daef0e316", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["XSOAR"]}, {"type": "relationship", "id": "relationship--5e99bd2b-db13-40a1-9a21-ab96a7550beb", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--2c886776-61fb-487c-a880-41f4b7195627", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["URL Filtering"]}, {"type": "relationship", "id": "relationship--60714b5d-4695-42df-8326-0563cc7b2485", "created": "2020-06-08T15:20:15.033Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"type": "relationship", "id": "relationship--6111c56e-fc84-4e1f-a33c-3b4db9cf76d7", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--ef5f68d8-9522-40b4-890c-31ece644687d", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--62c97562-86bb-46ed-8a43-b35c6af3beef", "created": "2020-06-12T13:02:54.330Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "AcidBox DLL module", "source_ref": "indicator--484f3c69-2329-4642-b1fc-5c1fb3301895", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "id": "relationship--66c40cc3-d51d-4feb-9179-0b6f90c8cdda", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--79fd0d10-6272-4191-8b8d-9c72f19358d0", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--685d35a9-5470-4234-a3af-39167a958782", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--b4ed79f9-b72c-4423-9a9c-f29134fda870", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["NGFW"]}, {"type": "relationship", "id": "relationship--68c03d63-6422-425b-90a4-6644ca39b035", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--5cadeb2b-82c7-4238-8ebd-297df586971e", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--6c7f7e93-013a-4fb8-b610-65354aead9ab", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082"}, {"type": "relationship", "id": "relationship--762f0452-9070-447b-b69a-54196a652481", "created": "2020-06-11T19:25:17.829Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--e2a55d9a-25a6-40bd-b1f2-cef2d32e8d83", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--765b98ee-655f-410a-b6ed-7b87201a475f", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--f4d50de0-ecc5-4f9e-b8f7-214cdfe28d39", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--77eaee82-9fba-40ed-9674-cecbda70ee72", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--5cadeb2b-82c7-4238-8ebd-297df586971e", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--7877f6f7-f6ff-4142-ada6-3b05b8825738", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--5839cd6c-7897-43c4-82f3-5c03096a51c4", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "relationship", "id": "relationship--798d3fdd-590b-4b01-a440-ba27c6d20f0d", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.077Z", "relationship_type": "mitigates", "source_ref": "course-of-action--dff22e97-a89e-4ff7-b615-0165258bf8d5", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["URL Filtering"]}, {"type": "relationship", "id": "relationship--7a385907-7db5-4fdf-ada9-ebc57a60456d", "created": "2020-06-12T12:46:55.110Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--22359bb6-e940-4414-9971-fbf7317dfe9b", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--7a492753-cb3e-4f2a-93cb-d0d2132f7435", "created": "2020-06-12T13:02:54.330Z", "modified": "2020-06-12T15:26:26.572Z", "relationship_type": "uses", "description": "AcidBox DLL module", "source_ref": "indicator--ed06166f-34d7-48fe-9b4d-2c1be6fe256b", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "id": "relationship--7bba60c7-9cd0-4281-a158-d391872457ab", "created": "2020-06-08T17:51:59.647Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "uses", "description": "REG_BINARY data containing encoded payloads to be injected into other processes", "source_ref": "indicator--4f9613ed-d27e-4c0d-95dd-df64571e6748", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"type": "relationship", "id": "relationship--7be13991-f221-48d4-b64d-ef1f343660db", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--ef5f68d8-9522-40b4-890c-31ece644687d", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--7c78b490-5275-4de6-8983-5a8c7672eead", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a592acb0-98ba-4a8e-a5cf-2e78d2806e75", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--7e266487-5c96-41d7-84b9-2b7f7b34b423", "created": "2020-06-17T10:16:03.477Z", "modified": "2020-06-17T12:30:15.098Z", "relationship_type": "uses", "description": "003669761229d3e1db0f5a5b333ef62b3dffcc8e27c821ce9018362e0a2df7e9", "source_ref": "indicator--ed06166f-34d7-48fe-9b4d-2c1be6fe256b", "target_ref": "attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462"}, {"type": "relationship", "id": "relationship--8120ab39-c19d-4f07-a867-97302f0f6952", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.074Z", "relationship_type": "mitigates", "source_ref": "course-of-action--73a0424d-4238-48d2-9dca-676e986644f2", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63", "x_panw_coa_u42_panw_product": ["XSOAR"]}, {"type": "relationship", "id": "relationship--828a7d43-0e73-42ec-8edf-64aa679c3208", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a79d2365-61c7-48b9-b024-e2020b99bba0", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--850d6f45-7b76-4b1f-bf93-0fa011691b87", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--922b1227-c493-43f6-8b4a-ae6d6963eb8b", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["NGFW"]}, {"type": "relationship", "id": "relationship--87babd18-7813-4d41-b4c1-e0c0894b729b", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.605Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a79d2365-61c7-48b9-b024-e2020b99bba0", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--8c04cda3-d299-4115-a2d3-775c2f49aa0d", "created": "2020-06-17T10:17:28.754Z", "modified": "2020-06-17T12:30:15.098Z", "relationship_type": "uses", "description": "b3166c417d49e94f3d9eab9b1e8ab853b58ba59f734f774b5de75ee631a9b66d", "source_ref": "indicator--e2a55d9a-25a6-40bd-b1f2-cef2d32e8d83", "target_ref": "attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462"}, {"type": "relationship", "id": "relationship--8c0b6afa-914c-44bb-bb25-0acd1048d215", "created": "2020-06-17T10:10:47.676Z", "modified": "2020-06-17T12:30:15.097Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462"}, {"type": "relationship", "id": "relationship--8c8321e5-0fdb-4363-a03c-40c91f2a3694", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462"}, {"type": "relationship", "id": "relationship--902a2c8f-23fa-4b23-983a-ff472dc8e73f", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--ef5f68d8-9522-40b4-890c-31ece644687d", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--915f1e1d-f8c4-4c19-b52b-4a574d94dadc", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--c45b79a8-2d29-4d8c-95ab-acea7e478e50", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "relationship", "id": "relationship--92a2f48d-e342-4e7f-ad84-6e8f9944056f", "created": "2020-06-11T19:25:17.829Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--5e97af12-fdf8-4663-9b7d-dfa9fe27070b", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--99550ca1-e3eb-4b67-a6c6-cc04247f6b2f", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--911488bc-ccbb-45bb-a6b1-1c172c00beb2", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--9cbfcecc-9abe-4d76-8176-7dae2f7f7184", "created": "2020-06-17T10:17:51.671Z", "modified": "2020-06-17T12:30:15.098Z", "relationship_type": "uses", "description": "3ad20ca49a979e5ea4a5e154962e7caff17e4ca4f00bec7f3ab89275fcc8f58c", "source_ref": "indicator--484f3c69-2329-4642-b1fc-5c1fb3301895", "target_ref": "attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462"}, {"type": "relationship", "id": "relationship--9e3f2181-900a-40c2-a2d9-167b76536d28", "created": "2020-06-08T12:33:43.273Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "targets", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "identity--72b1e547-5e3e-4862-8c01-d22602821063"}, {"type": "relationship", "id": "relationship--9f748a0c-6ddd-4e5d-ad9d-33df6e50cf27", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a79d2365-61c7-48b9-b024-e2020b99bba0", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--a1a1e92e-7e0c-465e-8991-d196f5c519f1", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--9bcdca50-296d-4032-8639-dc8bc56077a3", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["NGFW"]}, {"type": "relationship", "id": "relationship--a41f0737-5a35-4ffb-9600-0150b80e28c7", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--28f61b3c-18a6-4991-8a17-7cfcd388136c", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["NGFW"]}, {"type": "relationship", "id": "relationship--ab0aebc4-4d09-427d-9fd6-fd4ddce41904", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--fd0da09e-a0b2-4018-9476-1a7edd809b59", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--adb36f2d-8ed5-415b-91c6-6bc6c7e4a6a0", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.605Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a592acb0-98ba-4a8e-a5cf-2e78d2806e75", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--af58a5d7-c406-449b-8329-8d32b48532ee", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.605Z", "relationship_type": "mitigates", "source_ref": "course-of-action--fd0da09e-a0b2-4018-9476-1a7edd809b59", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--b5f12bfc-f4e0-44ab-ad3f-f79604cf04a0", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--911488bc-ccbb-45bb-a6b1-1c172c00beb2", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--b7b02aee-f838-41e1-9026-b6ba23a1996d", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"type": "relationship", "id": "relationship--b9374d67-062d-4db6-8619-1a37d52b2e34", "created": "2020-06-04T15:11:37.652Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "attributed-to", "source_ref": "report--e06ff13e-810a-4f46-be1c-0ede839825d0", "target_ref": "intrusion-set--1541c4c8-a0c4-435f-aff8-60cecf72367a"}, {"type": "relationship", "id": "relationship--bb4797cb-ebb7-4ea0-9c83-47cb6f14cdc8", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.077Z", "relationship_type": "mitigates", "source_ref": "course-of-action--2fd9769c-5e50-4528-985f-a1d117329991", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["URL Filtering"]}, {"type": "relationship", "id": "relationship--bc22b40c-ad02-4aa2-81ec-073af2b6efac", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a1294d38-0f0d-4973-a949-f38cccbc7469", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "relationship", "id": "relationship--bfdb3cb8-37be-4184-8e68-1811735b16f7", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--5cadeb2b-82c7-4238-8ebd-297df586971e", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--c0f12c46-47dd-4b9e-ae58-9a1ca3cba58e", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--44bfcc9e-cb15-499f-b0fe-3c41e2c2655e", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["XSOAR"]}, {"type": "relationship", "id": "relationship--c2f85e64-0c10-43c0-964d-930e2dfd0d7d", "created": "2020-06-11T19:25:17.829Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--ee7c674f-4326-4d6b-b24c-c0901e0d2f34", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--c4311d62-e32b-4c24-aa4d-bc4dabd55c03", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.074Z", "relationship_type": "mitigates", "source_ref": "course-of-action--5cadeb2b-82c7-4238-8ebd-297df586971e", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63", "x_panw_coa_u42_panw_product": ["Cortex XDR Prevent"]}, {"type": "relationship", "id": "relationship--ca49a799-3db5-41e7-b529-d3f3442ab388", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--79fd0d10-6272-4191-8b8d-9c72f19358d0", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--ca9b380b-22d0-4974-b8c6-5e03e3c2fb22", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"type": "relationship", "id": "relationship--d0e98fa8-d162-4480-b515-1c073ea6172f", "created": "2020-06-11T19:25:17.829Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--ed06166f-34d7-48fe-9b4d-2c1be6fe256b", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--d225d0b2-44fb-4ce7-a107-c90962747242", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--a79d2365-61c7-48b9-b024-e2020b99bba0", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--d38bf302-6953-451f-87af-9bb0fb8374b6", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "attributed-to", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "intrusion-set--1541c4c8-a0c4-435f-aff8-60cecf72367a"}, {"type": "relationship", "id": "relationship--d3ea4e66-7802-4f40-bd25-48931b5a516b", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.077Z", "relationship_type": "mitigates", "source_ref": "course-of-action--5e951942-0565-46f4-b09e-80426812b6b5", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["URL Filtering"]}, {"type": "relationship", "id": "relationship--d9066fd9-fba7-44fc-aad3-c1d5ed3bd98b", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:12.605Z", "relationship_type": "mitigates", "source_ref": "course-of-action--ef5f68d8-9522-40b4-890c-31ece644687d", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--dc6520e6-8e84-480e-b99b-a3a514d61cf2", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.074Z", "relationship_type": "mitigates", "source_ref": "course-of-action--49790670-d365-43f8-a906-8e45c3c80f63", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "relationship", "id": "relationship--de8e6a5f-70cd-4f01-9604-a9cfd6f6e5bc", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--d84f79f8-219c-43cb-a918-ab7dd235413a", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "relationship", "id": "relationship--de97227d-28fe-4018-a09b-d25d2faeebe8", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--f4d50de0-ecc5-4f9e-b8f7-214cdfe28d39", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--e77e7044-d492-4e54-a6ec-db96f7407579", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--645c6c45-116e-4265-98d2-e30f56325bc6", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "relationship", "id": "relationship--eb386fbe-7cae-4528-8581-c91b4f8ba5c7", "created": "2020-06-08T17:51:45.316Z", "modified": "2020-06-10T13:43:23.039Z", "relationship_type": "uses", "description": "REG_BINARY data containing encoded payloads to be injected into other processes", "source_ref": "indicator--03076eee-a3a9-4794-b745-681a46391390", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"type": "relationship", "id": "relationship--ec7fe91e-a407-4cba-8446-3e32929f37d3", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--8190ac5a-8a5e-41bc-85dd-62e0f5cdd2ba", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--ef3dabcc-b1de-4d09-a35a-68b197909056", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.075Z", "relationship_type": "mitigates", "source_ref": "course-of-action--41a5e724-166d-496a-bfa6-5f7d671c733e", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["XSOAR"]}, {"type": "relationship", "id": "relationship--ef93e2b0-5309-4c88-931f-3e132a874d46", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.079Z", "relationship_type": "mitigates", "source_ref": "course-of-action--f4d50de0-ecc5-4f9e-b8f7-214cdfe28d39", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--f6ce9737-667d-4fb4-a0d6-a985f5b82d91", "created": "2020-06-11T19:25:17.829Z", "modified": "2020-06-12T15:26:26.571Z", "relationship_type": "indicates", "source_ref": "indicator--484f3c69-2329-4642-b1fc-5c1fb3301895", "target_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876"}, {"type": "relationship", "id": "relationship--fbbe2da2-2395-44eb-b02b-13eb8af3c8e8", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:23.137Z", "relationship_type": "mitigates", "source_ref": "course-of-action--8190ac5a-8a5e-41bc-85dd-62e0f5cdd2ba", "target_ref": "attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "x_panw_coa_u42_panw_product": ["Wildfire"]}, {"type": "relationship", "id": "relationship--fd1afce8-652e-4bd8-968b-cc3fa8eda252", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "relationship_type": "uses", "source_ref": "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63"}, {"type": "relationship", "id": "relationship--febf391a-1d95-4d2d-83d6-876b2a7529a8", "created": "2020-06-23T19:50:42.481Z", "modified": "2020-06-26T19:00:11.076Z", "relationship_type": "mitigates", "source_ref": "course-of-action--befa473a-9ac8-4ff8-b0fe-be0e47821896", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "x_panw_coa_u42_panw_product": ["Threat Prevention"]}, {"type": "report", "id": "report--807b8b8f-2bcc-44fc-a9be-e31c7b1b855b", "created": "2020-06-08T12:22:43.326Z", "modified": "2021-09-29T15:55:04.815Z", "name": "Campaign 1 - AcidBox", "published": "2020-06-08T17:57:10.848Z", "object_refs": ["attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082", "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462", "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839", "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63", "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "campaign--4d1e7ce0-6064-4552-9ca6-23cb83ea7876", "course-of-action--21ce34c9-4220-41cf-85c7-bc289bb2c79d", "course-of-action--28f61b3c-18a6-4991-8a17-7cfcd388136c", "course-of-action--2c886776-61fb-487c-a880-41f4b7195627", "course-of-action--2fd9769c-5e50-4528-985f-a1d117329991", "course-of-action--38519f4f-e6e8-454b-a3f5-b46daef0e316", "course-of-action--41a5e724-166d-496a-bfa6-5f7d671c733e", "course-of-action--44bfcc9e-cb15-499f-b0fe-3c41e2c2655e", "course-of-action--49790670-d365-43f8-a906-8e45c3c80f63", "course-of-action--55e53da8-b2ba-4bba-a641-c5c75a023bb5", "course-of-action--5839cd6c-7897-43c4-82f3-5c03096a51c4", "course-of-action--5c7619c9-3741-4bcb-920e-755769c77589", "course-of-action--5cadeb2b-82c7-4238-8ebd-297df586971e", "course-of-action--5e951942-0565-46f4-b09e-80426812b6b5", "course-of-action--60e78a97-dcc6-4d67-a310-ed7f16e0218a", "course-of-action--645c6c45-116e-4265-98d2-e30f56325bc6", "course-of-action--73a0424d-4238-48d2-9dca-676e986644f2", "course-of-action--79fd0d10-6272-4191-8b8d-9c72f19358d0", "course-of-action--8190ac5a-8a5e-41bc-85dd-62e0f5cdd2ba", "course-of-action--911488bc-ccbb-45bb-a6b1-1c172c00beb2", "course-of-action--922b1227-c493-43f6-8b4a-ae6d6963eb8b", "course-of-action--9bcdca50-296d-4032-8639-dc8bc56077a3", "course-of-action--a1294d38-0f0d-4973-a949-f38cccbc7469", "course-of-action--a592acb0-98ba-4a8e-a5cf-2e78d2806e75", "course-of-action--a79d2365-61c7-48b9-b024-e2020b99bba0", "course-of-action--b1f31bc6-40cd-4c64-805f-1680eda35801", "course-of-action--b4ed79f9-b72c-4423-9a9c-f29134fda870", "course-of-action--befa473a-9ac8-4ff8-b0fe-be0e47821896", "course-of-action--c45b79a8-2d29-4d8c-95ab-acea7e478e50", "course-of-action--c5148c0d-4c4a-4ad6-b2c7-942f9eb91673", "course-of-action--d3c39d4c-3074-4350-832e-9eea942ac353", "course-of-action--d84f79f8-219c-43cb-a918-ab7dd235413a", "course-of-action--dff22e97-a89e-4ff7-b615-0165258bf8d5", "course-of-action--ef5f68d8-9522-40b4-890c-31ece644687d", "course-of-action--f4a8da12-c6f0-4a33-ae42-590c5602be99", "course-of-action--f4d50de0-ecc5-4f9e-b8f7-214cdfe28d39", "course-of-action--fd0da09e-a0b2-4018-9476-1a7edd809b59", "identity--72b1e547-5e3e-4862-8c01-d22602821063", "indicator--03076eee-a3a9-4794-b745-681a46391390", "indicator--10750290-4efd-4e7b-8dda-cc1a9ae4a8b4", "indicator--22359bb6-e940-4414-9971-fbf7317dfe9b", "indicator--39f865c8-b888-4535-aabd-3a57bbba7fbb", "indicator--484f3c69-2329-4642-b1fc-5c1fb3301895", "indicator--4f9613ed-d27e-4c0d-95dd-df64571e6748", "indicator--5e97af12-fdf8-4663-9b7d-dfa9fe27070b", "indicator--c3c69da9-8cca-4269-8f8a-1c10503ca9b0", "indicator--e2a55d9a-25a6-40bd-b1f2-cef2d32e8d83", "indicator--ed06166f-34d7-48fe-9b4d-2c1be6fe256b", "indicator--ee7c674f-4326-4d6b-b24c-c0901e0d2f34", "intrusion-set--1541c4c8-a0c4-435f-aff8-60cecf72367a", "relationship--0021f86a-b604-4cbf-b48d-ad778ce6fcf0", "relationship--011f773f-010e-4f8e-901d-7ffc2cb41ac0", "relationship--04dd51c4-aaa5-4128-bf07-1e8ebfa23681", "relationship--068ee331-72ba-45b0-9dc5-e785e116fdb4", "relationship--076d5ade-2e17-4fac-9884-78e285587a0b", "relationship--07995dc6-5bee-41d3-9cb7-2bfb325bc06e", "relationship--0d246a3a-aa03-41d8-b994-6ae14ffecd4f", "relationship--0ec7450f-6ee5-4a25-8739-8b6bdaf10c72", "relationship--0ee01038-6226-422e-8a64-6aa4a20036b7", "relationship--0ef405ef-5863-4a41-a10a-e787a37bd8bd", "relationship--0f0cdf26-8605-45a5-b5be-d2ca480e4731", "relationship--1030d5e4-5181-485b-be47-3cf30cee917d", "relationship--13a8fcf0-9890-4e1a-89ff-d6a2b1c2d56c", "relationship--15515310-419b-452d-8040-1f59b9443ae1", "relationship--190404eb-2b23-4cdf-8be4-5185c86f4aef", "relationship--1bd446d7-771d-483f-b33c-4a9be9c03e19", "relationship--1c4fdebe-db04-4c33-8875-95d2daeeee12", "relationship--1f3a5fce-b42b-4b7e-bec6-b172f3b5b861", "relationship--214cef56-a85e-4cdf-abbf-f724abf8744f", "relationship--21675b90-de06-4e3c-9d53-5c1bea947222", "relationship--2249a7c5-6e76-450f-877b-7557d12a1842", "relationship--261b2cc3-3459-48ca-908a-d7c9a8b6827d", "relationship--262bc6f7-1167-4b5f-8f0d-622e9c38ce02", "relationship--2ad20cb7-4111-4685-a6cf-1eb8733f2735", "relationship--2b994c5f-e281-4808-92d6-fd0c210cbf5a", "relationship--3557feae-dc4d-485a-a7ae-6879730ae3bc", "relationship--35fc4e0e-008f-45c8-94c6-d1a40630b543", "relationship--36d411d3-72eb-44e3-ae6f-de5e76b608d6", "relationship--3950e32e-d243-4f21-8cce-7938d4f3c9ed", "relationship--3b3a1f26-d6bb-4e29-8614-8a6a407b8b99", "relationship--3d924f97-d12f-4cb6-b163-08aac65a84e7", "relationship--3f49f221-c134-4951-a87d-7debb88e230f", "relationship--47503d1c-a408-45bd-8167-3de7ffdef8f7", "relationship--4dee57c3-124b-49e3-a3b3-1e64eb40cb71", "relationship--4e5c0bbe-fb62-4295-a02b-a29426cc83ad", "relationship--511e5815-6908-4ae0-8d36-42bca2bc177f", "relationship--54ac7711-48c1-4f22-865d-3b5deb5d179c", "relationship--5c3a4815-1dff-4af2-af0a-d108501c7ab5", "relationship--5d22d838-1cb1-4204-9e1a-a55a754ffe59", "relationship--5e99bd2b-db13-40a1-9a21-ab96a7550beb", "relationship--60714b5d-4695-42df-8326-0563cc7b2485", "relationship--6111c56e-fc84-4e1f-a33c-3b4db9cf76d7", "relationship--62c97562-86bb-46ed-8a43-b35c6af3beef", "relationship--66c40cc3-d51d-4feb-9179-0b6f90c8cdda", "relationship--685d35a9-5470-4234-a3af-39167a958782", "relationship--68c03d63-6422-425b-90a4-6644ca39b035", "relationship--6c7f7e93-013a-4fb8-b610-65354aead9ab", "relationship--762f0452-9070-447b-b69a-54196a652481", "relationship--765b98ee-655f-410a-b6ed-7b87201a475f", "relationship--77eaee82-9fba-40ed-9674-cecbda70ee72", "relationship--7877f6f7-f6ff-4142-ada6-3b05b8825738", "relationship--798d3fdd-590b-4b01-a440-ba27c6d20f0d", "relationship--7a385907-7db5-4fdf-ada9-ebc57a60456d", "relationship--7a492753-cb3e-4f2a-93cb-d0d2132f7435", "relationship--7bba60c7-9cd0-4281-a158-d391872457ab", "relationship--7be13991-f221-48d4-b64d-ef1f343660db", "relationship--7c78b490-5275-4de6-8983-5a8c7672eead", "relationship--7e266487-5c96-41d7-84b9-2b7f7b34b423", "relationship--8120ab39-c19d-4f07-a867-97302f0f6952", "relationship--828a7d43-0e73-42ec-8edf-64aa679c3208", "relationship--850d6f45-7b76-4b1f-bf93-0fa011691b87", "relationship--87babd18-7813-4d41-b4c1-e0c0894b729b", "relationship--8c04cda3-d299-4115-a2d3-775c2f49aa0d", "relationship--8c0b6afa-914c-44bb-bb25-0acd1048d215", "relationship--8c8321e5-0fdb-4363-a03c-40c91f2a3694", "relationship--902a2c8f-23fa-4b23-983a-ff472dc8e73f", "relationship--915f1e1d-f8c4-4c19-b52b-4a574d94dadc", "relationship--92a2f48d-e342-4e7f-ad84-6e8f9944056f", "relationship--99550ca1-e3eb-4b67-a6c6-cc04247f6b2f", "relationship--9cbfcecc-9abe-4d76-8176-7dae2f7f7184", "relationship--9e3f2181-900a-40c2-a2d9-167b76536d28", "relationship--9f748a0c-6ddd-4e5d-ad9d-33df6e50cf27", "relationship--a1a1e92e-7e0c-465e-8991-d196f5c519f1", "relationship--a41f0737-5a35-4ffb-9600-0150b80e28c7", "relationship--ab0aebc4-4d09-427d-9fd6-fd4ddce41904", "relationship--adb36f2d-8ed5-415b-91c6-6bc6c7e4a6a0", "relationship--af58a5d7-c406-449b-8329-8d32b48532ee", "relationship--b5f12bfc-f4e0-44ab-ad3f-f79604cf04a0", "relationship--b7b02aee-f838-41e1-9026-b6ba23a1996d", "relationship--bb4797cb-ebb7-4ea0-9c83-47cb6f14cdc8", "relationship--bc22b40c-ad02-4aa2-81ec-073af2b6efac", "relationship--bfdb3cb8-37be-4184-8e68-1811735b16f7", "relationship--c0f12c46-47dd-4b9e-ae58-9a1ca3cba58e", "relationship--c2f85e64-0c10-43c0-964d-930e2dfd0d7d", "relationship--c4311d62-e32b-4c24-aa4d-bc4dabd55c03", "relationship--ca49a799-3db5-41e7-b529-d3f3442ab388", "relationship--ca9b380b-22d0-4974-b8c6-5e03e3c2fb22", "relationship--d0e98fa8-d162-4480-b515-1c073ea6172f", "relationship--d225d0b2-44fb-4ce7-a107-c90962747242", "relationship--d38bf302-6953-451f-87af-9bb0fb8374b6", "relationship--d3ea4e66-7802-4f40-bd25-48931b5a516b", "relationship--d9066fd9-fba7-44fc-aad3-c1d5ed3bd98b", "relationship--dc6520e6-8e84-480e-b99b-a3a514d61cf2", "relationship--de8e6a5f-70cd-4f01-9604-a9cfd6f6e5bc", "relationship--de97227d-28fe-4018-a09b-d25d2faeebe8", "relationship--e77e7044-d492-4e54-a6ec-db96f7407579", "relationship--eb386fbe-7cae-4528-8581-c91b4f8ba5c7", "relationship--ec7fe91e-a407-4cba-8446-3e32929f37d3", "relationship--ef3dabcc-b1de-4d09-a35a-68b197909056", "relationship--ef93e2b0-5309-4c88-931f-3e132a874d46", "relationship--f6ce9737-667d-4fb4-a0d6-a985f5b82d91", "relationship--fbbe2da2-2395-44eb-b02b-13eb8af3c8e8", "relationship--fd1afce8-652e-4bd8-968b-cc3fa8eda252", "relationship--febf391a-1d95-4d2d-83d6-876b2a7529a8"], "labels": ["campaign"]}]}