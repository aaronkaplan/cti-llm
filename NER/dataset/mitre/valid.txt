Riltok	B-Malware
mobile	O
Trojan	O
:	O
A	O
banker	O
with	O
global	O
reach	O
25	O
JUN	O
2019	O
Riltok	B-Malware
is	O
one	O
of	O
numerous	O
families	O
of	O
mobile	O
banking	O
Trojans	O
with	O
standard	O
(	O
for	O
such	O
malware	O
)	O
functions	O
and	O
distribution	O
methods	O
.	O

Originally	O
intended	O
to	O
target	O
the	O
Russian	O
audience	O
,	O
the	O
banker	O
was	O
later	O
adapted	O
,	O
with	O
minimal	O
modifications	O
,	O
for	O
the	O
European	O
“	O
market.	O
”	O
The	O
bulk	O
of	O
its	O
victims	O
(	O
more	O
than	O
90	O
%	O
)	O
reside	O
in	O
Russia	O
,	O
with	O
France	O
in	O
second	O
place	O
(	O
4	O
%	O
)	O
.	O

Third	O
place	O
is	O
shared	O
by	O
Italy	O
,	O
Ukraine	O
,	O
and	O
the	O
United	O
Kingdom	O
.	O

We	O
first	O
detected	O
members	O
of	O
this	O
family	O
back	O
in	O
March	O
2018	O
.	O

Like	O
many	O
other	O
bankers	O
,	O
they	O
were	O
disguised	O
as	O
apps	O
for	O
popular	O
free	O
ad	O
services	O
in	O
Russia	O
.	O

The	O
malware	O
was	O
distributed	O
from	O
infected	O
devices	O
via	O
SMS	O
in	O
the	O
form	O
“	O
%	O
USERNAME	O
%	O
,	O
I	O
’	O
ll	O
buy	O
under	O
a	O
secure	O
transaction	O
.	O

youlabuy	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
ru/7	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
3	I-Indicator
”	O
or	O
“	O
%	O
USERNAME	O
%	O
,	O
accept	O
25,000	O
on	O
Youla	O
youla-protect	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
ru/4	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
7	I-Indicator
”	O
,	O
containing	O
a	O
link	O
to	O
download	O
the	O
Trojan	O
.	O

Other	O
samples	O
were	O
also	O
noticed	O
,	O
posing	O
as	O
a	O
client	O
of	O
a	O
ticket-finding	O
service	O
or	O
as	O
an	O
app	O
store	O
for	O
Android	B-System
.	O

It	O
was	O
late	O
2018	O
when	O
Riltok	B-Malware
climbed	O
onto	O
the	O
international	O
stage	O
.	O

The	O
cybercriminals	O
behind	O
it	O
kept	O
the	O
same	O
masking	O
and	O
distribution	O
methods	O
,	O
using	O
names	O
and	O
icons	O
imitating	O
those	O
of	O
popular	O
free	O
ad	O
services	O
.	O

In	O
November	O
2018	O
,	O
a	O
version	O
of	O
the	O
Trojan	O
for	O
the	O
English	O
market	O
appeared	O
in	O
the	O
shape	O
of	O
Gumtree.apk	B-Indicator
.	O

The	O
SMS	O
message	O
with	O
a	O
link	O
to	O
a	O
banker	O
looked	O
as	O
follows	O
:	O
“	O
%	O
USERNAME	O
%	O
,	O
i	O
send	O
you	O
prepayment	O
gumtree	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
cc/3	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
1	I-Indicator
”	O
.	O

Italian	O
(	O
Subito.apk	B-Indicator
)	O
and	O
French	O
(	O
Leboncoin.apk	B-Indicator
)	O
versions	O
appeared	O
shortly	O
afterwards	O
in	O
January	O
2019	O
.	O

The	O
messages	O
looked	O
as	O
follows	O
:	O
“	O
%	O
USERNAME	O
%	O
,	O
ti	O
ho	O
inviato	O
il	O
soldi	O
sul	O
subito	O
subito-a	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
pw/6	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
5	I-Indicator
”	O
(	O
It	O
.	O

)	O
“	O
%	O
USERNAME	O
%	O
,	O
ti	O
ho	O
inviato	O
il	O
pagamento	O
subitop	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
pw/4	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
7	I-Indicator
”	O
(	O
It	O
.	O

)	O
“	O
%	O
USERNAME	O
%	O
,	O
je	O
vous	O
ai	O
envoyé	O
un	O
prepaiement	O
m-leboncoin	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
top/7	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
3	I-Indicator
”	O
(	O
Fr	O
.	O

)	O
“	O
%	O
USERNAME	O
%	O
,	O
j	O
’	O
ai	O
fait	O
l	O
’	O
avance	O
(	O
suivi	O
d	O
’	O
un	O
lien	O
)	O
:	O
leboncoin-le	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/8	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
*	I-Indicator
9	I-Indicator
”	O
(	O
Fr	O
.	O

)	O
Let	O
’	O
s	O
take	O
a	O
more	O
detailed	O
look	O
at	O
how	O
this	O
banking	O
Trojan	O
works	O
.	O

Infection	O
The	O
user	O
receives	O
an	O
SMS	O
with	O
a	O
malicious	O
link	O
pointing	O
to	O
a	O
fake	O
website	O
simulating	O
a	O
popular	O
free	O
ad	O
service	O
.	O

There	O
,	O
they	O
are	O
prompted	O
to	O
download	O
a	O
new	O
version	O
of	O
the	O
mobile	O
app	O
,	O
under	O
which	O
guise	O
the	O
Trojan	O
is	O
hidden	O
.	O

To	O
be	O
installed	O
,	O
it	O
needs	O
the	O
victim	O
to	O
allow	O
installation	O
of	O
apps	O
from	O
unknown	O
sources	O
in	O
the	O
device	O
settings	O
.	O

During	O
installation	O
,	O
Riltok	B-Malware
asks	O
the	O
user	O
for	O
permission	O
to	O
use	O
special	O
features	O
in	O
AccessibilityService	O
by	O
displaying	O
a	O
fake	O
warning	O
:	O
If	O
the	O
user	O
ignores	O
or	O
declines	O
the	O
request	O
,	O
the	O
window	O
keeps	O
opening	O
ad	O
infinitum	O
.	O

After	O
obtaining	O
the	O
desired	O
rights	O
,	O
the	O
Trojan	O
sets	O
itself	O
as	O
the	O
default	O
SMS	O
app	O
(	O
by	O
independently	O
clicking	O
Yes	O
in	O
AccessibilityService	O
)	O
,	O
before	O
vanishing	O
from	O
the	O
device	O
screen	O
.	O

After	O
enabling	O
AccessibilityService	O
,	O
the	O
malware	O
sets	O
itself	O
as	O
the	O
default	O
SMS	O
app	O
Now	O
installed	O
and	O
having	O
obtained	O
the	O
necessary	O
permissions	O
from	O
the	O
user	O
,	O
Riltok	B-Malware
contacts	O
its	O
C	O
&	O
C	O
server	O
.	O

In	O
later	O
versions	O
,	O
when	O
it	O
starts	O
,	O
the	O
Trojan	O
additionally	O
opens	O
a	O
phishing	O
site	O
in	O
the	O
browser	O
that	O
simulates	O
a	O
free	O
ad	O
service	O
so	O
as	O
to	O
dupe	O
the	O
user	O
into	O
entering	O
their	O
login	O
credentials	O
and	O
bank	O
card	O
details	O
.	O

The	O
entered	O
data	O
is	O
forwarded	O
to	O
the	O
cybercriminals	O
.	O

Phishing	O
page	O
from	O
the	O
French	O
version	O
of	O
the	O
Trojan	O
Communication	O
with	O
C	O
&	O
C	O
Riltok	B-Malware
actively	O
communicates	O
with	O
its	O
C	O
&	O
C	O
server	O
.	O

First	O
off	O
,	O
it	O
registers	O
the	O
infected	O
device	O
in	O
the	O
administrative	O
panel	O
by	O
sending	O
a	O
GET	O
request	O
to	O
the	O
relative	O
address	O
gate.php	B-Indicator
(	O
in	O
later	O
versions	O
gating.php	B-Indicator
)	O
with	O
the	O
ID	O
(	O
device	O
identifier	O
generated	O
by	O
the	O
setPsuedoID	O
function	O
in	O
a	O
pseudo-random	O
way	O
based	O
on	O
the	O
device	O
IMEI	O
)	O
and	O
screen	O
(	O
shows	O
if	O
the	O
device	O
is	O
active	O
,	O
possible	O
values	O
are	O
“	O
on	O
”	O
,	O
“	O
off	O
”	O
,	O
“	O
none	O
”	O
)	O
parameters	O
.	O

Then	O
,	O
using	O
POST	O
requests	O
to	O
the	O
relative	O
address	O
report.php	B-Indicator
,	O
it	O
sends	O
data	O
about	O
the	O
device	O
(	O
IMEI	O
,	O
phone	O
number	O
,	O
country	O
,	O
mobile	O
operator	O
,	O
phone	O
model	O
,	O
availability	O
of	O
root	O
rights	O
,	O
OS	O
version	O
)	O
,	O
list	O
of	O
contacts	O
,	O
list	O
of	O
installed	O
apps	O
,	O
incoming	O
SMS	O
,	O
and	O
other	O
information	O
.	O

From	O
the	O
server	O
,	O
the	O
Trojan	O
receives	O
commands	O
(	O
for	O
example	O
,	O
to	O
send	O
SMS	O
)	O
and	O
changes	O
in	O
the	O
configuration	O
.	O

Trojan	O
anatomy	O
The	O
family	O
was	O
named	O
Riltok	B-Malware
after	O
the	O
librealtalk-jni.so	B-Indicator
library	O
contained	O
in	O
the	O
APK	O
file	O
of	O
the	O
Trojan	O
.	O

The	O
library	O
includes	O
such	O
operations	O
as	O
:	O
Get	O
address	O
of	O
cybercriminal	O
C	O
&	O
C	O
server	O
Get	O
configuration	O
file	O
with	O
web	O
injects	O
from	O
C	O
&	O
C	O
,	O
as	O
well	O
as	O
default	O
list	O
of	O
injects	O
Scan	O
for	O
app	O
package	O
names	O
that	O
generated	O
AccessibilityEvent	O
events	O
in	O
the	O
list	O
of	O
known	O
banking/antivirus/other	O
popular	O
apps	O
Set	O
malware	O
as	O
default	O
SMS	O
app	O
Get	O
address	O
of	O
the	O
phishing	O
page	O
that	O
opens	O
when	O
the	O
app	O
runs	O
,	O
and	O
others	O
getStartWebUrl	O
function	O
–	O
get	O
address	O
of	O
phishing	O
page	O
The	O
configuration	O
file	O
contains	O
a	O
list	O
of	O
injects	O
for	O
mobile	O
banking	O
apps	O
–	O
links	O
to	O
phishing	O
pages	O
matching	O
the	O
mobile	O

banking	O
app	O
used	O
by	O
the	O
user	O
.	O

In	O
most	O
so-called	O
Western	O
versions	O
of	O
the	O
Trojan	O
,	O
the	O
package	O
names	O
in	O
the	O
default	O
configuration	O
file	O
are	O
erased	O
.	O

Sample	O
configuration	O
file	O
of	O
the	O
Trojan	O
Through	O
AccessibilityService	O
,	O
the	O
malware	O
monitors	O
AccessibilityEvent	O
events	O
.	O

Depending	O
on	O
which	O
app	O
(	O
package	O
name	O
)	O
generated	O
the	O
event	O
,	O
Riltok	B-Malware
can	O
:	O
Open	O
a	O
fake	O
Google	B-System
Play	I-System
screen	O
requesting	O
bank	O
card	O
details	O
Open	O
a	O
fake	O
screen	O
or	O
phishing	O
page	O
in	O
a	O
browser	O
(	O
inject	O
)	O
mimicking	O
the	O
screen	O
of	O
the	O
relevant	O
mobile	O
banking	O
app	O
and	O
requesting	O
user/bank	O
card	O
details	O
Minimize	O
the	O
app	O
(	O
for	O
example	O
,	O
antivirus	O
applications	O
or	O
device	O
security	O
settings	O
)	O
Additionally	O
,	O
the	O
Trojan	O
can	O
hide	O
notifications	O
from	O
certain	O
banking	O
apps	O
.	O

List	O
of	O
package	O
names	O
of	O
apps	O
on	O
events	O
from	O
which	O
the	O
Trojan	O
opens	O
a	O
fake	O
Google	B-System
Play	I-System
window	O
(	O
for	O
the	O
Russian	O
version	O
of	O
the	O
Trojan	O
)	O
Example	O
of	O
Trojan	O
screen	O
overlapping	O
other	O
apps	O
When	O
bank	O
card	O
details	O
are	O
entered	O
in	O
the	O
fake	O
window	O
,	O
Riltok	O
performs	O
basic	O
validation	O
checks	O
:	O
card	O
validity	O
period	O
,	O
number	O
checksum	O
,	O
CVC	O
length	O
,	O
whether	O
the	O
number	O
is	O
in	O
the	O
denylist	O
sewn	O
into	O
the	O
Trojan	O
code	O
:	O
Examples	O
of	O
phishing	O
pages	O
imitating	O
mobile	O
banks	O
At	O
the	O
time	O
of	O
writing	O
,	O
the	O
functionality	O
of	O
most	O
of	O
the	O
Western	O
versions	O
of	O
Riltok	O

was	O
somewhat	O
pared	O
down	O
compared	O
to	O
the	O
Russian	O
one	O
.	O

For	O
example	O
,	O
the	O
default	O
configuration	O
file	O
with	O
injects	O
is	O
non-operational	O
,	O
and	O
the	O
malware	O
contains	O
no	O
fake	O
built-in	O
windows	O
requesting	O
bank	O
card	O
details	O
.	O

Conclusion	O
Threats	O
are	O
better	O
prevented	O
than	O
cured	O
,	O
so	O
do	O
not	O
follow	O
suspicious	O
links	O
in	O
SMS	O
,	O
and	O
be	O
sure	O
to	O
install	O
apps	O
only	O
from	O
official	O
sources	O
and	O
check	O
what	O
permissions	O
you	O
are	O
granting	O
during	O
installation	O
.	O

As	O
Riltok	B-Malware
shows	O
,	O
cybercriminals	O
can	O
apply	O
the	O
same	O
methods	O
of	O
infection	O
to	O
victims	O
in	O
different	O
countries	O
with	O
more	O
or	O
less	O
the	O
same	O
success	O
.	O

Kaspersky	B-Organization
products	O
detect	O
the	O
above-described	O
threat	O
with	O
the	O
verdict	O
Trojan-Banker.AndroidOS.Riltok	B-Indicator
.	O

IoCs	O
C	O
&	O
C	O
100.51.100.00	B-Indicator
108.62.118.131	B-Indicator
172.81.134.165	B-Indicator
172.86.120.207	B-Indicator
185.212.128.152	B-Indicator
185.212.128.192	B-Indicator
185.61.000.108	B-Indicator
185.61.138.108	B-Indicator
185.61.138.37	B-Indicator
188.209.52.101	B-Indicator
5.206.225.57	B-Indicator
alr992.date	B-Indicator
avito-app.pw	B-Indicator
backfround2.pw	B-Indicator
background1.xyz	B-Indicator
blacksolider93.com	B-Indicator
blass9g087.com	B-Indicator
brekelter2.com	B-Indicator
broplar3hf.xyz	B-Indicator
buy-youla.ru	B-Indicator

cd78cg210xy0.com	B-Indicator
copsoiteess.com	B-Indicator
farmatefc93.org	B-Indicator
firstclinsop.com	B-Indicator
holebrhuhh3.com	B-Indicator
holebrhuhh45.com	B-Indicator
karambga3j.net	B-Indicator
le22999a.pw	B-Indicator
leboncoin-bk.top	B-Indicator
leboncoin-buy.pw	B-Indicator
leboncoin-cz.info	B-Indicator
leboncoin-f.pw	B-Indicator
leboncoin-jp.info	B-Indicator
leboncoin-kp.top	B-Indicator
leboncoin-ny.info	B-Indicator
leboncoin-ql.top	B-Indicator
leboncoin-tr.info	B-Indicator

myyoula.ru	B-Indicator
sell-avito.ru	B-Indicator
sell-youla.ru	B-Indicator
sentel8ju67.com	B-Indicator
subito-li.pw	B-Indicator
subitop.pw	B-Indicator
web-gumtree.com	B-Indicator
whitehousejosh.com	B-Indicator
whitekalgoy3.com	B-Indicator
youlaprotect.ru	B-Indicator
Examples	O
of	O
malware	O
0497b6000a7a23e9e9b97472bc2d3799caf49cbbea1627ad4d87ae6e0b7e2a98	B-Indicator
417fc112cd0610cc8c402742b0baab0a086b5c4164230009e11d34fdeee7d3fa	B-Indicator

54594edbe9055517da2836199600f682dee07e6b405c6fe4b476627e8d184bfe	B-Indicator
6e995d68c724f121d43ec2ff59bc4e536192360afa3beaec5646f01094f0b745	B-Indicator
bbc268ca63eeb27e424fec1b3976bab550da304de18e29faff94d9057b1fa25a	B-Indicator
dc3dd9d75120934333496d0a4100252b419ee8fcdab5d74cf343bcb0306c9811	B-Indicator

e3f77ff093f322e139940b33994c5a57ae010b66668668dc4945142a81bcc049	B-Indicator
ebd0a8043434edac261cb25b94f417188a5c0d62b5dd4033f156b890d150a4c5	B-Indicator
f51a27163cb0ddd08caa29d865b9f238848118ba2589626af711330481b352df	B-Indicator
Tracking	O
down	O
the	O
developer	O
of	O
Android	B-System
adware	O
affecting	O

millions	O
of	O
users	O
24	O
Oct	O
2019	O
-	O
11:30AM	O
We	O
detected	O
a	O
large	O
adware	O
campaign	O
running	O
for	O
about	O
a	O
year	O
,	O
with	O
the	O
involved	O
apps	O
installed	O
eight	O
million	O
times	O
from	O
Google	B-System
Play	I-System
alone	O
.	O

We	O
identified	O
42	O
apps	O
on	O
Google	B-System
Play	I-System
as	O
belonging	O
to	O
the	O
campaign	O
,	O
which	O
had	O
been	O
running	O
since	O
July	O
2018	O
.	O

Of	O
those	O
,	O
21	O
were	O
still	O
available	O
at	O
the	O
time	O
of	O
discovery	O
.	O

We	O
reported	O
the	O
apps	O
to	O
the	O
Google	O
security	O
team	O
and	O
they	O
were	O
swiftly	O
removed	O
.	O

However	O
,	O
the	O
apps	O
are	O
still	O
available	O
in	O
third-party	O
app	O
stores	O
.	O

ESET	B-Organization
detects	O
this	O
adware	O
,	O
collectively	O
,	O
as	O
Android/AdDisplay.Ashas	B-Malware
.	O

Figure	O
1	O
.	O

Apps	O
of	O
the	O
Android/AdDisplay.Ashas	B-Malware
family	O
reported	O
to	O
Google	O
by	O
ESET	B-Organization
Figure	O
2	O
.	O

The	O
most	O
popular	O
member	O
of	O
the	O
Android/AdDisplay.Ashas	B-Malware
family	I-Malware
on	O
Google	B-System
Play	I-System
was	O
“	O
Video	O
downloader	O
master	O
”	O
with	O
over	O
five	O
million	O
downloads	O
Ashas	B-Malware
functionality	O
All	O
the	O
apps	O
provide	O
the	O
functionality	O
they	O
promise	O
,	O
besides	O
working	O
as	O
adware	O
.	O

The	O
adware	O
functionality	O
is	O
the	O
same	O
in	O
all	O
the	O
apps	O
we	O
analyzed	O
.	O

[	O
Note	O
:	O
The	O
analysis	O
of	O
the	O
functionality	O
below	O
describes	O
a	O
single	O
app	O
,	O
but	O
applies	O
to	O
all	O
apps	O
of	O
the	O
Android/AdDisplay.Ashas	B-Malware
family	I-Malware
.	O

]	O
Once	O
launched	O
,	O
the	O
app	O
starts	O
to	O
communicate	O
with	O
its	O
C	O
&	O
C	O
server	O
(	O
whose	O
IP	O
address	O
is	O
base64-encoded	O
in	O
the	O
app	O
)	O
.	O

It	O
sends	O
“	O
home	O
”	O
key	O
data	O
about	O
the	O
affected	O
device	O
:	O
device	O
type	O
,	O
OS	O
version	O
,	O
language	O
,	O
number	O
of	O
installed	O
apps	O
,	O
free	O
storage	O
space	O
,	O
battery	O
status	O
,	O
whether	O
the	O
device	O
is	O
rooted	O
and	O
Developer	O
mode	O
enabled	O
,	O
and	O
whether	O
Facebook	B-Organization
and	O
FB	O
Messenger	B-System
are	O
installed	O
.	O

Figure	O
3	O
.	O

Sending	O
information	O
about	O
the	O
affected	O
device	O
The	O
app	O
receives	O
configuration	O
data	O
from	O
the	O
C	O
&	O
C	O
server	O
,	O
needed	O
for	O
displaying	O
ads	O
,	O
and	O
for	O
stealth	O
and	O
resilience	O
.	O

Figure	O
4	O
.	O

Configuration	O
file	O
received	O
from	O
the	O
C	O
&	O
C	O
server	O
As	O
for	O
stealth	O
and	O
resilience	O
,	O
the	O
attacker	O
uses	O
a	O
number	O
of	O
tricks	O
.	O

First	O
,	O
the	O
malicious	O
app	O
tries	O
to	O
determine	O
whether	O
it	O
is	O
being	O
tested	O
by	O
the	O
Google	B-System
Play	I-System
security	O
mechanism	O
.	O

For	O
this	O
purpose	O
,	O
the	O
app	O
receives	O
from	O
the	O
C	O
&	O
C	O
server	O
the	O
isGoogleIp	O
flag	O
,	O
which	O
indicates	O
whether	O
the	O
IP	O
address	O
of	O
the	O
affected	O
device	O
falls	O
within	O
the	O
range	O
of	O
known	O
IP	O
addresses	O
for	O
Google	O
servers	O
.	O

If	O
the	O
server	O
returns	O
this	O
flag	O
as	O
positive	O
,	O
the	O
app	O
will	O
not	O
trigger	O
the	O
adware	O
payload	O
.	O

Second	O
,	O
the	O
app	O
can	O
set	O
a	O
custom	O
delay	O
between	O
displaying	O
ads	O
.	O

The	O
samples	O
we	O
have	O
seen	O
had	O
their	O
configuration	O
set	O
to	O
delay	O
displaying	O
the	O
first	O
ad	O
by	O
24	O
minutes	O
after	O
the	O
device	O
unlocks	O
.	O

This	O
delay	O
means	O
that	O
a	O
typical	O
testing	O
procedure	O
,	O
which	O
takes	O
less	O
than	O
10	O
minutes	O
,	O
will	O
not	O
detect	O
any	O
unwanted	O
behavior	O
.	O

Also	O
,	O
the	O
longer	O
the	O
delay	O
,	O
the	O
lower	O
the	O
risk	O
of	O
the	O
user	O
associating	O
the	O
unwanted	O
ads	O
with	O
a	O
particular	O
app	O
.	O

Third	O
,	O
based	O
on	O
the	O
server	O
response	O
,	O
the	O
app	O
can	O
also	O
hide	O
its	O
icon	O
and	O
create	O
a	O
shortcut	O
instead	O
.	O

If	O
a	O
typical	O
user	O
tries	O
to	O
get	O
rid	O
of	O
the	O
malicious	O
app	O
,	O
chances	O
are	O
that	O
only	O
the	O
shortcut	O
ends	O
up	O
getting	O
removed	O
.	O

The	O
app	O
then	O
continues	O
to	O
run	O
in	O
the	O
background	O
without	O
the	O
user	O
’	O
s	O
knowledge	O
.	O

This	O
stealth	O
technique	O
has	O
been	O
gaining	O
popularity	O
among	O
adware-related	O
threats	O
distributed	O
via	O
Google	B-System
Play	I-System
.	O

Figure	O
5	O
.	O

Time	O
delay	O
to	O
postpone	O
displaying	O
ads	O
implemented	O
by	O
the	O
adware	O
Once	O
the	O
malicious	O
app	O
receives	O
its	O
configuration	O
data	O
,	O
the	O
affected	O
device	O
is	O
ready	O
to	O
display	O
ads	O
as	O
per	O
the	O
attacker	O
’	O
s	O
choice	O
;	O
each	O
ad	O
is	O
displayed	O
as	O
a	O
full	O
screen	O
activity	O
.	O

If	O
the	O
user	O
wants	O
to	O
check	O
which	O
app	O
is	O
responsible	O
for	O
the	O
ad	O
being	O
displayed	O
,	O
by	O
hitting	O
the	O
“	O
Recent	O
apps	O
”	O
button	O
,	O
another	O
trick	O
is	O
used	O
:	O
the	O
app	O
displays	O
a	O
Facebook	B-Organization
or	O
Google	B-Organization
icon	O
,	O
as	O
seen	O
in	O
Figure	O
6	O
.	O

The	O
adware	O
mimics	O
these	O
two	O
apps	O
to	O
look	O
legitimate	O
and	O
avoid	O
suspicion	O
–	O
and	O
thus	O
stay	O
on	O
the	O
affected	O
device	O
for	O
as	O
long	O
as	O
possible	O
.	O

Figure	O
6	O
.	O

The	O
adware	O
activity	O
impersonates	O
Facebook	B-Organization
(	O
left	O
)	O
.	O

If	O
the	O
user	O
long-presses	O
the	O
icon	O
,	O
the	O
name	O
of	O
the	O
app	O
responsible	O
for	O
the	O
activity	O
is	O
revealed	O
(	O
right	O
)	O
.	O

Finally	O
,	O
the	O
Ashas	B-Malware
adware	O
family	O
has	O
its	O
code	O
hidden	O
under	O
the	O
com.google.xxx	O
package	O
name	O
.	O

This	O
trick	O
–	O
posing	O
as	O
a	O
part	O
of	O
a	O
legitimate	O
Google	B-Organization
service	O
–	O
may	O
help	O
avoid	O
scrutiny	O
.	O

Some	O
detection	O
mechanisms	O
and	O
sandboxes	O
may	O
whitelist	O
such	O
package	O
names	O
,	O
in	O
an	O
effort	O
to	O
prevent	O
wasting	O
resources	O
.	O

Figure	O
7	O
.	O

Malicious	O
code	O
hidden	O
in	O
a	O
package	O
named	O
“	O
com.google	O
”	O
Hunting	O
down	O
the	O
developer	O
Using	O
open-source	O
information	O
,	O
we	O
tracked	O
down	O
the	O
developer	O
of	O
the	O
adware	O
,	O
who	O
we	O
also	O
identified	O
as	O
the	O
campaign	O
’	O
s	O
operator	O
and	O
owner	O
of	O
the	O
C	O
&	O
C	O
server	O
.	O

In	O
the	O
following	O
paragraphs	O
,	O
we	O
outline	O
our	O
efforts	O
to	O
discover	O
other	O
applications	O
from	O
the	O
same	O
developer	O
and	O
protect	O
our	O
users	O
from	O
it	O
.	O

First	O
,	O
based	O
on	O
information	O
that	O
is	O
associated	O
with	O
the	O
registered	O
C	O
&	O
C	O
domain	O
,	O
we	O
identified	O
the	O
name	O
of	O
the	O
registrant	O
,	O
along	O
with	O
further	O
data	O
like	O
country	O
and	O
email	O
address	O
,	O
as	O
seen	O
in	O
Figure	O
8	O
.	O

Figure	O
8	O
.	O

Information	O
about	O
the	O
C	O
&	O
C	O
domain	O
used	O
by	O
the	O
Ashas	B-Malware
adware	O
Knowing	O
that	O
the	O
information	O
provided	O
to	O
a	O
domain	O
registrar	O
might	O
be	O
fake	O
,	O
we	O
continued	O
our	O
search	O
.	O

The	O
email	O
address	O
and	O
country	O
information	O
drove	O
us	O
to	O
a	O
list	O
of	O
students	O
attending	O
a	O
class	O
at	O
a	O
Vietnamese	O
university	O
–	O
corroborating	O
the	O
existence	O
of	O
the	O
person	O
under	O
whose	O
name	O
the	O
domain	O
was	O
registered	O
.	O

Figure	O
9	O
.	O

A	O
university	O
class	O
student	O
list	O
including	O
the	O
C	O
&	O
C	O
domain	O
registrant	O
Due	O
to	O
poor	O
privacy	O
practices	O
on	O
the	O
part	O
of	O
our	O
culprit	O
’	O
s	O
university	O
,	O
we	O
now	O
know	O
his	O
date	O
of	O
birth	O
(	O
probably	O
:	O
he	O
seemingly	O
used	O
his	O
birth	O
year	O
as	O
part	O
of	O
his	O
Gmail	B-System
address	O
,	O
as	O
further	O
partial	O
confirmation	O
)	O
,	O
we	O
know	O
that	O
he	O
was	O
a	O
student	O
and	O
what	O
university	O
he	O
attended	O
.	O

We	O
were	O
also	O
able	O
to	O
confirm	O
that	O
the	O
phone	O
number	O
he	O
provided	O
to	O
the	O
domain	O
registrar	O
was	O
genuine	O
.	O

Moreover	O
,	O
we	O
retrieved	O
his	O
University	O
ID	O
;	O
a	O
quick	O
googling	O
showed	O
some	O
of	O
his	O
exam	O
grades	O
.	O

However	O
,	O
his	O
study	O
results	O
are	O
out	O
of	O
the	O
scope	O
of	O
our	O
research	O
.	O

Based	O
on	O
our	O
culprit	O
’	O
s	O
email	O
address	O
,	O
we	O
were	O
able	O
to	O
find	O
his	O
GitHub	B-Organization
repository	O
.	O

His	O
repository	O
proves	O
that	O
he	O
is	O
indeed	O
an	O
Android	B-System
developer	O
,	O
but	O
it	O
contained	O
no	O
publicly	O
available	O
code	O
of	O
the	O
Ashas	B-Malware
adware	O
at	O
the	O
time	O
of	O
writing	O
of	O
this	O
blogpost	O
.	O

However	O
,	O
a	O
simple	O
Google	B-Organization
search	O
for	O
the	O
adware	O
package	O
name	O
returned	O
a	O
“	O
TestDelete	O
”	O
project	O
that	O
had	O
been	O
available	O
in	O
his	O
repository	O
at	O
some	O
point	O
The	O
malicious	O
developer	O
also	O
has	O
apps	O
in	O
Apple	B-Organization
’	O
s	O
App	B-System
Store	I-System
.	O

Some	O
of	O
them	O
are	O
iOS	B-System
versions	O
of	O
the	O
ones	O
removed	O
from	O
Google	B-System
Play	I-System
,	O
but	O
none	O
contain	O
adware	O
functionality	O
.	O

Figure	O
10	O
.	O

The	O
malicious	O
developer	O
’	O
s	O
apps	O
published	O
on	O
the	O
App	O
Store	O
which	O
don	O
’	O
t	O
contain	O
the	O
Ashas	B-Malware
adware	O
Searching	O
further	O
for	O
the	O
malicious	O
developer	O
’	O
s	O
activities	O
,	O
we	O
also	O
discovered	O
his	O
Youtube	B-System
channel	O
propagating	O
the	O
Ashas	B-Malware
adware	O
and	O
his	O
other	O
projects	O
.	O

As	O
for	O
the	O
Ashas	B-Malware
family	O
,	O
one	O
of	O
the	O
associated	O
promotional	O
videos	O
,	O
“	O
Head	O
Soccer	O
World	O
Champion	O
2018	O
–	O
Android	B-System
,	O
ios	B-System
”	O
was	O
viewed	O
almost	O
three	O
million	O
times	O
and	O
two	O
others	O
reached	O
hundreds	O
of	O
thousands	O
of	O
views	O
,	O
as	O
seen	O
in	O
Figure	O
11	O
.	O

Figure	O
11	O
.	O

YouTube	B-System
channel	O
of	O
the	O
malicious	O
developer	O
His	O
YouTube	B-System
channel	O
provided	O
us	O
with	O
another	O
valuable	O
piece	O
of	O
information	O
:	O
he	O
himself	O
features	O
in	O
a	O
video	O
tutorial	O
for	O
one	O
of	O
his	O
other	O
projects	O
.	O

Thanks	O
to	O
that	O
project	O
,	O
we	O
were	O
able	O
to	O
extract	O
his	O
Facebook	B-Organization
profile	O
–	O
which	O
lists	O
his	O
studies	O
at	O
the	O
aforementioned	O
university	O
.	O

Figure	O
12	O
.	O

Facebook	B-Organization
profile	O
of	O
the	O
C	O
&	O
C	O
domain	O
registrar	O
(	O
cover	O
picture	O
and	O
profile	O
picture	O
edited	O
out	O
)	O
Linked	O
on	O
the	O
malicious	O
developer	O
’	O
s	O
Facebook	B-Organization
profile	O
,	O
we	O
discovered	O
a	O
Facebook	B-Organization
page	O
,	O
Minigameshouse	B-Indicator
,	O
and	O
an	O
associated	O
domain	O
,	O
minigameshouse	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
net	I-Indicator
.	O

This	O
domain	O
is	O
similar	O
to	O
the	O
one	O
the	O
malware	O
author	O
used	O
for	O
his	O
adware	O
C	O
&	O
C	O
communication	O
,	O
minigameshouse	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
us	I-Indicator
.	O

Checking	O
this	O
Minigameshouse	B-Indicator
page	O
further	O
indicates	O
that	O
this	O
person	O
is	O
indeed	O
the	O
owner	O
of	O
the	O
minigameshouse	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
us	I-Indicator
domain	I-Indicator
:	O
the	O
phone	O
number	O
registered	O
with	O
this	O
domain	O
is	O
the	O
same	O
as	O
the	O
phone	O
number	O
appearing	O
on	O
the	O
Facebook	B-Organization
page	O
.	O

Figure	O
13	O
.	O

Facebook	B-Organization
page	O
managed	O
by	O
the	O
C	O
&	O
C	O
domain	O
registrant	O
uses	O
the	O
same	O
base	O
domain	O
name	O
(	O
minigameshouse	O
)	O
and	O
phone	O
number	O
as	O
the	O
registered	O
malicious	O
C	O
&	O
C	O
used	O
by	O
the	O
Ashas	B-Malware
adware	O
Of	O
interest	O
is	O
that	O
on	O
the	O
Minigameshouse	O
Facebook	B-Organization
page	O
,	O
the	O
malicious	O
developer	O
promotes	O
a	O
slew	O
of	O
games	O
beyond	O
the	O
Ashas	B-Malware
family	O
for	O
download	O
on	O
both	O
Google	B-System
Play	I-System
and	O
the	O
App	B-System
Store	I-System
.	O

However	O
,	O
all	O
of	O
those	O
have	O
been	O
removed	O
from	O
Google	B-System
Play	I-System
–	O
despite	O
the	O
fact	O
that	O
some	O
of	O
them	O
didn	O
’	O
t	O
contain	O
any	O
adware	O
functionality	O
.	O

On	O
top	O
of	O
all	O
this	O
,	O
one	O
of	O
the	O
malicious	O
developer	O
’	O
s	O
YouTube	B-System
videos	O
–	O
a	O
tutorial	O
on	O
developing	O
an	O
“	O
Instant	O
Game	O
”	O
for	O
Facebook	B-Organization
–	O
serves	O
as	O
an	O
example	O
of	O
operational	O
security	O
completely	O
ignored	O
.	O

We	O
were	O
able	O
to	O
see	O
that	O
his	O
recently	O
visited	O
web	O
sites	O
were	O
Google	B-System
Play	I-System
pages	O
belonging	O
to	O
apps	O
containing	O
the	O
Ashas	B-Malware
adware	I-Malware
.	O

He	O
also	O
used	O
his	O
email	O
account	O
to	O
log	O
into	O
various	O
services	O
in	O
the	O
video	O
,	O
which	O
identifies	O
him	O
as	O
the	O
adware	O
domain	O
owner	O
,	O
beyond	O
any	O
doubt	O
.	O

Thanks	O
to	O
the	O
video	O
,	O
we	O
were	O
even	O
able	O
to	O
identify	O
three	O
further	O
apps	O
that	O
contained	O
adware	O
functionality	O
and	O
were	O
available	O
on	O
Google	B-System
Play	I-System
.	O

Figure	O
14	O
.	O

Screenshots	O
from	O
this	O
developer	O
’	O
s	O
YouTube	B-System
video	O
shows	O
history	O
of	O
checking	O
Ashas	B-Malware
adware	O
on	O
Google	B-System
Play	I-System
ESET	B-Organization
telemetry	O
Figure	O
15	O
.	O

ESET	B-Organization
detections	O
of	O
Android/AdDisplay.Ashas	B-Malware
on	O
Android	O
devices	O
by	O
country	O
Is	O
adware	O
harmful	O
?	O

Because	O
the	O
real	O
nature	O
of	O
apps	O
containing	O
adware	O
is	O
usually	O
hidden	O
to	O
the	O
user	O
,	O
these	O
apps	O
and	O
their	O
developers	O
should	O
be	O
considered	O
untrustworthy	O
.	O

When	O
installed	O
on	O
a	O
device	O
,	O
apps	O
containing	O
adware	O
may	O
,	O
among	O
other	O
things	O
:	O
Annoy	O
users	O
with	O
intrusive	O
advertisements	O
,	O
including	O
scam	O
ads	O
Waste	O
the	O
device	O
’	O
s	O
battery	O
resources	O
Generate	O
increased	O
network	O
traffic	O
Gather	O
users	O
’	O
personal	O
information	O
Hide	O
their	O
presence	O
on	O
the	O
affected	O
device	O
to	O
achieve	O
persistence	O
Generate	O
revenue	O
for	O
their	O
operator	O
without	O
any	O
user	O
interaction	O
Conclusion	O
Based	O
solely	O
on	O
open	O
source	O
intelligence	O
,	O
we	O
were	O
able	O
to	O
trace	O
the	O
developer	O
of	O
the	O
Ashas	B-Malware
adware	O
and	O
establish	O
his	O
identity	O
and	O
discover	O
additional	O
related	O
adware-infected	O
apps	O
.	O

Seeing	O
that	O
the	O
developer	O
did	O
not	O
take	O
any	O
measures	O
to	O
protect	O
his	O
identity	O
,	O
it	O
seems	O
likely	O
that	O
his	O
intentions	O
weren	O
’	O
t	O
dishonest	O
at	O
first	O
–	O
and	O
this	O
is	O
also	O
supported	O
by	O
the	O
fact	O
that	O
not	O
all	O
his	O
published	O
apps	O
contained	O
unwanted	O
ads	O
.	O

At	O
some	O
point	O
in	O
his	O
Google	B-System
Play	I-System
“	O
career	O
”	O
,	O
he	O
apparently	O
decided	O
to	O
increase	O
his	O
ad	O
revenue	O
by	O
implementing	O
adware	O
functionality	O
in	O
his	O
apps	O
’	O
code	O
.	O

The	O
various	O
stealth	O
and	O
resilience	O
techniques	O
implemented	O
in	O
the	O
adware	O
show	O
us	O
that	O
the	O
culprit	O
was	O
aware	O
of	O
the	O
malicious	O
nature	O
of	O
the	O
added	O
functionality	O
and	O
attempted	O
to	O
keep	O
it	O
hidden	O
.	O

Sneaking	O
unwanted	O
or	O
harmful	O
functionality	O
into	O
popular	O
,	O
benign	O
apps	O
is	O
a	O
common	O
practice	O
among	O
“	O
bad	O
”	O
developers	O
,	O
and	O
we	O
are	O
committed	O
to	O
tracking	O
down	O
such	O
apps	O
.	O

We	O
report	O
them	O
to	O
Google	B-Organization
and	O
take	O
other	O
steps	O
to	O
disrupt	O
malicious	O
campaigns	O
we	O
discover	O
.	O

Last	O
but	O
not	O
least	O
,	O
we	O
publish	O
our	O
findings	O
to	O
help	O
Android	B-System
users	O
protect	O
themselves	O
.	O

MITRE	B-Organization
ATT	O
&	O
CK	O
techniques	O
Tactic	O
ID	O
Name	O
Description	O
Initial	O
Access	O
T1475	O
Deliver	O
Malicious	O
App	O
via	O
Authorized	O
App	O
Store	O
The	O
malware	O
impersonates	O
legitimate	O
services	O
on	O
Google	B-System
Play	I-System
Persistence	O
T1402	O
App	O
Auto-Start	O
at	O
Device	O
Boot	O
An	O
Android	O
application	O
can	O
listen	O
for	O
the	O
BOOT_COMPLETED	O
broadcast	O
,	O
ensuring	O
that	O
the	O
app	O
's	O
functionality	O
will	O
be	O
activated	O
every	O
time	O
the	O
device	O
starts	O
Impact	O
T1472	O
Generate	O
Fraudulent	O
Advertising	O
Revenue	O
Generates	O
revenue	O
by	O
automatically	O
displaying	O
ads	O
The	O
Rotexy	B-Malware
mobile	O
Trojan	O
–	O
banker	O
and	O
ransomware	O
22	O
NOV	O
2018	O
On	O

the	O
back	O
of	O
a	O
surge	O
in	O
Trojan	O
activity	O
,	O
we	O
decided	O
to	O
carry	O
out	O
an	O
in-depth	O
analysis	O
and	O
track	O
the	O
evolution	O
of	O
some	O
other	O
popular	O
malware	O
families	O
besides	O
Asacub	B-Malware
.	O

One	O
of	O
the	O
most	O
interesting	O
and	O
active	O
specimens	O
to	O
date	O
was	O
a	O
mobile	O
Trojan	O
from	O
the	O
Rotexy	B-Malware
family	O
.	O

In	O
a	O
three-month	O
period	O
from	O
August	O
to	O
October	O
2018	O
,	O
it	O
launched	O
over	O
70,000	O
attacks	O
against	O
users	O
located	O
primarily	O
in	O
Russia	O
.	O

An	O
interesting	O
feature	O
of	O
this	O
family	O
of	O
banking	O
Trojans	O
is	O
the	O
simultaneous	O
use	O
of	O
three	O
command	O
sources	O
:	O
Google	O
Cloud	O
Messaging	O
(	O
GCM	O
)	O
service	O
–	O
used	O
to	O
send	O
small	O
messages	O
in	O
JSON	O
format	O
to	O
a	O
mobile	O
device	O
via	O
Google	O
servers	O
;	O
malicious	O
C	O
&	O
C	O
server	O
;	O
incoming	O
SMS	O
messages	O
.	O

This	O
‘	O
versatility	O
’	O
was	O
present	O
in	O
the	O
first	O
version	O
of	O
Rotexy	B-Malware
and	O
has	O
been	O
a	O
feature	O
of	O
all	O
the	O
family	O
’	O
s	O
subsequent	O
representatives	O
.	O

During	O
our	O
research	O
we	O
also	O
arrived	O
at	O
the	O
conclusion	O
that	O
this	O
Trojan	O
evolved	O
from	O
an	O
SMS	O
spyware	O
Trojan	O
that	O
was	O
first	O
spotted	O
in	O
October	O
2014	O
.	O

Back	O
then	O
it	O
was	O
detected	O
as	O
Trojan-Spy.AndroidOS.SmsThief	B-Malware
,	O
but	O
later	O
versions	O
were	O
assigned	O
to	O
another	O
family	O
–	O
Trojan-Banker.AndroidOS.Rotexy	B-Malware
.	O

The	O
modern	O
version	O
of	O
Rotexy	B-Malware
combines	O
the	O
functions	O
of	O
a	O
banking	O
Trojan	O
and	O
ransomware	O
.	O

It	O
spreads	O
under	O
the	O
name	O
AvitoPay.apk	B-Indicator
(	O
or	O
similar	O
)	O
and	O
downloads	O
from	O
websites	O
with	O
names	O
like	O
youla9d6h.tk	B-Indicator
,	O
prodam8n9.tk	B-Indicator
,	O
prodamfkz.ml	B-Indicator
,	O
avitoe0ys.tk	B-Indicator
,	O
etc	O
.	O

These	O
website	O
names	O
are	O
generated	O
according	O
to	O
a	O
clear	O
algorithm	O
:	O
the	O
first	O
few	O
letters	O
are	O
suggestive	O
of	O
popular	O
classified	O
ad	O
services	O
,	O
followed	O
by	O
a	O
random	O
string	O
of	O
characters	O
,	O
followed	O
by	O
a	O
two-letter	O
top-level	O
domain	O
.	O

But	O
before	O
we	O
go	O
into	O
the	O
details	O
of	O
what	O
the	O
latest	O
version	O
of	O
Rotexy	B-Malware
can	O
do	O
and	O
why	O
it	O
’	O
s	O
distinctive	O
,	O
we	O
would	O
like	O
to	O
give	O
a	O
summary	O
of	O
the	O
path	O
the	O
Trojan	O
has	O
taken	O
since	O
2014	O
up	O
to	O
the	O
present	O
day	O
.	O

Evolution	O
of	O
Rotexy	B-Malware
2014–2015	O
Since	O
the	O
malicious	O
program	O
was	O
detected	O
in	O
2014	O
,	O
its	O
main	O
functions	O
and	O
propagation	O
method	O
have	O
not	O
changed	O
:	O
Rotexy	B-Malware
spreads	O
via	O
links	O
sent	O
in	O
phishing	O
SMSs	O
that	O
prompt	O
the	O
user	O
to	O
install	O
an	O
app	O
.	O

As	O
it	O
launches	O
,	O
it	O
requests	O
device	O
administrator	O
rights	O
,	O
and	O
then	O
starts	O
communicating	O
with	O
its	O
C	O
&	O
C	O
server	O
.	O

Until	O
mid-2015	O
,	O
Rotexy	B-Malware
used	O
a	O
plain-text	O
JSON	O
format	O
to	O
communicate	O
with	O
its	O
C	O
&	O
C	O
.	O

The	O
C	O
&	O
C	O
address	O
was	O
specified	O
in	O
the	O
code	O
and	O
was	O
also	O
unencrypted	O
:	O
In	O
some	O
versions	O
,	O
a	O
dynamically	O
generated	O
low-level	O
domain	O
was	O
used	O
as	O
an	O
address	O
:	O
In	O
its	O
first	O
communication	O
,	O
the	O
Trojan	O
sent	O
the	O
infected	O
device	O
’	O
s	O
IMEI	O
to	O
the	O
C	O
&	O
C	O
,	O
and	O
in	O
return	O
it	O
received	O
a	O
set	O
of	O
rules	O
for	O
processing	O
incoming	O
SMSs	O
(	O
phone	O
numbers	O
,	O
keywords	O
and	O
regular	O
expressions	O
)	O
–	O
these	O
applied	O
mainly	O
to	O
messages	O
from	O
banks	O
,	O
payment	O
systems	O
and	O
mobile	O
network	O
operators	O
.	O

For	O
instance	O
,	O
the	O
Trojan	O
could	O
automatically	O
reply	O
to	O
an	O
SMS	O
and	O
immediately	O
delete	O
it	O
.	O

Rotexy	B-Malware
then	O
sent	O
information	O
about	O
the	O
smartphone	O
to	O
the	O
C	O
&	O
C	O
,	O
including	O
the	O
phone	O
model	O
,	O
number	O
,	O
name	O
of	O
the	O
mobile	O
network	O
operator	O
,	O
versions	O
of	O
the	O
operating	O
system	O
and	O
IMEI	O
.	O

With	O
each	O
subsequent	O
request	O
,	O
a	O
new	O
subdomain	O
was	O
generated	O
.	O

The	O
algorithm	O
for	O
generating	O
the	O
lowest-level	O
domain	O
name	O
was	O
hardwired	O
in	O
the	O
Trojan	O
’	O
s	O
code	O
.	O

The	O
Trojan	O
also	O
registered	O
in	O
Google	B-System
Cloud	I-System
Messaging	I-System
(	I-System
GCM	I-System
)	I-System
,	O
meaning	O
it	O
could	O
then	O
receive	O
commands	O
via	O
that	O
service	O
.	O

The	O
Trojan	O
’	O
s	O
list	O
of	O
possible	O
commands	O
has	O
remained	O
practically	O
unchanged	O
throughout	O
its	O
life	O
,	O
and	O
will	O
be	O
described	O
below	O
in	O
detail	O
.	O

The	O
Trojan	O
’	O
s	O
assets	O
folder	O
contained	O
the	O
file	O
data.db	B-Indicator
with	O
a	O
list	O
of	O
possible	O
values	O
for	O
the	O
User-Agent	O
field	O
for	O
the	O
PAGE	O
command	O
(	O
which	O
downloads	O
the	O
specified	O
webpage	O
)	O
.	O

If	O
the	O
value	O
of	O
this	O
field	O
failed	O
to	O
arrive	O
from	O
the	O
C	O
&	O
C	O
,	O
it	O
was	O
selected	O
from	O
the	O
file	O
data.db	B-Indicator
using	O
a	O
pseudo-random	O
algorithm	O
.	O

2015–2016	O
Starting	O
from	O
mid-2015	O
,	O
the	O
Trojan	O
began	O
using	O
the	O
AES	O
algorithm	O
to	O
encrypt	O
data	O
communicated	O
between	O
the	O
infected	O
device	O
and	O
the	O
C	O
&	O
C	O
:	O
Also	O
starting	O
with	O
the	O
same	O
version	O
,	O
data	O
is	O
sent	O
in	O
a	O
POST	O
request	O
to	O
the	O
relative	O
address	O
with	O
the	O
format	O
“	O
/	O
[	O
number	O
]	O
”	O
(	O
a	O
pseudo-randomly	O
generated	O
number	O
in	O
the	O
range	O
0–9999	O
)	O
.	O

In	O
some	O
samples	O
,	O
starting	O
from	O
January	O
2016	O
,	O
an	O
algorithm	O
has	O
been	O
implemented	O
for	O
unpacking	O
the	O
encrypted	O
executable	O
DEX	O
file	O
from	O
the	O
assets	O
folder	O
.	O

In	O
this	O
version	O
of	O
Rotexy	B-Malware
,	O
dynamic	O
generation	O
of	O
lowest-level	O
domains	O
was	O
not	O
used	O
.	O

2016	O
From	O
mid-2016	O
on	O
,	O
the	O
cybercriminals	O
returned	O
to	O
dynamic	O
generation	O
of	O
lowest-level	O
domains	O
.	O

No	O
other	O
significant	O
changes	O
were	O
observed	O
in	O
the	O
Trojan	O
’	O
s	O
network	O
behavior	O
.	O

In	O
late	O
2016	O
,	O
versions	O
of	O
the	O
Trojan	O
emerged	O
that	O
contained	O
the	O
card.html	B-Indicator
phishing	O
page	O
in	O
the	O
assets/www	B-Indicator
folder	O
.	O

The	O
page	O
was	O
designed	O
to	O
steal	O
users	O
’	O
bank	O
card	O
details	O
:	O
2017–2018	O
From	O
early	O
2017	O
,	O
the	O
HTML	O
phishing	O
pages	O
bank.html	B-Indicator
,	O
update.html	B-Indicator
and	O
extortionist.html	B-Indicator
started	O
appearing	O
in	O
the	O
assets	O
folder	O
.	O

Also	O
,	O
in	O
some	O
versions	O
of	O
the	O
Trojan	O
the	O
file	O
names	O
were	O
random	O
strings	O
of	O
characters	O
.	O

In	O
2018	O
,	O
versions	O
of	O
Rotexy	B-Malware
emerged	O
that	O
contacted	O
the	O
C	O
&	O
C	O
using	O
its	O
IP	O
address	O
.	O

‘	O
One-time	O
’	O
domains	O
also	O
appeared	O
with	O
names	O
made	O
up	O
of	O
random	O
strings	O
of	O
characters	O
and	O
numbers	O
,	O
combined	O
with	O
the	O
top-level	O
domains	O
.cf	O
,	O
.ga	O
,	O
.gq	O
,	O
.ml	O
,	O
or	O
.tk	O
.	O

At	O
this	O
time	O
,	O
the	O
Trojan	O
also	O
began	O
actively	O
using	O
different	O
methods	O
of	O
obfuscation	O
.	O

For	O
example	O
,	O
the	O
DEX	O
file	O
is	O
packed	O
with	O
garbage	O
strings	O
and/or	O
operations	O
,	O
and	O
contains	O
a	O
key	O
to	O
decipher	O
the	O
main	O
executable	O
file	O
from	O
the	O
APK	O
.	O

Latest	O
version	O
(	O
2018	O
)	O
Let	O
’	O
s	O
now	O
return	O
to	O
the	O
present	O
day	O
and	O
a	O
detailed	O
description	O
of	O
the	O
functionality	O
of	O
a	O
current	O
representative	O
of	O
the	O
Rotexy	B-Malware
family	O
(	O
SHA256	O
:	O
ba4beb97f5d4ba33162f769f43ec8e7d1ae501acdade792a4a577cd6449e1a84	B-Indicator
)	O
.	O

Application	O
launch	O
When	O
launching	O
for	O
the	O
first	O
time	O
,	O
the	O
Trojan	O
checks	O
if	O
it	O
is	O
being	O
launched	O
in	O
an	O
emulation	O
environment	O
,	O
and	O
in	O
which	O
country	O
it	O
is	O
being	O
launched	O
.	O

If	O
the	O
device	O
is	O
located	O
outside	O
Russia	O
or	O
is	O
an	O
emulator	O
,	O
the	O
application	O
displays	O
a	O
stub	O
page	O
:	O
In	O
this	O
case	O
,	O
the	O
Trojan	O
’	O
s	O
logs	O
contain	O
records	O
in	O
Russian	O
with	O
grammatical	O
errors	O
and	O
spelling	O
mistakes	O
:	O
If	O
the	O
check	O
is	O
successful	O
,	O
Rotexy	B-Malware
registers	O
with	O
GCM	B-System
and	O
launches	O
SuperService	O
which	O
tracks	O
if	O
the	O
Trojan	O
has	O
device	O
administrator	O
privileges	O
.	O

SuperService	O
also	O
tracks	O
its	O
own	O
status	O
and	O
relaunches	O
if	O
stopped	O
.	O

It	O
performs	O
a	O
privilege	O
check	O
once	O
every	O
second	O
;	O
if	O
unavailable	O
,	O
the	O
Trojan	O
starts	O
requesting	O
them	O
from	O
the	O
user	O
in	O
an	O
infinite	O
loop	O
:	O
If	O
the	O
user	O
agrees	O
and	O
gives	O
the	O
application	O
the	O
requested	O
privileges	O
,	O
another	O
stub	O
page	O
is	O
displayed	O
,	O
and	O
the	O
app	O
hides	O
its	O
icon	O
:	O
If	O
the	O
Trojan	O
detects	O
an	O
attempt	O
to	O
revoke	O
its	O
administrator	O
privileges	O
,	O
it	O
starts	O
periodically	O
switching	O
off	O
the	O
phone	O
screen	O
,	O
trying	O
to	O
stop	O
the	O
user	O
actions	O
.	O

If	O
the	O
privileges	O
are	O
revoked	O
successfully	O
,	O
the	O
Trojan	O
relaunches	O
the	O
cycle	O
of	O
requesting	O
administrator	O
privileges	O
.	O

If	O
,	O
for	O
some	O
reason	O
,	O
SuperService	O
does	O
not	O
switch	O
off	O
the	O
screen	O
when	O
there	O
is	O
an	O
attempt	O
to	O
revoke	O
the	O
device	O
administrator	O
privileges	O
,	O
the	O
Trojan	O
tries	O
to	O
intimidate	O
the	O
user	O
:	O
While	O
running	O
,	O
Rotexy	B-Malware
tracks	O
the	O
following	O
:	O
switching	O
on	O
and	O
rebooting	O
of	O
the	O
phone	O
;	O
termination	O
of	O
its	O
operation	O
–	O
in	O
this	O
case	O
,	O
it	O
relaunches	O
;	O
sending	O
of	O
an	O
SMS	O
by	O
the	O
app	O
–	O
in	O
this	O
case	O
,	O
the	O
phone	O
is	O
switched	O
to	O
silent	O
mode	O
.	O

C	O
&	O
C	O
communications	O
The	O
default	O
C	O
&	O
C	O
address	O
is	O
hardwired	O
in	O
the	O
Rotexy	B-Malware
code	O
:	O
The	O
relative	O
address	O
to	O
which	O
the	O
Trojan	O
will	O
send	O
information	O
from	O
the	O
device	O
is	O
generated	O
in	O
a	O
pseudo-random	O
manner	O
.	O

Depending	O
on	O
the	O
Trojan	O
version	O
,	O
dynamically	O
generated	O
subdomains	O
can	O
also	O
be	O
used	O
.	O

The	O
Trojan	O
stores	O
information	O
about	O
C	O
&	O
C	O
servers	O
and	O
the	O
data	O
harvested	O
from	O
the	O
infected	O
device	O
in	O
a	O
local	O
SQLite	O
database	O
.	O

First	O
off	O
,	O
the	O
Trojan	O
registers	O
in	O
the	O
administration	O
panel	O
and	O
receives	O
the	O
information	O
it	O
needs	O
to	O
operate	O
from	O
the	O
C	O
&	O
C	O
(	O
the	O
SMS	O
interception	O
templates	O
and	O
the	O
text	O
that	O
will	O
be	O
displayed	O
on	O
HTML	O
pages	O
)	O
:	O
Rotexy	B-Malware
intercepts	O
all	O
incoming	O
SMSs	O
and	O
processes	O
them	O
according	O
to	O
the	O
templates	O
it	O
received	O
from	O
the	O
C	O
&	O
C	O
.	O

Also	O
,	O
when	O
an	O
SMS	O
arrives	O
,	O
the	O
Trojan	O
puts	O
the	O
phone	O
into	O
silent	O
mode	O
and	O
switches	O
off	O
the	O
screen	O
so	O
the	O
user	O
doesn	O
’	O
t	O
notice	O
that	O
a	O
new	O
SMS	O
has	O
arrived	O
.	O

When	O
required	O
,	O
the	O
Trojan	O
sends	O
an	O
SMS	O
to	O
the	O
specified	O
phone	O
number	O
with	O
the	O
information	O
it	O
has	O
received	O
from	O
the	O
intercepted	O
message	O
.	O

(	O
It	O
is	O
specified	O
in	O
the	O
interception	O
template	O
whether	O
a	O
reply	O
must	O
be	O
sent	O
,	O
and	O
which	O
text	O
should	O
be	O
sent	O
to	O
which	O
address	O
.	O

)	O
If	O
the	O
application	O
hasn	O
’	O
t	O
received	O
instructions	O
about	O
the	O
rules	O
for	O
processing	O
incoming	O
SMSs	O
,	O
it	O
simply	O
saves	O
all	O
SMSs	O
to	O
a	O
local	O
database	O
and	O
uploads	O
them	O
to	O
the	O
C	O
&	O
C	O
.	O

Apart	O
from	O
general	O
information	O
about	O
the	O
device	O
,	O
the	O
Trojan	O
sends	O
a	O
list	O
of	O
all	O
the	O
running	O
processes	O
and	O
installed	O
applications	O
to	O
the	O
C	O
&	O
C	O
.	O

It	O
’	O
s	O
possible	O
the	O
threat	O
actors	O
use	O
this	O
list	O
to	O
find	O
running	O
antivirus	O
or	O
banking	O
applications	O
.	O

Rotexy	B-Malware
will	O
perform	O
further	O
actions	O
after	O
it	O
receives	O
the	O
corresponding	O
commands	O
:	O
START	O
,	O
STOP	O
,	O
RESTART	O
—	O
start	O
,	O
stop	O
,	O
restart	O
SuperService	O
.	O

URL	O
—	O
update	O
C	O
&	O
C	O
address	O
.	O

MESSAGE	O
–	O
send	O
SMS	O
containing	O
specified	O
text	O
to	O
a	O
specified	O
number	O
.	O

UPDATE_PATTERNS	O
–	O
reregister	O
in	O
the	O
administration	O
panel	O
.	O

UNBLOCK	O
–	O
unblock	O
the	O
telephone	O
(	O
revoke	O
device	O
administrator	O
privileges	O
from	O
the	O
app	O
)	O
.	O

UPDATE	O
–	O
download	O
APK	O
file	O
from	O
C	O
&	O
C	O
and	O
install	O
it	O
.	O

This	O
command	O
can	O
be	O
used	O
not	O
just	O
to	O
update	O
the	O
app	O
but	O
to	O
install	O
any	O
other	O
software	O
on	O
the	O
infected	O
device	O
.	O

CONTACTS	O
–	O
send	O
text	O
received	O
from	O
C	O
&	O
C	O
to	O
all	O
user	O
contacts	O
.	O

This	O
is	O
most	O
probably	O
how	O
the	O
application	O
spreads	O
.	O

CONTACTS_PRO	O
–	O
request	O
unique	O
message	O
text	O
for	O
contacts	O
from	O
the	O
address	O
book	O
.	O

PAGE	O
–	O
contact	O
URL	O
received	O
from	O
C	O
&	O
C	O
using	O
User-Agent	O
value	O
that	O
was	O
also	O
received	O
from	O
C	O
&	O
C	O
or	O
local	O
database	O
.	O

ALLMSG	O
–	O
send	O
C	O
&	O
C	O
all	O
SMSs	O
received	O
and	O
sent	O
by	O
user	O
,	O
as	O
stored	O
in	O
phone	O
memory	O
.	O

ALLCONTACTS	O
–	O
send	O
all	O
contacts	O
from	O
phone	O
memory	O
to	O
C	O
&	O
C	O
.	O

ONLINE	O
–	O
send	O
information	O
about	O
Trojan	O
’	O
s	O
current	O
status	O
to	O
C	O
&	O
C	O
:	O
whether	O
it	O
has	O
device	O
administrator	O
privileges	O
,	O
which	O
HTML	O
page	O
is	O
currently	O
displayed	O
,	O
whether	O
screen	O
is	O
on	O
or	O
off	O
,	O
etc	O
.	O

NEWMSG	O
–	O
write	O
an	O
SMS	O
to	O
the	O
device	O
memory	O
containing	O
the	O
text	O
and	O
sender	O
number	O
sent	O
from	O
C	O
&	O
C	O
.	O

CHANGE_GCM_ID	O
–	O
change	O
GCM	O
ID	O
.	O

BLOCKER_BANKING_START	O
–	O
display	O
phishing	O
HTML	O
page	O
for	O
entry	O
of	O
bank	O
card	O
details	O
.	O

BLOCKER_EXTORTIONIST_START	O
–	O
display	O
HTML	O
page	O
of	O
the	O
ransomware	O
.	O

BLOCKER_UPDATE_START	O
–	O
display	O
fake	O
HTML	O
page	O
for	O
update	O
.	O

BLOCKER_STOP	O
–	O
block	O
display	O
of	O
all	O
HTML	O
pages	O
.	O

The	O
C	O
&	O
C	O
role	O
for	O
Rotexy	B-Malware
can	O
be	O
filled	O
not	O
only	O
by	O
a	O
web	O
server	O
but	O
also	O
by	O
any	O
device	O
that	O
can	O
send	O
SMSs	O
.	O

The	O
Trojan	O
intercepts	O
incoming	O
SMSs	O
and	O
can	O
receive	O
the	O
following	O
commands	O
from	O
them	O
:	O
“	O
3458	O
”	O
—	O
revoke	O
device	O
administrator	O
privileges	O
from	O
the	O
app	O
;	O
“	O
hi	O
”	O
,	O
“	O
ask	O
”	O
—	O
enable	O
and	O
disable	O
mobile	O
internet	O
;	O
“	O
privet	O
”	O
,	O
“	O
ru	O
”	O
—	O
enable	O
and	O
disable	O
Wi-Fi	O
;	O
“	O
check	O
”	O
—	O
send	O
text	O
“	O
install	O
:	O
[	O
device	O
IMEI	O
]	O
”	O
to	O
phone	O
number	O
from	O
which	O
SMS	O
was	O
sent	O
;	O
“	O
stop_blocker	O
”	O
—	O
stop	O
displaying	O
all	O
blocking	O
HTML	O
pages	O
;	O
“	O
393838	O
”	O
—	O
change	O
C	O
&	O
C	O
address	O
to	O
that	O
specified	O
in	O
the	O

SMS	O
.	O

Information	O
about	O
all	O
actions	O
performed	O
by	O
Rotexy	B-Malware
is	O
logged	O
in	O
the	O
local	O
database	O
and	O
sent	O
to	O
the	O
C	O
&	O
C	O
.	O

The	O
server	O
then	O
sends	O
a	O
reply	O
that	O
contains	O
instructions	O
on	O
further	O
actions	O
to	O
be	O
taken	O
.	O

Displaying	O
HTML	O
pages	O
We	O
’	O
ll	O
now	O
look	O
at	O
the	O
HTML	O
pages	O
that	O
Rotexy	B-Malware
displays	O
and	O
the	O
actions	O
performed	O
with	O
them	O
.	O

The	O
Trojan	O
displays	O
a	O
fake	O
HTML	O
update	O
page	O
(	O
update.html	B-Indicator
)	O
that	O
blocks	O
the	O
device	O
’	O
s	O
screen	O
for	O
a	O
long	O
period	O
of	O
time	O
.	O

The	O
Trojan	O
displays	O
the	O
extortion	O
page	O
(	O
extortionist.html	B-Indicator
)	O
that	O
blocks	O
the	O
device	O
and	O
demands	O
a	O
ransom	O
for	O
unblocking	O
it	O
.	O

The	O
sexually	O
explicit	O
images	O
in	O
this	O
screenshot	O
have	O
been	O
covered	O
with	O
a	O
black	O
box	O
.	O

The	O
Trojan	O
displays	O
a	O
phishing	O
page	O
(	O
bank.html	B-Indicator
)	O
prompting	O
the	O
user	O
to	O
enter	O
their	O
bank	O
card	O
details	O
.	O

This	O
page	O
mimics	O
a	O
legitimate	O
bank	O
form	O
and	O
blocks	O
the	O
device	O
screen	O
until	O
the	O
user	O
enters	O
all	O
the	O
information	O
.	O

It	O
even	O
has	O
its	O
own	O
virtual	O
keyboard	O
that	O
supposedly	O
protects	O
the	O
victim	O
from	O
keyloggers	O
.	O

In	O
the	O
areas	O
marked	O
‘	O
{	O
text	O
}	O
’	O
Rotexy	B-Malware
displays	O
the	O
text	O
it	O
receives	O
from	O
the	O
C	O
&	O
C	O
.	O

Typically	O
,	O
it	O
is	O
a	O
message	O
saying	O
that	O
the	O
user	O
has	O
received	O
a	O
money	O
transfer	O
,	O
and	O
that	O
they	O
must	O
enter	O
their	O
bank	O
card	O
details	O
so	O
the	O
money	O
can	O
be	O
transferred	O
to	O
their	O
account	O
.	O

The	O
entered	O
data	O
is	O
then	O
checked	O
and	O
the	O
last	O
four	O
digits	O
of	O
the	O
bank	O
card	O
number	O
are	O
also	O
checked	O
against	O
the	O
data	O
sent	O
in	O
the	O
C	O
&	O
C	O
command	O
.	O

The	O
following	O
scenario	O
may	O
play	O
out	O
:	O
according	O
to	O
the	O
templates	O
for	O
processing	O
incoming	O
SMSs	O
,	O
Rotexy	B-Malware
intercepts	O
a	O
message	O
from	O
the	O
bank	O
that	O
contains	O
the	O
last	O
four	O
digits	O
of	O
the	O
bank	O
card	O
connected	O
to	O
the	O
phone	O
number	O
.	O

The	O
Trojan	O
sends	O
these	O
digits	O
to	O
the	O
C	O
&	O
C	O
,	O
which	O
in	O
turn	O
sends	O
a	O
command	O
to	O
display	O
a	O
fake	O
data	O
entry	O
window	O
to	O
check	O
the	O
four	O
digits	O
.	O

If	O
the	O
user	O
has	O
provided	O
the	O
details	O
of	O
another	O
card	O
,	O
then	O
the	O
following	O
window	O
is	O
displayed	O
:	O
The	O
application	O
leaves	O
the	O
user	O
with	O
almost	O
no	O
option	O
but	O
to	O
enter	O
the	O
correct	O
card	O
number	O
,	O
as	O
it	O
checks	O
the	O
entered	O
number	O
against	O
the	O
bank	O
card	O
details	O
the	O
cybercriminals	O
received	O
earlier	O
.	O

When	O
all	O
the	O
necessary	O
card	O
details	O
are	O
entered	O
and	O
have	O
been	O
checked	O
,	O
all	O
the	O
information	O
is	O
uploaded	O
to	O
the	O
C	O
&	O
C	O
.	O

How	O
to	O
unblock	O
the	O
phone	O
Now	O
for	O
some	O
good	O
news	O
:	O
Rotexy	B-Malware
doesn	O
’	O
t	O
have	O
a	O
very	O
well-designed	O
module	O
for	O
processing	O
commands	O
that	O
arrive	O
in	O
SMSs	O
.	O

It	O
means	O
the	O
phone	O
can	O
be	O
unblocked	O
in	O
some	O
cases	O
when	O
it	O
has	O
been	O
blocked	O
by	O
one	O
of	O
the	O
above	O
HTML	O
pages	O
.	O

This	O
is	O
done	O
by	O
sending	O
“	O
3458	O
”	O
in	O
an	O
SMS	O
to	O
the	O
blocked	O
device	O
–	O
this	O
will	O
revoke	O
the	O
administrator	O
privileges	O
from	O
the	O
Trojan	O
.	O

After	O
that	O
it	O
’	O
s	O
necessary	O
to	O
send	O
“	O
stop_blocker	O
”	O
to	O
the	O
same	O
number	O
–	O
this	O
will	O
disable	O
the	O
display	O
of	O
HTML	O
pages	O
that	O
extort	O
money	O
and	O
block	O
the	O
screen	O
.	O

Rotexy	B-Malware
may	O
start	O
requesting	O
device	O
administrator	O
privileges	O
again	O
in	O
an	O
infinite	O
loop	O
;	O
in	O
that	O
case	O
,	O
restart	O
the	O
device	O
in	O
safe	O
mode	O
and	O
remove	O
the	O
malicious	O
program	O
.	O

However	O
,	O
this	O
method	O
may	O
not	O
work	O
if	O
the	O
threat	O
actors	O
react	O
quickly	O
to	O
an	O
attempt	O
to	O
remove	O
the	O
Trojan	O
.	O

In	O
that	O
case	O
,	O
you	O
first	O
need	O
to	O
send	O
the	O
text	O
“	O
393838	O
”	O
in	O
an	O
SMS	O
to	O
the	O
infected	O
device	O
and	O
then	O
repeat	O
all	O
the	O
actions	O
described	O
above	O
;	O
that	O
text	O
message	O
will	O
change	O
the	O
C	O
&	O
C	O
address	O
to	O
“	O
:	O
//	O
”	O
,	O
so	O
the	O
phone	O
will	O
no	O
longer	O
receive	O
commands	O
from	O
the	O
real	O
C	O
&	O
C	O
.	O

Please	O
note	O
that	O
these	O
unblocking	O
instructions	O
are	O
based	O
on	O
an	O
analysis	O
of	O
the	O
current	O
version	O
of	O
Rotexy	B-Malware
and	O
have	O
been	O
tested	O
on	O
it	O
.	O

However	O
,	O
it	O
’	O
s	O
possible	O
the	O
set	O
of	O
commands	O
may	O
change	O
in	O
future	O
versions	O
of	O
the	O
Trojan	O
.	O

Geography	O
of	O
Rotexy	B-Malware
attacks	O
According	O
to	O
our	O
data	O
,	O
98	O
%	O
of	O
all	O
Rotexy	B-Malware
attacks	O
target	O
users	O
in	O
Russia	O
.	O

Indeed	O
,	O
the	O
Trojan	O
explicitly	O
targets	O
Russian-speaking	O
users	O
.	O

There	O
have	O
also	O
been	O
cases	O
of	O
users	O
in	O
Ukraine	O
,	O
Germany	O
,	O
Turkey	O
and	O
several	O
other	O
countries	O
being	O
affected	O
.	O

Kaspersky	B-System
Internet	I-System
Security	I-System
for	O
Android	B-System
and	O
the	O
Sberbank	B-System
Online	I-System
app	I-System
securely	O
protect	O
users	O
against	O
attacks	O
by	O
this	O
Trojan	O
.	O

IOCs	O
SHA256	O
0ca09d4fde9e00c0987de44ae2ad51a01b3c4c2c11606fe8308a083805760ee7	B-Indicator
4378f3680ff070a1316663880f47eba54510beaeb2d897e7bbb8d6b45de63f96	B-Indicator
76c9d8226ce558c87c81236a9b95112b83c7b546863e29b88fec4dba5c720c0b	B-Indicator
7cc2d8d43093c3767c7c73dc2b4daeb96f70a7c455299e0c7824b4210edd6386	B-Indicator

9b2fd7189395b2f34781b499f5cae10ec86aa7ab373fbdc2a14ec4597d4799ba	B-Indicator
ac216d502233ca0fe51ac2bb64cfaf553d906dc19b7da4c023fec39b000bc0d7	B-Indicator
b1ccb5618925c8f0dda8d13efe4a1e1a93d1ceed9e26ec4a388229a28d1f8d5b	B-Indicator
ba4beb97f5d4ba33162f769f43ec8e7d1ae501acdade792a4a577cd6449e1a84	B-Indicator

ba9f4d3f4eba3fa7dce726150fe402e37359a7f36c07f3932a92bd711436f88c	B-Indicator
e194268bf682d81fc7dc1e437c53c952ffae55a9d15a1fc020f0219527b7c2ec	B-Indicator
С	O
&	O
C	O
2014–2015	O
:	O
secondby.ru	B-Indicator
darkclub.net	B-Indicator
holerole.org	B-Indicator
googleapis.link	B-Indicator
2015–2016	O
:	O
test2016.ru	B-Indicator
blackstar.pro	B-Indicator
synchronize.pw	B-Indicator
lineout.pw	B-Indicator
sync-weather.pw	B-Indicator

2016	O
freedns.website	O
streamout.space	B-Indicator
2017–2018	O
:	O
streamout.space	B-Indicator
sky-sync.pw	B-Indicator
gms-service.info	B-Indicator
EventBot	B-Malware
:	O
A	O
New	O
Mobile	O
Banking	O
Trojan	O
is	O
Born	O
April	O
30	O
,	O
2020	O
KEY	O
FINDINGS	O
The	O
Cybereason	B-Organization
Nocturnus	I-Organization
team	O
is	O
investigating	O
EventBot	B-Malware
,	O
a	O
new	O
type	O
of	O
Android	B-System
mobile	O
malware	O
that	O
emerged	O
around	O
March	O
2020	O
.	O

EventBot	B-Malware
is	O
a	O
mobile	O
banking	O
trojan	O
and	O
infostealer	O
that	O
abuses	O
Android	B-System
’	O
s	O
accessibility	O
features	O
to	O
steal	O
user	O
data	O
from	O
financial	O
applications	O
,	O
read	O
user	O
SMS	O
messages	O
,	O
and	O
steal	O
SMS	O
messages	O
to	O
allow	O
the	O
malware	O
to	O
bypass	O
two-factor	O
authentication	O
.	O

EventBot	B-Malware
targets	O
users	O
of	O
over	O
200	O
different	O
financial	O
applications	O
,	O
including	O
banking	O
,	O
money	O
transfer	O
services	O
,	O
and	O
crypto-currency	O
wallets	O
.	O

Those	O
targeted	O
include	O
applications	O
like	O
Paypal	B-System
Business	I-System
,	O
Revolut	B-System
,	O
Barclays	B-System
,	O
UniCredit	B-System
,	O
CapitalOne	B-System
UK	I-System
,	O
HSBC	B-System
UK	I-System
,	O
Santander	B-System
UK	I-System
,	O
TransferWise	B-System
,	O
Coinbase	B-System
,	O
paysafecard	B-System
,	O
and	O
many	O
more	O
.	O

It	O
specifically	O
targets	O
financial	O
banking	O
applications	O
across	O
the	O
United	O
States	O
and	O
Europe	O
,	O
including	O
Italy	O
,	O
the	O
UK	O
,	O
Spain	O
,	O
Switzerland	O
,	O
France	O
,	O
and	O
Germany	O
.	O

The	O
full	O
list	O
of	O
banking	O
applications	O
targeted	O
is	O
included	O
in	O
the	O
appendix	O
.	O

EventBot	B-Organization
is	O
particularly	O
interesting	O
because	O
it	O
is	O
in	O
such	O
early	O
stages	O
.	O

This	O
brand	O
new	O
malware	O
has	O
real	O
potential	O
to	O
become	O
the	O
next	O
big	O
mobile	O
malware	O
,	O
as	O
it	O
is	O
under	O
constant	O
iterative	O
improvements	O
,	O
abuses	O
a	O
critical	O
operating	O
system	O
feature	O
,	O
and	O
targets	O
financial	O
applications	O
.	O

This	O
research	O
gives	O
a	O
rare	O
look	O
into	O
the	O
process	O
improvements	O
malware	O
authors	O
make	O
when	O
optimizing	O
before	O
launch	O
.	O

By	O
going	O
on	O
the	O
offensive	O
and	O
hunting	O
the	O
attackers	O
,	O
our	O
team	O
was	O
able	O
to	O
unearth	O
the	O
early	O
stages	O
of	O
what	O
may	O
be	O
a	O
very	O
dangerous	O
mobile	O
malware	O
.	O

TABLE	O
OF	O
CONTENTS	O
Security	O
Recommendations	O
Introduction	O
Threat	O
Analysis	O
Common	O
Features	O
Unique	O
Features	O
by	O
Version	O
Malware	O
Under	O
Active	O
Development	O
Suspected	O
Detection	O
Tests	O
by	O
the	O
Threat	O
Actor	O
EventBot	B-Malware
Infrastructure	O
Cybereason	O
Mobile	O
Conclusion	O
Indicators	O
of	O
Compromise	O
MITRE	B-Organization
ATT	O
&	O
CK	O
for	O
Mobile	O
Breakdown	O
SECURITY	O
RECOMMENDATIONS	O
Keep	O
your	O
mobile	O
device	O
up-to-date	O
with	O
the	O
latest	O
software	O
updates	O
from	O
legitimate	O
sources	O
.	O

Keep	O
Google	B-System
Play	I-System
Protect	I-System
on	O
.	O

Do	O
not	O
download	O
mobile	O
apps	O
from	O
unofficial	O
or	O
unauthorized	O
sources	O
.	O

Most	O
legitimate	O
Android	B-System
apps	O
are	O
available	O
on	O
the	O
Google	B-System
Play	I-System
Store	I-System
.	O

Always	O
apply	O
critical	O
thinking	O
and	O
consider	O
whether	O
you	O
should	O
give	O
a	O
certain	O
app	O
the	O
permissions	O
it	O
requests	O
.	O

When	O
in	O
doubt	O
,	O
check	O
the	O
APK	O
signature	O
and	O
hash	O
in	O
sources	O
like	O
VirusTotal	B-Organization
before	O
installing	O
it	O
on	O
your	O
device	O
.	O

Use	O
mobile	O
threat	O
detection	O
solutions	O
for	O
enhanced	O
security	O
.	O

INTRODUCTION	O
For	O
the	O
past	O
few	O
weeks	O
,	O
the	O
Cybereason	B-Organization
Nocturnus	I-Organization
team	O
has	O
been	O
investigating	O
a	O
new	O
type	O
of	O
Android	B-System
malware	O
dubbed	O
EventBot	B-Malware
,	O
which	O
was	O
first	O
identified	O
in	O
March	O
2020	O
.	O

This	O
malware	O
appears	O
to	O
be	O
newly	O
developed	O
with	O
code	O
that	O
differs	O
significantly	O
from	O
previously	O
known	O
Android	B-System
malware	O
.	O

EventBot	B-Malware
is	O
under	O
active	O
development	O
and	O
is	O
evolving	O
rapidly	O
;	O
new	O
versions	O
are	O
released	O
every	O
few	O
days	O
with	O
improvements	O
and	O
new	O
capabilities	O
.	O

EventBot	B-Malware
abuses	O
Android	B-System
’	O
s	O
accessibility	O
feature	O
to	O
access	O
valuable	O
user	O
information	O
,	O
system	O
information	O
,	O
and	O
data	O
stored	O
in	O
other	O
applications	O
.	O

In	O
particular	O
,	O
EventBot	B-Malware
can	O
intercept	O
SMS	O
messages	O
and	O
bypass	O
two-factor	O
authentication	O
mechanisms	O
.	O

The	O
Cybereason	B-Organization
Nocturnus	I-Organization
team	O
has	O
concluded	O
that	O
EventBot	B-Malware
is	O
designed	O
to	O
target	O
over	O
200	O
different	O
banking	O
and	O
finance	O
applications	O
,	O
the	O
majority	O
of	O
which	O
are	O
European	O
bank	O
and	O
crypto-currency	O
exchange	O
applications	O
.	O

By	O
accessing	O
and	O
stealing	O
this	O
data	O
,	O
Eventbot	B-Malware
has	O
the	O
potential	O
to	O
access	O
key	O
business	O
data	O
,	O
including	O
financial	O
data	O
.	O

60	O
%	O
of	O
devices	O
containing	O
or	O
accessing	O
enterprise	O
data	O
are	O
mobile	O
,	O
and	O
mobile	O
devices	O
tend	O
to	O
include	O
a	O
significant	O
amount	O
of	O
personal	O
and	O
business	O
data	O
,	O
assuming	O
the	O
organization	O
has	O
a	O
bring-your-own-device	O
policy	O
in	O
place	O
.	O

Mobile	O
malware	O
is	O
a	O
significant	O
risk	O
for	O
organizations	O
and	O
consumers	O
alike	O
,	O
and	O
must	O
be	O
considered	O
when	O
protecting	O
personal	O
and	O
business	O
data	O
.	O

EventBot	B-Malware
mobile	O
banking	O
applications	O
targetedApplications	O
targeted	O
by	O
EventBot	B-Malware
.	O

Cybereason	B-Organization
Mobile	I-Organization
Detecting	O
EventBotCybereason	O
Mobile	O
detecting	O
EventBot	B-Malware
.	O

THREAT	O
ANALYSIS	O
Initial	O
Access	O
Though	O
EventBot	B-Malware
is	O
not	O
currently	O
on	O
the	O
Google	B-System
Play	I-System
Store	O
,	O
we	O
were	O
able	O
to	O
find	O
several	O
icons	O
EventBot	B-Malware
is	O
using	O
to	O
masquerade	O
as	O
a	O
legitimate	O
application	O
.	O

We	O
believe	O
that	O
,	O
when	O
it	O
is	O
officially	O
released	O
,	O
it	O
will	O
most	O
likely	O
be	O
uploaded	O
to	O
rogue	O
APK	O
stores	O
and	O
other	O
shady	O
websites	O
,	O
while	O
masquerading	O
as	O
real	O
applications	O
.	O

Icons	O
used	O
for	O
EventBot	B-Malware
masqueraded	O
as	O
legitimate	O
with	O
these	O
icons.application	O
.	O

Malware	O
Capabilities	O
The	O
Cybereason	B-Organization
Nocturnus	I-Organization
team	O
has	O
been	O
following	O
EventBot	B-Malware
since	O
the	O
beginning	O
of	O
March	O
2020	O
.	O

The	O
team	O
has	O
encountered	O
different	O
versions	O
of	O
the	O
malware	O
over	O
time	O
as	O
it	O
has	O
rapidly	O
evolved	O
.	O

At	O
the	O
time	O
of	O
writing	O
this	O
research	O
,	O
four	O
versions	O
of	O
the	O
EventBot	B-Malware
malware	O
were	O
observed	O
:	O
Version	O
0.0.0.1	O
,	O
0.0.0.2	O
,	O
and	O
0.3.0.1	O
and	O
0.4.0.1	O
.	O

Each	O
version	O
expands	O
the	O
bot	O
’	O
s	O
functionality	O
and	O
works	O
to	O
obfuscate	O
the	O
malware	O
against	O
analysis	O
.	O

In	O
this	O
research	O
,	O
we	O
review	O
common	O
features	O
of	O
the	O
malware	O
and	O
examine	O
the	O
improvements	O
the	O
threat	O
actor	O
made	O
in	O
each	O
version	O
.	O

COMMON	O
FEATURES	O
Permissions	O
When	O
installed	O
,	O
EventBot	B-Malware
requests	O
the	O
following	O
permissions	O
on	O
the	O
device	O
:	O
SYSTEM_ALERT_WINDOW	O
-	O
allow	O
the	O
app	O
to	O
create	O
windows	O
that	O
are	O
shown	O
on	O
top	O
of	O
other	O
apps	O
.	O

READ_EXTERNAL_STORAGE	O
-	O
read	O
from	O
external	O
storage	O
.	O

REQUEST_INSTALL_PACKAGES	O
-	O
make	O
a	O
request	O
to	O
install	O
packages	O
.	O

INTERNET	O
-	O
open	O
network	O
sockets	O
.	O

REQUEST_IGNORE_BATTERY_OPTIMIZATIONS	O
-	O
whitelist	O
the	O
app	O
to	O
allow	O
it	O
to	O
ignore	O
battery	O
optimizations	O
.	O

WAKE_LOCK	O
-	O
prevent	O
the	O
processor	O
from	O
sleeping	O
and	O
dimming	O
the	O
screen	O
.	O

ACCESS_NETWORK_STATE	O
-	O
allow	O
the	O
app	O
to	O
access	O
information	O
about	O
networks	O
.	O

REQUEST_COMPANION_RUN_IN_BACKGROUND	O
-	O
let	O
the	O
app	O
run	O
in	O
the	O
background	O
.	O

REQUEST_COMPANION_USE_DATA_IN_BACKGROUND	O
-	O
let	O
the	O
app	O
use	O
data	O
in	O
the	O
background	O
.	O

RECEIVE_BOOT_COMPLETED	O
-	O
allow	O
the	O
application	O
to	O
launch	O
itself	O
after	O
system	O
boot	O
.	O

EventBot	B-Malware
uses	O
this	O
permission	O
in	O
order	O
to	O
achieve	O
persistence	O
and	O
run	O
in	O
the	O
background	O
as	O
a	O
service	O
.	O

RECEIVE_SMS	O
-	O
allow	O
the	O
application	O
to	O
receive	O
text	O
messages	O
.	O

READ_SMS	O
-	O
allow	O
the	O
application	O
to	O
read	O
text	O
messages	O
.	O

EventBot	B-Malware
permissions	O
EventBot	B-Malware
’	O
s	O
permissions	O
as	O
seen	O
in	O
the	O
manifest	O
file	O
.	O

THE	O
INITIAL	O
INSTALLATION	O
PROCESS	O
Once	O
installed	O
,	O
EventBot	B-Malware
prompts	O
the	O
user	O
to	O
give	O
it	O
access	O
to	O
accessibility	O
services	O
.	O

Initial	O
request	O
by	O
EventBot	B-Malware
Initial	O
request	O
by	O
EventBot	B-Malware
to	O
run	O
as	O
a	O
service	O
.	O

Once	O
the	O
malware	O
can	O
use	O
accessibility	O
services	O
,	O
it	O
has	O
the	O
ability	O
to	O
operate	O
as	O
a	O
keylogger	O
and	O
can	O
retrieve	O
notifications	O
about	O
other	O
installed	O
applications	O
and	O
content	O
of	O
open	O
windows	O
.	O

EventBot	O
’	O
s	O
request	O
to	O
use	O
accessibility	O
services	O
.	O

In	O
more	O
up-to-date	O
versions	O
of	O
Android	B-System
,	O
EventBot	B-Malware
will	O
ask	O
for	O
permissions	O
to	O
run	O
in	O
the	O
background	O
before	O
deleting	O
itself	O
from	O
the	O
launcher	O
.	O

EventBot	B-Malware
requests	O
permissions	O
to	O
always	O
run	O
in	O
the	O
background	O
.	O

DOWNLOAD	O
AND	O
UPDATE	O
THE	O
TARGET	O
CONFIGURATION	O
FILE	O
By	O
analyzing	O
and	O
decoding	O
the	O
HTTP	O
packets	O
in	O
EventBot	B-Malware
Version	O
0.0.0.1	O
,	O
we	O
can	O
see	O
that	O
EventBot	B-Malware
downloads	O
and	O
updates	O
a	O
configuration	O
file	O
with	O
almost	O
200	O
different	O
financial	O
application	O
targets	O
.	O

Following	O
is	O
the	O
HTTP	O
response	O
from	O
the	O
C2	O
server	O
,	O
containing	O
the	O
encrypted	O
configuration	O
:	O
EventBot	B-Malware
Encrypted	O
HTTP	O
response	O
returned	O
from	O
the	O
C2	O
Encrypted	O
HTTP	O
response	O
returned	O
from	O
the	O
C2	O
.	O

In	O
Version	O
0.0.0.1	O
,	O
the	O
communication	O
with	O
the	O
C2	O
is	O
encrypted	O
using	O
Base64	O
and	O
RC4	O
.	O

The	O
RC4	O
key	O
is	O
hardcoded	O
in	O
EventBot	B-Malware
.	O

Upon	O
decryption	O
,	O
we	O
can	O
see	O
that	O
the	O
response	O
from	O
the	O
server	O
is	O
a	O
JSON	O
object	O
of	O
EventBot	B-Malware
’	O
s	O
configuration	O
,	O
which	O
contains	O
C2	O
URLs	O
and	O
a	O
targeted	O
applications	O
list	O
.	O

Decrypted	O
EventBot	B-Malware
configuration	O
Decrypted	O
EventBot	B-Malware
configuration	O
returned	O
from	O
the	O
C2	O
.	O

The	O
configuration	O
file	O
contains	O
a	O
list	O
of	O
financial	O
applications	O
that	O
can	O
be	O
targeted	O
by	O
EventBot	B-Malware
.	O

This	O
version	O
includes	O
185	O
different	O
applications	O
,	O
including	O
official	O
applications	O
of	O
worldwide	O
banks	O
.	O

26	O
of	O
the	O
targeted	O
applications	O
are	O
from	O
Italy	O
,	O
25	O
are	O
from	O
the	O
UK	O
,	O
6	O
are	O
from	O
Germany	O
,	O
5	O
are	O
from	O
France	O
,	O
and	O
3	O
are	O
from	O
Spain	O
.	O

However	O
,	O
it	O
also	O
targets	O
applications	O
from	O
Romania	O
,	O
Ireland	O
,	O
India	O
,	O
Austria	O
,	O
Switzerland	O
,	O
Australia	O
,	O
Poland	O
and	O
the	O
USA	O
.	O

In	O
addition	O
to	O
official	O
banking	O
applications	O
,	O
the	O
target	O
list	O
includes	O
111	O
other	O
global	O
financial	O
applications	O
for	O
banking	O
and	O
credit	O
card	O
management	O
,	O
money	O
transfers	O
,	O
and	O
cryptocurrency	O
wallets	O
and	O
exchanges	O
.	O

Those	O
targeted	O
include	O
Paypal	B-System
Business	I-System
,	O
Revolut	B-System
,	O
Barclays	B-System
,	O
UniCredit	B-System
,	O
CapitalOne	B-System
UK	I-System
,	O
HSBC	B-System
UK	I-System
,	O
Santander	B-System
UK	I-System
,	O
TransferWise	B-System
,	O
Coinbase	B-System
,	O
paysafecard	B-System
,	O
and	O
many	O
more	O
.	O

The	O
full	O
list	O
of	O
banking	O
applications	O
targeted	O
is	O
included	O
in	O
the	O
appendix	O
.	O

ABUSE	O
OF	O
ACCESSIBILITY	O
SERVICES	O
EventBot	B-Malware
abuses	O
the	O
accessibility	O
services	O
of	O
Android	B-System
devices	O
for	O
the	O
majority	O
of	O
its	O
activity	O
.	O

Accessibility	O
features	O
are	O
typically	O
used	O
to	O
help	O
users	O
with	O
disabilities	O
by	O
giving	O
the	O
device	O
the	O
ability	O
to	O
write	O
into	O
input	O
fields	O
,	O
auto-generate	O
permissions	O
,	O
perform	O
gestures	O
for	O
the	O
user	O
,	O
etc	O
.	O

However	O
,	O
when	O
used	O
maliciously	O
,	O
accessibility	O
features	O
can	O
be	O
used	O
to	O
exploit	O
legitimate	O
services	O
for	O
malicious	O
purposes	O
,	O
like	O
with	O
EventBot	B-Malware
.	O

EventBot	B-Malware
uses	O
multiple	O
methods	O
to	O
exploit	O
accessibility	O
events	O
for	O
webinjects	O
and	O
other	O
information	O
stealing	O
purposes	O
.	O

DATA	O
GATHERING	O
Getting	O
a	O
list	O
of	O
all	O
installed	O
applications	O
:	O
Once	O
EventBot	B-Malware
is	O
installed	O
on	O
the	O
target	O
machine	O
,	O
it	O
lists	O
all	O
the	O
applications	O
on	O
the	O
target	O
machine	O
and	O
sends	O
them	O
to	O
the	O
C2	O
.	O

Device	O
information	O
:	O
EventBot	B-Malware
queries	O
for	O
device	O
information	O
like	O
OS	O
,	O
model	O
,	O
etc	O
,	O
and	O
also	O
sends	O
that	O
to	O
the	O
C2	O
.	O

EventBot	B-Malware
infected	O
device	O
to	O
be	O
sent	O
to	O
the	O
C	O
Information	O
gathered	O
about	O
the	O
infected	O
device	O
to	O
be	O
sent	O
to	O
the	O
C2	O
.	O

Data	O
encryption	O
:	O
In	O
the	O
initial	O
version	O
of	O
EventBot	B-Malware
,	O
the	O
data	O
being	O
exfiltrated	O
is	O
encrypted	O
using	O
Base64	O
and	O
RC4	O
.	O

In	O
later	O
versions	O
,	O
another	O
encryption	O
layer	O
is	O
added	O
using	O
Curve25519	O
encryption	O
.	O

All	O
of	O
the	O
most	O
recent	O
versions	O
of	O
EventBot	B-Malware
contain	O
a	O
ChaCha20	B-System
library	O
that	O
can	O
improve	O
performance	O
when	O
compared	O
to	O
other	O
algorithms	O
like	O
RC4	O
and	O
AES	O
.	O

This	O
implies	O
that	O
the	O
authors	O
are	O
actively	O
working	O
to	O
optimize	O
EventBot	B-Malware
over	O
time	O
.	O

SMS	O
grabbing	O
:	O
EventBot	B-Malware
has	O
the	O
ability	O
to	O
parse	O
SMS	O
messages	O
by	O
using	O
the	O
targeted	O
device	O
’	O
s	O
SDK	O
version	O
to	O
parse	O
them	O
correctly	O
.	O

EventBot	B-Malware
parsing	O
of	O
grabbed	O
SMS	O
messages	O
Parsing	O
of	O
grabbed	O
SMS	O
messages	O
.	O

Webinjects	O
:	O
According	O
to	O
the	O
bot	O
’	O
s	O
configuration	O
,	O
if	O
a	O
webinject	O
is	O
set	O
for	O
a	O
given	O
application	O
,	O
it	O
will	O
be	O
executed	O
.	O

EventBot	B-Malware
web	O
injects	O
execution	O
method	O
Web	O
injects	O
execution	O
method	O
by	O
a	O
pre-established	O
configuration	O
.	O

BOT	O
UPDATES	O
EventBot	B-Malware
has	O
a	O
long	O
method	O
called	O
parseCommand	O
that	O
can	O
update	O
EventBot	B-Malware
’	O
s	O
configuration	O
XML	O
files	O
,	O
located	O
in	O
the	O
shared	O
preferences	O
folder	O
on	O
the	O
device	O
.	O

EventBot	B-Malware
Dropped	O
XML	O
configuration	O
files	O
Dropped	O
XML	O
configuration	O
files	O
on	O
the	O
device	O
.	O

EventBot	B-Malware
uses	O
this	O
function	O
to	O
update	O
its	O
C2s	O
,	O
the	O
configuration	O
of	O
webinjects	O
,	O
etc	O
.	O

The	O
following	O
code	O
shows	O
EventBot	B-Malware
parsing	O
instructions	O
sent	O
from	O
the	O
C2	O
.	O

Parsing	O
of	O
instructions	O
by	O
EventBot	B-Malware
Parsing	O
of	O
instructions	O
by	O
the	O
bot	O
from	O
the	O
C2	O
.	O

UNIQUE	O
FEATURES	O
BY	O
VERSION	O
EventBot	B-Malware
Version	O
0.0.0.1	O
RC4	O
and	O
Base64	O
Packet	O
Encryption	O
EventBot	B-Malware
RC4	O
and	O
Base64	O
data	O
decryption	O
from	O
the	O
C2	O
RC4	O
and	O
Base64	O
data	O
decryption	O
from	O
the	O
C2	O
.	O

As	O
mentioned	O
above	O
,	O
EventBot	B-Malware
Version	O
0.0.0.1	O
sends	O
a	O
JSON	O
object	O
containing	O
the	O
Android	B-System
package	O
names	O
of	O
all	O
the	O
apps	O
installed	O
on	O
the	O
victim	O
’	O
s	O
device	O
alongside	O
additional	O
metadata	O
,	O
including	O
the	O
bot	O
version	O
,	O
botnetID	O
,	O
and	O
the	O
reason	O
this	O
package	O
is	O
sent	O
.	O

For	O
this	O
particular	O
packet	O
,	O
the	O
reason	O
is	O
registration	O
of	O
the	O
bot	O
.	O

If	O
the	O
connection	O
to	O
the	O
C2	O
fails	O
,	O
it	O
will	O
continue	O
to	O
retry	O
until	O
it	O
is	O
successful	O
.	O

EventBot	B-Malware
Logcat	O
from	O
the	O
infected	O
device	O
Logcat	O
from	O
the	O
infected	O
device	O
.	O

EVENTBOT	B-Malware
VERSION	O
0.0.0.2	O
Dynamic	O
Library	O
Loading	O
As	O
of	O
Version	O
0.0.0.2	O
,	O
EventBot	B-Malware
attempts	O
to	O
hide	O
its	O
main	O
functionality	O
from	O
static	O
analysis	O
.	O

With	O
Version	O
0.0.0.1	O
,	O
there	O
is	O
a	O
dedicated	O
functions	O
class	O
where	O
all	O
main	O
malicious	O
activity	O
happens	O
and	O
can	O
be	O
observed	O
.	O

Instead	O
,	O
in	O
Version	O
0.0.0.2	O
,	O
EventBot	B-Malware
dynamically	O
loads	O
its	O
main	O
module	O
.	O

EventBot	B-Malware
loaded	O
library	O
Loaded	O
library	O
as	O
seen	O
in	O
Logcat	O
.	O

By	O
browsing	O
EventBot	B-Malware
’	O
s	O
installation	O
path	O
on	O
the	O
device	O
,	O
we	O
can	O
see	O
the	O
library	O
dropped	O
in	O
the	O
app_dex	O
folder	O
.	O

EventBot	B-Malware
loaded	O
library	O
The	O
loaded	O
library	O
dropped	O
on	O
the	O
device	O
.	O

The	O
code	O
to	O
load	O
the	O
main	O
module	O
dynamically	O
can	O
also	O
be	O
seen	O
statically	O
.	O

The	O
malicious	O
library	O
is	O
loaded	O
from	O
Eventbot	B-Malware
’	O
s	O
assets	O
that	O
contain	O
a	O
font	O
file	O
called	O
default.ttf	B-Indicator
which	O
is	O
actually	O
the	O
hidden	O
library	O
and	O
then	O
decoded	O
using	O
RC4	O
.	O

EventBot	O
method	O
responsible	O
for	O
the	O
library	O
loading	O
The	O
method	O
responsible	O
for	O
the	O
library	O
loading	O
.	O

EventBot	B-Malware
has	O
the	O
ability	O
to	O
update	O
its	O
library	O
or	O
potentially	O
even	O
download	O
a	O
second	O
library	O
when	O
given	O
a	O
command	O
from	O
the	O
C2	O
.	O

An	O
updated	O
library	O
name	O
is	O
generated	O
by	O
calculating	O
the	O
md5sum	O
of	O
several	O
device	O
properties	O
,	O
while	O
concatenating	O
the	O
build	O
model	O
twice	O
in	O
case	O
of	O
an	O
update	O
to	O
the	O
library	O
.	O

EventBot	O
Updated	O
library	O
naming	O
convention	O
EventBot	B-Malware
New	O
library	O
naming	O
convention	O
.	O

Data	O
Encryption	O
The	O
Curve25519	O
encryption	O
algorithm	O
was	O
implemented	O
as	O
of	O
EventBot	B-Malware
Version	O
0.0.0.2	O
.	O

This	O
encryption	O
algorithm	O
is	O
an	O
extra	O
security	O
layer	O
for	O
communicating	O
with	O
the	O
C2	O
,	O
an	O
improvement	O
over	O
the	O
previous	O
version	O
of	O
a	O
plain	O
RC4	O
encryption	O
.	O

When	O
reviewing	O
the	O
decrypted	O
packet	O
,	O
it	O
’	O
s	O
clear	O
it	O
has	O
the	O
same	O
content	O
as	O
previous	O
versions	O
.	O

EventBot	B-Malware
decryption	O
of	O
packets	O
from	O
the	O
C2	O
Decryption	O
of	O
packets	O
from	O
the	O
C2	O
using	O
Curve25519	O
.	O

EVENTBOT	O
VERSION	O
0.3.0.1	O
Additional	O
Assets	O
Based	O
on	O
Country	O
/	O
Region	O
EventBot-23aEventBot	O
Spanish	O
and	O
Italian	O
Images	O
in	O
Spanish	O
and	O
Italian	O
added	O
in	O
version	O
0.3.0.1	O
.	O

Version	O
0.3.0.1	O
includes	O
Italian	O
and	O
Spanish	O
language	O
compatibility	O
within	O
the	O
resources	O
section	O
.	O

Presumably	O
,	O
this	O
was	O
done	O
to	O
make	O
the	O
app	O
seem	O
more	O
credible	O
to	O
targeted	O
users	O
in	O
different	O
countries	O
.	O

Grabbing	O
the	O
Screen	O
PIN	O
with	O
Support	O
for	O
Samsung	B-Organization
Devices	O
Version	O
0.3.0.1	O
added	O
an	O
~800	O
line	O
long	O
method	O
called	O
grabScreenPin	O
,	O
which	O
uses	O
accessibility	O
features	O
to	O
track	O
pin	O
code	O
changes	O
in	O
the	O
device	O
’	O
s	O
settings	O
.	O

It	O
listens	O
to	O
events	O
like	O
TYPE_VIEW_TEXT_CHANGED	O
.	O

We	O
suspect	O
the	O
updated	O
PIN	O
is	O
sent	O
to	O
the	O
C2	O
,	O
most	O
likely	O
to	O
give	O
the	O
malware	O
the	O
option	O
to	O
perform	O
privileged	O
activities	O
on	O
the	O
infected	O
device	O
related	O
to	O
payments	O
,	O
system	O
configuration	O
options	O
,	O
etc	O
.	O

EventBot	B-Malware
Listening	O
to	O
TYPE_VIEW_TEXT_CHANGED	O
accessibility	O
event	O
Listening	O
to	O
TYPE_VIEW_TEXT_CHANGED	O
accessibility	O
event	O
.	O

After	O
collecting	O
the	O
changed	O
PIN	O
code	O
,	O
it	O
is	O
sent	O
back	O
to	O
the	O
C2	O
.	O

EventBot	B-Malware
Sending	O
the	O
pin	O
code	O
back	O
to	O
the	O
C2	O
Sending	O
the	O
pin	O
code	O
back	O
to	O
the	O
C2	O
.	O

Eventually	O
,	O
the	O
screen	O
PIN	O
preferences	O
will	O
be	O
saved	O
to	O
an	O
additional	O
XML	O
file	O
in	O
the	O
shared	O
preferences	O
folder	O
.	O

EventBot	O
screenPinPrefs.xml	B-Indicator
The	O
content	O
of	O
screenPinPrefs.xml	B-Indicator
.	O

The	O
grabScreenPin	O
method	O
has	O
separate	O
conditioning	O
to	O
handle	O
screen	O
lock	O
events	O
in	O
Samsung	B-Organization
devices	O
.	O

EventBot	B-Malware
screen	O
lock	O
with	O
support	O
for	O
Samsung	B-Organization
devices	O
A	O
new	O
method	O
to	O
handle	O
screen	O
lock	O
with	O
support	O
for	O
Samsung	B-Organization
devices	O
.	O

EVENTBOT	O
VERSION	O
0.4.0.1	O
Package	O
Name	O
Randomization	O
In	O
this	O
version	O
,	O
the	O
package	O
name	O
is	O
no	O
longer	O
named	O
‘	O
com.example.eventbot	B-Indicator
’	O
,	O
which	O
makes	O
it	O
more	O
difficult	O
to	O
track	O
down	O
.	O

EventBot	B-Malware
Randomized	O
package	O
name	O
Randomized	O
package	O
name	O
instead	O
of	O
com.example.eventbot	B-Indicator
.	O

ProGuard	B-System
Obfuscation	O
As	O
with	O
many	O
other	O
Android	B-System
applications	O
,	O
EventBot	B-Malware
is	O
now	O
using	O
obfuscation	O
.	O

Both	O
the	O
loader	O
and	O
dropped	O
class	O
are	O
obfuscated	O
using	O
ProGuard	B-Indicator
,	O
which	O
obfuscates	O
names	O
using	O
alphabet	O
letters	O
.	O

The	O
code	O
itself	O
is	O
not	O
modified	O
by	O
this	O
type	O
of	O
obfuscation	O
though	O
,	O
making	O
the	O
analysis	O
easier	O
.	O

EventBot	B-Malware
Obfuscated	O
class	O
names	O
Obfuscated	O
class	O
names	O
using	O
letters	O
of	O
the	O
alphabet	O
.	O

Hidden	O
Configuration	O
Data	O
As	O
mentioned	O
above	O
,	O
EventBot	B-Malware
begins	O
using	O
obfuscation	O
.	O

Due	O
to	O
this	O
obfuscation	O
,	O
a	O
part	O
of	O
the	O
previously	O
mentioned	O
cfg	O
class	O
is	O
now	O
mapped	O
to	O
c/b/a/a/a	O
or	O
c/a/a/a/a	O
.	O

EventBot	O
C2	O
URLs	O
C2	O
URLs	O
and	O
other	O
settings	O
in	O
a	O
nested	O
class	O
.	O

Other	O
configuration	O
data	O
is	O
located	O
elsewhere	O
,	O
and	O
some	O
of	O
it	O
can	O
been	O
seen	O
here	O
:	O
The	O
encrypted	O
library	O
path	O
The	O
output	O
folder	O
on	O
the	O
device	O
for	O
the	O
dropped	O
library	O
The	O
name	O
of	O
the	O
library	O
after	O
it	O
is	O
loaded	O
eventBot	O
name	O
string	O
Version	O
number	O
A	O
string	O
used	O
as	O
an	O
RC4	O
key	O
,	O
both	O
for	O
decrypting	O
the	O
library	O
and	O
as	O
a	O
part	O
of	O
the	O
network	O
data	O
encryption	O
(	O
hasn	O
’	O
t	O
changed	O
from	O
the	O
previous	O
version	O
)	O
The	O
C2	O
URLs	O
A	O
randomized	O
class	O
name	O
using	O
the	O
device	O
’	O
s	O
accessibility	O
services	O
EventBot	B-Malware
extracted	O
configuration	O
Part	O
of	O
the	O
extracted	O
configuration	O
of	O
the	O
new	O
version	O

.	O

MALWARE	O
UNDER	O
ACTIVE	O
DEVELOPMENT	O
EventBot	B-Malware
“	O
cfg	O
”	O
class	O
EventBot	B-Malware
“	O
cfg	O
”	O
class	O
.	O

EventBot	B-Malware
is	O
in	O
constant	O
development	O
,	O
as	O
seen	O
with	O
the	O
botnetID	O
string	O
above	O
,	O
which	O
shows	O
consecutive	O
numbering	O
across	O
versions	O
.	O

This	O
example	O
is	O
from	O
a	O
later	O
version	O
of	O
EventBot	B-Malware
,	O
and	O
in	O
other	O
versions	O
the	O
naming	O
convention	O
is	O
very	O
similar	O
,	O
with	O
bot	O
IDs	O
such	O
as	O
word100	O
,	O
word101	O
,	O
word102	O
,	O
and	O
test2005	O
,	O
test2006	O
etc	O
.	O

In	O
the	O
latest	O
version	O
,	O
a	O
layer	O
of	O
obfuscation	O
was	O
added	O
,	O
perhaps	O
taking	O
the	O
malware	O
one	O
step	O
closer	O
to	O
being	O
fully	O
operational	O
.	O

SUSPECTED	O
DETECTION	O
TESTS	O
BY	O
THE	O
THREAT	O
ACTOR	O
In	O
searching	O
for	O
EventBot	B-Malware
,	O
we	O
’	O
ve	O
identified	O
multiple	O
submissions	O
from	O
the	O
same	O
submitter	O
hash	O
,	O
22b3c7b0	B-Indicator
:	O
EventBot	B-Malware
22b3c7b0	B-Indicator
submitter	O
hash	O
The	O
22b3c7b0	B-Indicator
submitter	O
hash	O
that	O
submitted	O
most	O
of	O
the	O
EventBot	B-Malware
samples	O
to	O
VirusTotal	O
.	O

This	O
submitter	O
has	O
thousands	O
of	O
other	O
submissions	O
in	O
VirusTotal	O
,	O
however	O
,	O
it	O
is	O
the	O
only	O
one	O
that	O
continues	O
to	O
submit	O
EventBot	B-Malware
samples	O
via	O
the	O
VirusTotal	O
API	O
.	O

Also	O
,	O
the	O
botnet	O
IDs	O
increment	O
over	O
time	O
as	O
they	O
are	O
submitted	O
.	O

Given	O
this	O
,	O
and	O
the	O
naming	O
convention	O
of	O
the	O
submissions	O
(	O
.virus	O
)	O
,	O
the	O
submitter	O
hash	O
most	O
likely	O
belongs	O
to	O
an	O
AV	O
vendor	O
or	O
sandboxing	O
environment	O
that	O
automatically	O
submits	O
samples	O
to	O
online	O
malware	O
databases	O
.	O

It	O
may	O
be	O
that	O
these	O
submissions	O
are	O
made	O
from	O
the	O
author	O
’	O
s	O
machine	O
,	O
or	O
that	O
they	O
submit	O
it	O
to	O
a	O
detection	O
service	O
that	O
in	O
turn	O
submits	O
to	O
online	O
malware	O
databases	O
.	O

EVENTBOT	B-Malware
THREAT	O
ACTORS	O
As	O
a	O
part	O
of	O
this	O
investigation	O
,	O
the	O
Cybereason	B-Organization
Nocturnus	I-Organization
team	O
has	O
attempted	O
to	O
identify	O
the	O
threat	O
actors	O
behind	O
the	O
development	O
of	O
EventBot	B-Malware
.	O

The	O
evidence	O
above	O
suggests	O
that	O
EventBot	B-Malware
is	O
still	O
in	O
the	O
development	O
stage	O
,	O
and	O
as	O
such	O
,	O
is	O
not	O
likely	O
to	O
have	O
been	O
used	O
for	O
large	O
attack	O
campaigns	O
thus	O
far	O
.	O

The	O
Cybereason	B-Organization
Nocturnus	I-Organization
team	O
is	O
monitoring	O
multiple	O
underground	O
platforms	O
in	O
an	O
attempt	O
to	O
identify	O
chatter	O
relating	O
to	O
EventBot	B-Malware
.	O

New	O
malware	O
is	O
often	O
introduced	O
to	O
underground	O
communities	O
by	O
being	O
promoted	O
and	O
sold	O
or	O
offered	O
as	O
a	O
giveaway	O
.	O

However	O
,	O
at	O
the	O
time	O
of	O
writing	O
,	O
we	O
were	O
unable	O
to	O
identify	O
relevant	O
conversations	O
about	O
the	O
EventBot	B-Malware
malware	O
.	O

This	O
strengthens	O
our	O
suspicion	O
that	O
this	O
malware	O
is	O
still	O
undergoing	O
development	O
and	O
has	O
not	O
been	O
officially	O
marketed	O
or	O
released	O
yet	O
.	O

EVENTBOT	B-Malware
INFRASTRUCTURE	O
By	O
mapping	O
the	O
C2	O
servers	O
,	O
a	O
clear	O
,	O
repeated	O
pattern	O
emerges	O
based	O
on	O
the	O
specific	O
URL	O
gate_cb8a5aea1ab302f0_c	O
.	O

As	O
of	O
this	O
writing	O
,	O
all	O
the	O
domains	O
were	O
registered	O
recently	O
and	O
some	O
are	O
already	O
offline	O
.	O

URL	O
Status	O
IP	O
Domain	O
registration	O
date	O
http	B-Indicator
:	I-Indicator
//ora.studiolegalebasili	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/gate_cb8a5aea1ab302f0_c	I-Indicator
offline	O
31.214.157	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
6	I-Indicator
2020-02-29	O
http	B-Indicator
:	I-Indicator
//themoil	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
site/gate_cb8a5aea1ab302f0_c	I-Indicator
online	O
208.91.197	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
91	I-Indicator
2020-03-04	O
http	B-Indicator
:	I-Indicator
//ora.carlaarrabitoarchitetto	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/gate_cb8a5aea1ab302f0_c	I-Indicator
offline	O
31.214.157	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
6	I-Indicator
2020-03-26	O
http	B-Indicator
:	I-Indicator
//rxc.rxcoordinator	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/gate_cb8a5aea1ab302f0_c	I-Indicator
online	O
185.158.248	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
102	I-Indicator
2020-03-29	O
http	B-Indicator
:	I-Indicator
//ora.blindsidefantasy	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/gate_cb8a5aea1ab302f0_c	I-Indicator
online	O
185.158.248	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
102	I-Indicator
2020-04-02	O
http	B-Indicator
:	I-Indicator
//marta.martatovaglieri	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
it/gate_cb8a5aea1ab302f0_c	I-Indicator
online	O
185.158.248	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
102	I-Indicator
2020-04-14	O
http	B-Indicator
:	I-Indicator
//pub.douglasshome	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/gate_cb8a5aea1ab302f0_c	I-Indicator
online	O
185.158.249	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
141	I-Indicator
2020-04-26	O
In	O
the	O
course	O
of	O
the	O
investigation	O
,	O
the	O
team	O
discovered	O
a	O
potential	O
link	O
to	O
an	O
additional	O
Android	B-Malware
infostealer	I-Malware
.	O

The	O
IP	O
address	O
of	O
both	O
ora.carlaarrabitoarchitetto	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
and	O
ora.studiolegalebasili	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
,	O
31.214.157	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
6	I-Indicator
,	O
was	O
previously	O
hosting	O
the	O
domain	B-Indicator
next.nextuptravel	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
.	O

This	O
was	O
the	O
C2	O
for	O
an	O
Android	B-Malware
infostealer	I-Malware
responsible	O
for	O
several	O
attacks	O
in	O
Italy	O
back	O
in	O
late	O
2019	O
.	O

EventBot	B-Malware
VirusTotal	O
search	O
for	O
the	O
malicious	O
IP	O
address	O
VirusTotal	O
search	O
for	O
the	O
malicious	O
IP	O
address	O
.	O

IMPACT	O
EventBot	B-Malware
is	O
a	O
mobile	O
malware	O
banking	O
trojan	O
that	O
steals	O
financial	O
information	O
,	O
is	O
able	O
to	O
hijack	O
transactions	O
.	O

Once	O
this	O
malware	O
has	O
successfully	O
installed	O
,	O
it	O
will	O
collect	O
personal	O
data	O
,	O
passwords	O
,	O
keystrokes	O
,	O
banking	O
information	O
,	O
and	O
more	O
.	O

This	O
information	O
can	O
give	O
the	O
attacker	O
access	O
to	O
personal	O
and	O
business	O
bank	O
accounts	O
,	O
personal	O
and	O
business	O
data	O
,	O
and	O
more	O
.	O

Letting	O
an	O
attacker	O
get	O
access	O
to	O
this	O
kind	O
of	O
data	O
can	O
have	O
severe	O
consequences	O
.	O

60	O
%	O
of	O
devices	O
containing	O
or	O
accessing	O
enterprise	O
data	O
are	O
mobile	O
.	O

Giving	O
an	O
attacker	O
access	O
to	O
a	O
mobile	O
device	O
can	O
have	O
severe	O
business	O
consequences	O
,	O
especially	O
if	O
the	O
end	O
user	O
is	O
using	O
their	O
mobile	O
device	O
to	O
discuss	O
sensitive	O
business	O
topics	O
or	O
access	O
enterprise	O
financial	O
information	O
.	O

This	O
can	O
result	O
in	O
brand	O
degradation	O
,	O
loss	O
of	O
individual	O
reputation	O
,	O
or	O
loss	O
of	O
consumer	O
trust	O
.	O

Much	O
like	O
we	O
have	O
seen	O
in	O
recent	O
months	O
,	O
anyone	O
can	O
be	O
impacted	O
by	O
a	O
mobile	O
device	O
attack	O
.	O

These	O
attacks	O
are	O
only	O
becoming	O
more	O
common	O
,	O
with	O
one	O
third	O
of	O
all	O
malware	O
now	O
targeting	O
mobile	O
endpoints	O
.	O

Care	O
and	O
concern	O
both	O
for	O
using	O
a	O
mobile	O
device	O
and	O
for	O
securing	O
a	O
mobile	O
device	O
is	O
critical	O
,	O
especially	O
for	O
those	O
organizations	O
that	O
allow	O
bring-your-own-devices	O
.	O

CYBEREASON	B-System
MOBILE	I-System
Cybereason	B-System
Mobile	I-System
detects	I-System
EventBot	B-Malware
and	O
immediately	O
takes	O
remediation	O
actions	O
to	O
protect	O
the	O
end	O
user	O
.	O

With	O
Cybereason	B-System
Mobile	I-System
,	O
analysts	O
can	O
address	O
mobile	O
threats	O
in	O
the	O
same	O
platform	O
as	O
traditional	O
endpoint	O
threats	O
,	O
all	O
as	O
part	O
of	O
one	O
incident	O
.	O

Without	O
mobile	O
threat	O
detection	O
,	O
this	O
attack	O
would	O
not	O
be	O
detected	O
,	O
leaving	O
end	O
users	O
and	O
organizations	O
at	O
risk	O
.	O

Cybereason	B-System
Mobile	I-System
detects	O
EventBot	B-Malware
and	O
provides	O
the	O
user	O
with	O
immediate	O
actions	O
.	O

CONCLUSION	O
In	O
this	O
research	O
,	O
the	O
Nocturnus	B-Organization
team	O
has	O
dissected	O
a	O
rapidly	O
evolving	O
Android	B-Malware
malware	O
in	O
the	O
making	O
.	O

This	O
malware	O
abuses	O
the	O
Android	B-System
accessibility	O
feature	O
to	O
steal	O
user	O
information	O
and	O
is	O
able	O
to	O
update	O
its	O
code	O
and	O
release	O
new	O
features	O
every	O
few	O
days	O
.	O

With	O
each	O
new	O
version	O
,	O
the	O
malware	O
adds	O
new	O
features	O
like	O
dynamic	O
library	O
loading	O
,	O
encryption	O
,	O
and	O
adjustments	O
to	O
different	O
locales	O
and	O
manufacturers	O
.	O

EventBot	B-Malware
appears	O
to	O
be	O
a	O
completely	O
new	O
malware	O
in	O
the	O
early	O
stages	O
of	O
development	O
,	O
giving	O
us	O
an	O
interesting	O
view	O
into	O
how	O
attackers	O
create	O
and	O
test	O
their	O
malware	O
.	O

Cybereason	B-Organization
classifies	O
EventBot	B-Malware
as	O
a	O
mobile	O
banking	O
trojan	O
and	O
infostealer	O
based	O
on	O
the	O
stealing	O
features	O
discussed	O
in	O
this	O
research	O
.	O

It	O
leverages	O
webinjects	O
and	O
SMS	O
reading	O
capabilities	O
to	O
bypass	O
two-factor	O
authentication	O
,	O
and	O
is	O
clearly	O
targeting	O
financial	O
applications	O
.	O

Although	O
the	O
threat	O
actor	O
responsible	O
for	O
the	O
development	O
of	O
EventBot	B-Malware
is	O
still	O
unknown	O
and	O
the	O
malware	O
does	O
not	O
appear	O
to	O
be	O
involved	O
in	O
major	O
attacks	O
,	O
it	O
is	O
interesting	O
to	O
follow	O
the	O
early	O
stages	O
of	O
mobile	O
malware	O
development	O
.	O

The	O
Cybereason	B-Organization
Nocturnus	I-Organization
team	O
will	O
continue	O
to	O
monitor	O
EventBot	B-Malware
’	O
s	O
development	O
.	O

In	O
recent	O
years	O
,	O
online	O
activity	O
has	O
gradually	O
been	O
shifting	O
from	O
personal	O
computers	O
to	O
mobile	O
devices	O
.	O

Naturally	O
,	O
this	O
resulted	O
in	O
the	O
introduction	O
of	O
malware	O
for	O
mobile	O
platforms	O
,	O
especially	O
Android	B-System
devices	O
,	O
including	O
Cerberus	B-Malware
,	O
Xhelper	B-Malware
and	O
the	O
Anubis	B-Malware
Banking	O
Trojan	O
.	O

As	O
many	O
people	O
use	O
their	O
mobile	O
devices	O
for	O
online	O
shopping	O
and	O
even	O
to	O
manage	O
their	O
bank	O
accounts	O
,	O
the	O
mobile	O
arena	O
became	O
increasingly	O
profitable	O
for	O
cyber	O
criminals	O
.	O

This	O
is	O
why	O
we	O
recently	O
released	O
Cybereason	B-System
Mobile	I-System
,	O
a	O
new	O
offering	O
that	O
strengthens	O
the	O
Cybereason	B-System
Defense	I-System
Platform	I-System
by	O
bringing	O
prevention	O
,	O
detection	O
,	O
and	O
response	O
capabilities	O
to	O
mobile	O
devices	O
.	O

With	O
Cybereason	B-System
Mobile	I-System
,	O
our	O
customers	O
can	O
protect	O
against	O
modern	O
threats	O
across	O
traditional	O
and	O
mobile	O
endpoints	O
,	O
all	O
within	O
a	O
single	O
console	O
.	O

Check	B-Organization
Point	I-Organization
Mobile	B-System
Threat	I-System
Prevention	I-System
has	O
detected	O
two	O
instances	O
of	O
a	O
mobile	O
malware	O
variant	O
infecting	O
multiple	O
devices	O
within	O
the	O
Check	B-Organization
Point	I-Organization
customer	O
base	O
.	O

The	O
malware	O
,	O
packaged	O
within	O
an	O
Android	B-System
game	O
app	O
called	O
BrainTest	B-Malware
,	O
had	O
been	O
published	O
to	O
Google	B-System
Play	I-System
twice	O
.	O

Each	O
instance	O
had	O
between	O
100,000	O
and	O
500,000	O
downloads	O
according	O
to	O
Google	B-System
Play	I-System
statistics	O
,	O
reaching	O
an	O
aggregated	O
infection	O
rate	O
of	O
between	O
200,000	O
and	O
1	O
million	O
users	O
.	O

Check	B-Organization
Point	I-Organization
reached	O
out	O
to	O
Google	B-Organization
on	O
September	O
10	O
,	O
2015	O
,	O
and	O
the	O
app	O
containing	O
the	O
malware	O
was	O
removed	O
from	O
Google	B-System
Play	I-System
on	O
September	O
15	O
,	O
2015	O
.	O

Overview	O
The	O
malware	O
was	O
first	O
detected	O
on	O
a	O
Nexus	B-System
5	I-System
smartphone	O
,	O
and	O
although	O
the	O
user	O
attempted	O
to	O
remove	O
the	O
infected	O
app	O
,	O
the	O
malware	O
reappeared	O
on	O
the	O
same	O
device	O
shortly	O
thereafter	O
.	O

Our	O
analysis	O
of	O
the	O
malware	O
shows	O
it	O
uses	O
multiple	O
,	O
advanced	O
techniques	O
to	O
avoid	O
Google	B-System
Play	I-System
malware	O
detection	O
and	O
to	O
maintain	O
persistency	O
on	O
target	O
devices	O
.	O

Once	O
this	O
malware	O
was	O
detected	O
on	O
a	O
device	O
,	O
Mobile	B-System
Threat	I-System
Prevention	I-System
adjusted	O
security	O
policies	O
on	O
the	O
Mobile	O
Device	O
Management	O
solution	O
(	O
MobileIron	O
)	O
managing	O
the	O
affected	O
devices	O
automatically	O
,	O
thereby	O
blocking	O
enterprise	O
access	O
from	O
the	O
infected	O
devices	O
.	O

While	O
the	O
malware	O
is	O
capable	O
of	O
facilitating	O
various	O
cyber-criminal	O
goals	O
,	O
our	O
team	O
confirmed	O
it	O
’	O
s	O
currently	O
installing	O
additional	O
apps	O
on	O
infected	O
devices	O
.	O

Disturbingly	O
,	O
the	O
malware	O
establishes	O
a	O
rootkit	O
on	O
the	O
device	O
,	O
allowing	O
it	O
to	O
download	O
and	O
execute	O
any	O
code	O
a	O
cybercriminal	O
would	O
want	O
to	O
run	O
on	O
a	O
device	O
.	O

For	O
example	O
,	O
it	O
could	O
be	O
used	O
to	O
display	O
unwanted	O
and	O
annoying	O
advertisements	O
on	O
a	O
device	O
,	O
or	O
potentially	O
,	O
to	O
download	O
and	O
deploy	O
a	O
payload	O
that	O
steals	O
credentials	O
from	O
an	O
infected	O
device	O
.	O

Highlights	O
Samples	O
of	O
the	O
malicious	O
code	O
found	O
in	O
BrainTest	B-Malware
have	O
been	O
found	O
on	O
Google	B-System
Play	I-System
,	O
and	O
its	O
creator	O
has	O
used	O
multiple	O
methods	O
to	O
evade	O
detection	O
by	O
Google	B-Organization
including	O
Bypassing	O
Google	B-System
Bouncer	I-System
by	O
detecting	O
if	O
the	O
malware	O
is	O
being	O
run	O
from	O
an	O
IP	O
or	O
domain	O
mapped	O
to	O
Google	B-System
Bouncer	I-System
and	O
,	O
if	O
so	O
,	O
it	O
will	O
not	O
perform	O
its	O
intended	O
malicious	O
activities	O
.	O

Combining	O
timebombs	O
,	O
dynamic	O
code	O
loading	O
,	O
and	O
use	O
of	O
reflection	O
to	O
complicate	O
reverse	O
engineering	O
of	O
the	O
malware	O
.	O

Using	O
off-the-shelf	O
obfuscation	O
(	O
packer	O
)	O
from	O
Baidu	B-Organization
to	O
re-introduce	O
the	O
malware	O
to	O
Google	B-System
Play	I-System
after	O
the	O
first	O
instance	O
was	O
removed	O
on	O
Aug	O
24th	O
.	O

BrainTest	B-Malware
uses	O
four	O
privilege	B-Vulnerability
escalation	I-Vulnerability
exploits	I-Vulnerability
to	O
gain	O
root	O
access	O
on	O
a	O
device	O
and	O
to	O
install	O
a	O
persistent	O
malware	O
as	O
a	O
system	O
application	O
.	O

BrainTest	B-Malware
leverages	O
an	O
anti-uninstall	B-Vulnerability
watchdog	I-Vulnerability
that	O
uses	O
two	O
system	O
applications	O
to	O
monitor	O
the	O
removal	O
of	O
one	O
of	O
the	O
components	O
and	O
reinstall	O
the	O
component	O
.	O

After	O
the	O
the	O
first	O
instance	O
of	O
BrainTest	B-Malware
was	O
detected	O
,	O
Google	B-Organization
removed	O
the	O
app	O
from	O
Google	B-System
Play	I-System
.	O

Within	O
days	O
,	O
the	O
Check	B-Organization
Point	I-Organization
research	O
team	O
detected	O
another	O
instance	O
with	O
a	O
different	O
package	O
name	O
but	O
which	O
uses	O
the	O
same	O
code	O
.	O

The	O
malware	O
’	O
s	O
creators	O
had	O
used	O
obfuscation	O
to	O
upload	O
the	O
new	O
piece	O
of	O
malware	O
to	O
Google	B-System
Play	I-System
.	O

Technical	O
Analysis	O
The	O
malware	O
consists	O
of	O
2	O
applications	O
:	O
The	O
Dropper	O
:	O
Brain	O
Test	O
(	O
Unpacked	O
–	O
com.mile.brain	B-Indicator
,	O
Packed	O
–	O
com.zmhitlte.brain	B-Indicator
)	O
This	O
is	O
installed	O
from	O
Google	B-System
Play	I-System
and	O
downloads	O
an	O
exploit	O
pack	O
from	O
the	O
server	O
to	O
obtain	O
root	O
access	O
on	O
a	O
device	O
.	O

If	O
root	O
access	O
is	O
obtained	O
,	O
the	O
application	O
downloads	O
a	O
malicious	O
.apk	O
file	O
(	O
The	O
Backdoor	O
)	O
from	O
the	O
server	O
and	O
installs	O
it	O
as	O
system	O
application	O
.	O

The	O
Backdoor	O
:	O
System	O
malware	O
(	O
mcpef.apk	B-Indicator
and	O
brother.apk	B-Indicator
)	O
This	O
tries	O
a	O
few	O
persistence	O
methods	O
by	O
using	O
few	O
anti-uninstall	O
techniques	O
(	O
described	O
below	O
)	O
and	O
downloads	O
and	O
executes	O
code	O
from	O
server	O
without	O
user	O
consent	O
.	O

Detailed	O
Malware	O
Structure	O
Malware	O
Strucutre	O
com.mile.brain	B-Indicator
(	O
SHA256	O
:	O
135d6acff3ca27e6e7997429e5f8051f88215d12351e4103f8344cd66611e0f3	B-Indicator
)	O
:	O
This	O
is	O
the	O
main	O
application	O
found	O
on	O
Google	B-System
Play	I-System
.	O

It	O
contains	O
encrypted	O
java	O
archive	O
“	O
start.ogg	B-Indicator
”	O
in	O
the	O
assets	O
directory	O
and	O
dynamically	O
loads	O
code	O
with	O
dalvik.system.DexClassLoader	B-Indicator
.	O

do.jar	B-Indicator
(	O
SHA256	O
:	O
a711e620246d9954510d3f1c8d5c784bacc78069a5c57b9ec09c3e234bc33a8b	B-Indicator
)	O
:	O
The	O
decrypted	O
file	O
that	O
was	O
created	O
by	O
“	O
start.ogg.	B-Indicator
”	O
It	O
sends	O
a	O
request	O
to	O
the	O
server	O
with	O
the	O
device	O
’	O
s	O
configuration	O
.	O

The	O
server	O
’	O
s	O
response	O
is	O
a	O
json	O
,	O
containing	O
a	O
link	O
to	O
a	O
.jar	O
file	O
,	O
class	O
name	O
and	O
method	O
name	O
to	O
be	O
executed	O
with	O
reflection	O
API	O
.	O

The	O
application	O
downloads	O
the	O
file	O
and	O
dynamically	O
loads	O
it	O
using	O
dalvik.system.DexClassLoader	O
and	O
invokes	O
class	O
and	O
method	O
specified	O
in	O
json	B-Indicator
.	I-Indicator

jhfrte.jar	I-Indicator
:	O
This	O
is	O
a	O
java	O
archive	O
file	O
downloaded	O
from	O
server	O
.	O

If	O
a	O
device	O
isn	O
’	O
t	O
rooted	O
,	O
it	O
downloads	O
from	O
the	O
server	O
an	O
exploit	O
pack	O
and	O
executes	O
it	O
to	O
obtain	O
root	O
on	O
device	O
.	O

Once	O
root	O
is	O
obtained	O
,	O
it	O
downloads	O
an	O
additional	O
APK	O
file	O
from	O
the	O
server	O
(	O
mcpef.apk	B-Indicator
)	O
and	O
installs	O
it	O
as	O
system	O
application	O
(	O
/system	O
directory	O
)	O
.	O

r1-r4	O
:	O
This	O
is	O
a	O
local	O
privilege	O
escalation	O
(	O
root	O
)	O
exploit	O
,	O
which	O
includes	O
:	O
CVE-2013-6282	B-Vulnerability
,	O
camerageroot	O
(	O
http	B-Indicator
:	I-Indicator
//www.77169.org/exploits/2013/20130414031700	I-Indicator
)	I-Indicator
,	O
a	O
rooting	O
tool	O
for	O
mtk6592	O
and	O
addtional	O
exploit	O
.	O

nis	O
:	O
The	O
su	O
application	O
used	O
to	O
execute	O
shell	O
commands	O
with	O
root	O
privileges	O
.	O

mcpef.apk	B-Indicator
(	O
SHA256	O
:	O
a8e7dfac00adf661d371ac52bddc03b543bd6b7aa41314b255e53d810931ceac	B-Indicator
)	O
:	O
The	O
malicious	O
system	O
application	O
downloaded	O
from	O
server	O
(	O
package	O
name	O
–	O
com.android.music.helper	B-Indicator
)	O
.	O

This	O
installs	O
additional	O
application	O
from	O
assets	O
directory	O
(	O
brother.apk	B-System
)	O
and	O
listens	O
for	O
PACKAGE_REMOVED	O
events	O
.	O

If	O
brother.apk	B-System
application	O
is	O
removed	O
,	O
mcpef.apk	B-System
reinstalls	O
brother.apk	B-System
from	O
assets	O
.	O

brother.apk	B-System
(	O
SHA256	O
:	O
422fec2e201600bb2ea3140951563f8c6fbd4f8279a04a164aca5e8e753c40e8	B-Indicator
)	O
:	O
The	O
package	O
name	O
–	O
com.android.system.certificate	B-Indicator
.	O

System	O
application	O
installed	O
by	O
mcpef.apk	B-Indicator
.	O

This	O
has	O
the	O
same	O
functionality	O
as	O
mcpef.apk	B-Indicator
.	O

In	O
addition	O
,	O
it	O
monitors	O
to	O
verify	O
if	O
com.android.music.helper	B-Indicator
package	O
is	O
removed	O
.	O

If	O
mcpef.apk	B-Indicator
is	O
removed	O
,	O
brother.apk	B-Indicator
reinstalls	O
it	O
from	O
a	O
META-INF/brother	O
file	O
boy	O
,	O
post.sh	B-Indicator
:	O
The	O
shell	O
scripts	O
u	O
sed	O
for	O
application	O
persistency	O
.	O

Application	O
lifecycle	O
Application	O
Lifecycle	O
Google	B-System
Bouncer	I-System
Bypass	O
On	O
start	O
,	O
the	O
application	O
checks	O
if	O
it	O
is	O
executed	O
on	O
one	O
of	O
the	O
Google	O
servers	O
:	O
IP	O
ranges	O
209.85.128.0-209.85.255.255	B-Indicator
,	O
216.58.192.0-216.58.223.255	B-Indicator
,	O
173.194.0.0-173.194.255.255	B-Indicator
,	O
74.125.0.0-74.125.255.255	B-Indicator
or	O
if	O
it	O
is	O
executed	O
on	O
IP	O
hosted	O
domain	O
that	O
contains	O
the	O
following	O
strings	O
:	O
“	O
google	O
”	O
,	O
”	O
android	B-System
”	O
,	O
”	O
1e100	O
”	O
.	O

If	O
any	O
of	O
these	O
conditions	O
is	O
true	O
,	O
the	O
application	O
does	O
not	O
continue	O
to	O
execute	O
the	O
malicious	O
flow	O
.	O

This	O
method	O
is	O
design	O
to	O
bypass	O
the	O
automatic	O
Google	B-System
Play	I-System
protection	O
mechanism	O
called	O
Bouncer	B-System
.	O

Timebombs	O
,	O
Dynamic	O
Code	O
Loading	O
and	O
Reflection	O
If	O
Google	B-System
Bouncer	I-System
was	O
not	O
detected	O
,	O
the	O
application	O
starts	O
a	O
time	O
bomb	O
which	O
initiates	O
the	O
malicious	O
flow	O
only	O
after	O
20	O
seconds	O
and	O
will	O
run	O
every	O
2	O
hours	O
.	O

The	O
time	O
bomb	O
triggers	O
unpacker	O
thread	O
.	O

Unpacker	O
thread	O
decrypt	O
java	O
archive	O
from	O
assets	O
directory	O
“	O
start.ogg	B-Indicator
”	O
,	O
and	O
dynamically	O
loads	O
it	O
and	O
calls	O
the	O
method	O
“	O
a.a.a.b	O
”	O
from	O
this	O
archive	O
.	O

This	O
method	O
checks	O
if	O
eight	O
hours	O
have	O
passed	O
from	O
the	O
first	O
run	O
of	O
application	O
,	O
and	O
if	O
so	O
,	O
request	O
containing	O
the	O
device	O
’	O
s	O
data	O
to	O
the	O
server	O
.	O

The	O
server	O
sends	O
back	O
encoded	O
json	O
containing	O
URL	O
,	O
class	O
name	O
and	O
method	O
name	O
.	O

Then	O
the	O
application	O
downloads	O
java	O
archive	O
from	O
the	O
URL	O
specified	O
in	O
json	O
,	O
dynamically	O
loads	O
it	O
with	O
class	O
loader	O
API	O
.	O

Once	O
archive	O
is	O
loaded	O
,	O
the	O
application	O
uses	O
reflection	O
api	O
to	O
call	O
methods	O
from	O
the	O
class	O
names	O
specified	O
in	O
the	O
json	O
.	O

Rooting	O
and	O
Ad	O
Network	O
Presentation	O
The	O
reflection	O
loaded	O
methods	O
check	O
if	O
the	O
device	O
is	O
rooted	O
.	O

If	O
not	O
,	O
the	O
application	O
downloads	O
a	O
pack	O
of	O
exploits	O
from	O
the	O
server	O
and	O
runs	O
them	O
one-by-one	O
up	O
until	O
root	O
is	O
achieved	O
.	O

As	O
root	O
,	O
the	O
application	O
copies	O
su	O
binary	O
to	O
/system/bin	O
directory	O
and	O
silently	O
downloads	O
apk	O
file	O
from	O
the	O
server	O
.	O

Then	O
,	O
the	O
APK	O
is	O
installed	O
as	O
system	O
application	O
and	O
registers	O
listener	O
on	O
USER_PRESENT	O
event	O
.	O

This	O
event	O
triggers	O
archive	O
downloading	O
thread	O
.	O

Once	O
the	O
event	O
is	O
triggered	O
,	O
it	O
registers	O
a	O
timer	O
.	O

The	O
timer	O
triggers	O
additional	O
thread	O
which	O
makes	O
a	O
request	O
to	O
the	O
server	O
.	O

It	O
expects	O
a	O
json	O
with	O
url	O
,	O
class	O
and	O
method	O
name	O
.	O

It	O
downloads	O
one	O
more	O
archive	O
and	O
dynamically	O
loads	O
code	O
from	O
it	O
.	O

The	O
final	O
APK	O
is	O
downloaded	O
from	O
a	O
different	O
URL	O
that	O
is	O
currently	O
down	O
,	O
we	O
assume	O
that	O
the	O
apk	O
purpose	O
is	O
overlaying	O
ads	O
on	O
the	O
screen	O
,	O
we	O
assume	O
this	O
based	O
on	O
the	O
research	O
we	O
have	O
done	O
on	O
the	O
API	O
we	O
found	O
which	O
returns	O
URL	O
of	O
random	O
APK	O
file	O
containing	O
different	O
advertising	O
networks	O
.	O

Persistency	O
Watch-Dog	O
The	O
application	O
contains	O
protection	O
against	O
its	O
own	O
removal	O
.	O

As	O
outlined	O
in	O
the	O
diagram	O
above	O
,	O
It	O
installs	O
an	O
additional	O
application	O
with	O
the	O
same	O
functionality	O
and	O
these	O
two	O
applications	O
monitor	O
the	O
removal	O
of	O
each	O
other	O
.	O

If	O
one	O
of	O
the	O
applications	O
is	O
deleted	O
,	O
the	O
second	O
application	O
downloads	O
and	O
re-installs	O
the	O
removed	O
one	O
.	O

Network	O
activity	O
BrainTest	O
communicates	O
with	O
five	O
servers	O
:	O
APK	O
files	O
provider	O
(	O
http	B-Indicator
:	I-Indicator
//psserviceonline	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/	I-Indicator
)	I-Indicator
:	O
This	O
server	O
provides	O
APK	O
files	O
with	O
advertising	O
network	O
.	O

We	O
found	O
two	O
functions	O
:	O
The	O
first	O
function	O
is	O
http	B-Indicator
:	I-Indicator
//s.psserviceonline	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/api/s2s/tracks/	I-Indicator
and	O
is	O
used	O
for	O
activation	O
.	O

The	O
second	O
function	O
is	O
http	B-Indicator
:	I-Indicator
//s.psserviceonline	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com/api/ads/	I-Indicator
which	O
is	O
used	O
for	O
obtaining	O
a	O
link	O
to	O
APK	O
file	O
.	O

Regardless	O
of	O
the	O
parameters	O
,	O
it	O
returns	O
a	O
json	O
containing	O
a	O
link	O
for	O
APK	O
file	O
.	O

File	O
Server	O
(	O
http	B-Indicator
:	I-Indicator
//www.psservicedl	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
)	O
:	O
Contains	O
android	B-System
packages	O
,	O
java	O
archives	O
and	O
zip	O
archives	O
with	O
exploits	O
Archive	O
Link	O
domains	O
:	O
Three	O
domains	O
with	O
the	O
same	O
functionality	O
,	O
but	O
the	O
application	O
chooses	O
one	O
of	O
them	O
to	O
send	O
request	O
for	O
archive	O
link	O
.	O

http	B-Indicator
:	I-Indicator
//www.himobilephone	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
http	B-Indicator
:	I-Indicator
//www.adsuperiorstore	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
http	B-Indicator
:	I-Indicator
//www.i4vip	I-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
Counter	O
Measures	O
Use	O
an	O
up	O
to	O
date	O
anti-malware	O
software	O
that	O
is	O
capable	O
of	O
identifying	O
this	O
threat	O
.	O

If	O
the	O
threat	O
reappears	O
on	O
the	O
device	O
after	O
the	O
first	O
installation	O
,	O
it	O
means	O
that	O
the	O
malware	O
managed	O
to	O
install	O
the	O
persistency	O
module	O
in	O
the	O
System	O
directory	O
.	O

In	O
this	O
case	O
,	O
the	O
device	O
should	O
be	O
re-flashed	O
with	O
an	O
official	O
ROM	O
.	O

Lookout	B-Organization
Discovers	O
Phishing	O
Sites	O
Distributing	O
New	O
IOS	B-System
And	O
Android	B-System
Surveillanceware	B-Malware
April	O
8	O
,	O
2019	O
For	O
the	O
past	O
year	O
,	O
Lookout	B-Organization
researchers	O
have	O
been	O
tracking	O
Android	B-System
and	O
iOS	B-System
surveillanceware	B-Malware
,	O
that	O
can	O
exfiltrate	O
contacts	O
,	O
audio	O
recordings	O
,	O
photos	O
,	O
location	O
,	O
and	O
more	O
from	O
devices	O
.	O

As	O
has	O
been	O
previously	O
reported	O
,	O
some	O
versions	O
of	O
the	O
Android	B-System
malware	O
were	O
present	O
in	O
the	O
Google	B-System
Play	I-System
Store	I-System
.	O

The	O
iOS	B-System
versions	O
were	O
available	O
outside	O
the	O
app	B-System
store	I-System
,	O
through	O
phishing	O
sites	O
,	O
and	O
abused	O
the	O
Apple	B-Organization
Developer	I-Organization
Enterprise	I-Organization
program	O
.	O

Background	O
:	O
Android	B-System
surveillanceware	O
Early	O
last	O
year	O
,	O
Lookout	B-Organization
discovered	O
a	O
sophisticated	O
Android	B-System
surveillanceware	O
agent	O
that	O
appears	O
to	O
have	O
been	O
created	O
for	O
the	O
lawful	O
intercept	O
market	O
.	O

The	O
agent	O
appears	O
to	O
have	O
been	O
under	O
development	O
for	O
at	O
least	O
five	O
years	O
and	O
consists	O
of	O
three	O
stages	O
.	O

First	O
,	O
there	O
is	O
a	O
small	O
dropper	O
,	O
then	O
a	O
large	O
second	O
stage	O
payload	O
that	O
contains	O
multiple	O
binaries	O
(	O
where	O
most	O
of	O
the	O
surveillance	O
functionality	O
is	O
implemented	O
)	O
,	O
and	O
finally	O
a	O
third	O
stage	O
which	O
typically	O
uses	O
the	O
DirtyCOW	B-Vulnerability
exploit	I-Vulnerability
(	O
CVE-2016-5195	B-Vulnerability
)	O
to	O
obtain	O
root	O
.	O

Security	B-Organization
Without	I-Organization
Borders	I-Organization
has	O
recently	O
published	O
an	O
analysis	O
of	O
this	O
family	O
,	O
independently	O
,	O
through	O
their	O
blog	O
.	O

Several	O
technical	O
details	O
indicated	O
that	O
the	O
software	O
was	O
likely	O
the	O
product	O
of	O
a	O
well-funded	O
development	O
effort	O
and	O
aimed	O
at	O
the	O
lawful	O
intercept	O
market	O
.	O

These	O
included	O
the	O
use	O
of	O
certificate	O
pinning	O
and	O
public	O
key	O
encryption	O
for	O
C2	O
communications	O
,	O
geo-restrictions	O
imposed	O
by	O
the	O
C2	O
when	O
delivering	O
the	O
second	O
stage	O
,	O
and	O
the	O
comprehensive	O
and	O
well	O
implemented	O
suite	O
of	O
surveillance	O
features	O
.	O

Early	O
versions	O
of	O
the	O
Android	B-System
application	O
used	O
infrastructure	O
which	O
belonged	O
to	O
a	O
company	O
named	O
Connexxa	B-Organization
S.R.L	I-Organization
.	I-Organization

and	O
were	O
signed	O
using	O
the	O
name	O
of	O
an	O
engineer	O
who	O
appears	O
to	O
hold	O
equity	O
in	O
Connexxa	B-Organization
.	O

This	O
engineer	O
’	O
s	O
name	O
is	O
also	O
associated	O
with	O
a	O
company	O
called	O
eSurv	B-Organization
S.R.L	I-Organization
.	I-Organization

eSurv	B-Organization
’	O
s	O
public	O
marketing	O
is	O
centered	O
around	O
video	O
surveillance	O
software	O
and	O
image	O
recognition	O
systems	O
,	O
but	O
there	O
are	O
a	O
number	O
of	O
individuals	O
claiming	O
to	O
be	O
mobile	O
security	O
researchers	O
working	O
at	O
the	O
company	O
,	O
including	O
one	O
who	O
has	O
publically	O
made	O
claims	O
to	O
be	O
developing	O
a	O
mobile	O
surveillance	O
agent	O
.	O

Moreover	O
,	O
eSurv	B-Organization
was	O
a	O
business	O
unit	O
of	O
Connexxa	B-Organization
and	O
was	O
leased	O
to	O
eSurv	B-Organization
S.R.L	I-Organization
in	O
2014	O
.	O

This	O
business	O
unit	O
and	O
the	O
eSurv	B-Organization
software	O
and	O
brand	O
was	O
sold	O
from	O
Connexxa	B-Organization
S.R.L	I-Organization
.	I-Organization

to	O
eSurv	B-Organization
S.R.L	I-Organization
.	I-Organization

on	O
Feb	O
28	O
,	O
2016	O
.	O

Lookout	B-Organization
notified	O
Google	B-Organization
of	O
the	O
potential	O
threat	O
shortly	O
after	O
it	O
was	O
discovered	O
.	O

Together	O
,	O
during	O
the	O
latter	O
half	O
of	O
2018	O
,	O
we	O
worked	O
to	O
remove	O
the	O
apps	O
from	O
the	O
Play	B-System
store	I-System
while	O
it	O
was	O
being	O
deployed	O
in	O
the	O
wild	O
.	O

iOS	B-System
development	O
Analysis	O
of	O
these	O
Android	B-System
samples	O
led	O
to	O
the	O
discovery	O
of	O
infrastructure	O
that	O
contained	O
several	O
samples	O
of	O
an	O
iOS	B-System
port	O
.	O

So	O
far	O
,	O
this	O
software	O
(	O
along	O
with	O
the	O
Android	B-System
version	O
)	O
has	O
been	O
made	O
available	O
through	O
phishing	O
sites	O
that	O
imitated	O
Italian	O
and	O
Turkmenistani	O
mobile	O
carriers	O
.	O

Wind	B-Organization
Tre	I-Organization
SpA	I-Organization
-	O
an	O
Italian	O
telecom	O
operator	O
TMCell	B-Organization
-	O
the	O
state	O
owned	O
mobile	O
operator	O
in	O
Turkmenistan	O
Deployment	O
to	O
users	O
outside	O
Apple	B-Organization
’	O
s	O
app	O
store	O
was	O
made	O
possible	O
through	O
abuse	O
of	O
Apple	B-Organization
’	O
s	O
enterprise	O
provisioning	O
system	O
.	O

The	O
Apple	B-Organization
Developer	I-Organization
Enterprise	I-Organization
program	O
is	O
intended	O
to	O
allow	O
organizations	O
to	O
distribute	O
proprietary	O
,	O
in-house	O
apps	O
to	O
their	O
employees	O
without	O
needing	O
to	O
use	O
the	O
iOS	B-System
App	B-System
Store	I-System
.	O

A	O
business	O
can	O
obtain	O
access	O
to	O
this	O
program	O
only	O
provided	O
they	O
meet	O
requirements	O
set	O
out	O
by	O
Apple	B-Organization
.	O

It	O
is	O
not	O
common	O
to	O
use	O
this	O
program	O
to	O
distribute	O
malware	O
,	O
although	O
there	O
have	O
been	O
past	O
cases	O
where	O
malware	O
authors	O
have	O
done	O
so	O
.	O

Each	O
of	O
the	O
phishing	O
sites	O
contained	O
links	O
to	O
a	O
distribution	O
manifest	O
,	O
which	O
contained	O
metadata	O
such	O
as	O
the	O
application	O
name	O
,	O
version	O
,	O
icon	O
,	O
and	O
a	O
URL	O
for	O
the	O
IPA	O
file	O
.	O

To	O
be	O
distributed	O
outside	O
the	O
app	O
store	O
,	O
an	O
IPA	O
package	O
must	O
contain	O
a	O
mobile	O
provisioning	O
profile	O
with	O
an	O
enterprise	O
’	O
s	O
certificate	O
.	O

All	O
these	O
packages	O
used	O
provisioning	O
profiles	O
with	O
distribution	O
certificates	O
associated	O
with	O
the	O
company	O
Connexxa	B-Organization
S.R.L	I-Organization
.	I-Organization

Certificate	O
Used	O
The	O
apps	O
themselves	O
pretended	O
to	O
be	O
carrier	O
assistance	O
apps	O
which	O
instructed	O
the	O
user	O
to	O
“	O
keep	O
the	O
app	O
installed	O
on	O
your	O
device	O
and	O
stay	O
under	O
Wi-Fi	O
coverage	O
to	O
be	O
contacted	O
by	O
one	O
of	O
our	O
operators	O
”	O
.	O

One	O
of	O
the	O
packages	O
after	O
initial	O
launch	O
The	O
iOS	B-System
variant	O
is	O
not	O
as	O
sophisticated	O
as	O
the	O
Android	B-System
version	O
,	O
and	O
contained	O
a	O
subset	O
of	O
the	O
functionality	O
the	O
Android	B-System
releases	O
offered	O
.	O

In	O
particular	O
,	O
these	O
packages	O
have	O
not	O
been	O
observed	O
to	O
contain	O
or	O
to	O
download	O
exploits	O
which	O
would	O
be	O
required	O
to	O
perform	O
certain	O
types	O
of	O
activities	O
on	O
iOS	B-System
devices	O
.	O

Even	O
without	O
capabilities	O
to	O
exploit	O
a	O
device	O
,	O
the	O
packages	O
were	O
able	O
to	O
exfiltrate	O
the	O
following	O
types	O
of	O
data	O
using	O
documented	O
APIs	O
:	O
Contacts	O
Audio	O
recordings	O
Photos	O
Videos	O
GPS	B-System
location	O
Device	O
information	O
In	O
addition	O
,	O
the	O
packages	O
offered	O
a	O
feature	O
to	O
perform	O
remote	O
audio	O
recording	O
.	O

Though	O
different	O
versions	O
of	O
the	O
app	O
vary	O
in	O
structure	O
,	O
malicious	O
code	O
was	O
initialized	O
at	O
application	O
launch	O
without	O
the	O
user	O
’	O
s	O
knowledge	O
,	O
and	O
a	O
number	O
of	O
timers	O
were	O
setup	O
to	O
gather	O
and	O
upload	O
data	O
periodically	O
.	O

Upload	O
data	O
was	O
queued	O
and	O
transmitted	O
via	O
HTTP	B-Indicator
PUT	O
requests	O
to	O
an	O
endpoint	O
on	O
the	O
C2	O
.	O

The	O
iOS	B-System
apps	O
leverage	O
the	O
same	O
C2	O
infrastructure	O
as	O
the	O
Android	B-System
version	O
and	O
use	O
similar	O
communications	O
protocols	O
.	O

Push	O
notifications	O
were	O
also	O
used	O
to	O
control	O
audio	O
recording	O
.	O

Lookout	B-Organization
has	O
shared	O
information	O
about	O
this	O
family	O
with	O
Apple	B-Organization
,	O
and	O
they	O
have	O
revoked	O
the	O
affected	O
certificates	O
.	O

As	O
a	O
result	O
,	O
no	O
new	O
instances	O
of	O
this	O
app	O
can	O
be	O
installed	O
on	O
iOS	B-System
devices	O
and	O
existing	O
installations	O
can	O
no	O
longer	O
be	O
run	O
.	O

Lookout	B-Organization
customers	O
are	O
also	O
protected	O
from	O
this	O
threat	O
on	O
both	O
Android	B-System
and	O
iOS	B-System
.	O

Android	B-System
Trojan	O
Found	O
in	O
Targeted	O
Attack	O
26	O
MAR	O
2013	O
In	O
the	O
past	O
,	O
we	O
’	O
ve	O
seen	O
targeted	O
attacks	O
against	O
Tibetan	O
and	O
Uyghur	O
activists	O
on	O
Windows	B-System
and	O
Mac	B-System
OS	I-System
X	I-System
platforms	O
.	O

We	O
’	O
ve	O
documented	O
several	O
interesting	O
attacks	O
(	O
A	O
Gift	O
for	O
Dalai	O
Lamas	O
Birthday	O
and	O
Cyber	O
Attacks	O
Against	O
Uyghur	O
Mac	B-System
OS	I-System
X	I-System
Users	O
Intensify	O
)	O
which	O
used	O
ZIP	O
files	O
as	O
well	O
as	O
DOC	O
,	O
XLS	O
and	O
PDF	O
documents	O
rigged	O
with	O
exploits	O
.	O

Several	O
days	O
ago	O
,	O
the	O
e-mail	O
account	O
of	O
a	O
high-profile	O
Tibetan	O
activist	O
was	O
hacked	O
and	O
used	O
to	O
send	O
targeted	O
attacks	O
to	O
other	O
activists	O
and	O
human	O
rights	O
advocates	O
.	O

Perhaps	O
the	O
most	O
interesting	O
part	O
is	O
that	O
the	O
attack	O
e-mails	O
had	O
an	O
APK	O
attachment	O
–	O
a	O
malicious	O
program	O
for	O
Android	B-System
.	O

The	O
attack	O
On	O
March	O
24th	O
,	O
2013	O
,	O
the	O
e-mail	O
account	O
of	O
a	O
high-profile	O
Tibetan	O
activist	O
was	O
hacked	O
and	O
used	O
to	O
send	O
spear	O
phishing	O
e-mails	O
to	O
their	O
contact	O
list	O
.	O

This	O
is	O
what	O
the	O
spear	O
phishing	O
e-mail	O
looked	O
like	O
:	O
In	O
regards	O
to	O
the	O
message	O
text	O
above	O
,	O
multiple	O
activist	O
groups	O
have	O
recently	O
organized	O
a	O
human	O
rights	O
conference	O
event	O
in	O
Geneva	O
.	O

We	O
’	O
ve	O
noticed	O
an	O
increase	O
in	O
the	O
number	O
of	O
attacks	O
using	O
this	O
event	O
as	O
a	O
lure	O
.	O

Here	O
’	O
s	O
another	O
example	O
of	O
such	O
an	O
attack	O
hitting	O
Windows	B-System
users	O
:	O
Going	O
back	O
to	O
the	O
Android	B-System
Package	I-System
(	O
APK	O
)	O
file	O
was	O
attached	O
to	O
the	O
e-mail	O
,	O
this	O
is	O
pushing	O
an	O
Android	O
application	O
named	O
“	O
WUC	B-Malware
’	I-Malware
s	I-Malware
Conference.apk	I-Malware
”	O
.	O

This	O
malicious	O
APK	O
is	O
334326	O
bytes	O
file	O
,	O
MD5	O
:	O
0b8806b38b52bebfe39ff585639e2ea2	B-Indicator
and	O
is	O
detected	O
by	O
Kaspersky	B-Organization
Lab	I-Organization
products	O
as	O
“	O
Backdoor.AndroidOS.Chuli.a	B-Indicator
”	O
.	O

After	O
the	O
installation	O
,	O
an	O
application	O
named	O
“	O
Conference	O
”	O
appears	O
on	O
the	O
desktop	O
:	O
If	O
the	O
victim	O
launches	O
this	O
app	O
,	O
he	O
will	O
see	O
text	O
which	O
“	O
enlightens	O
”	O
the	O
information	O
about	O
the	O
upcoming	O
event	O
:	O
The	O
full	O
text	O
reads	O
follows	O
.	O

Notice	O
notice	O
the	O
use	O
of	O
the	O
mistaken	O
“	O
Word	O
”	O
instead	O
of	O
“	O
World	O
”	O
:	O
“	O
On	O
behalf	O
of	O
all	O
at	O
the	O
Word	B-Organization
Uyghur	I-Organization
Congress	I-Organization
(	I-Organization
WUC	I-Organization
)	I-Organization
,	O
the	O
Unrepresented	B-Organization
Nations	I-Organization
and	I-Organization
Peoples	I-Organization
Organization	I-Organization
(	I-Organization
UNPO	I-Organization
)	I-Organization
and	O
the	O
Society	B-Organization
for	I-Organization
Threatened	I-Organization
Peoples	I-Organization
(	I-Organization
STP	I-Organization
)	I-Organization
,	O
Human	O
Rights	O
in	O
China	O
:	O
Implications	O
for	O
East	O
Turkestan	O
,	O
Tibet	O
and	O
Southern	O
Mongolia	O
In	O
what	O
was	O
an	O
unprecedented	O
coming-together	O
of	O
leading	O
Uyghur	O
,	O
Mongolian	O
,	O
Tibetan	O
and	O
Chinese	O
activists	O
,	O
as	O
well	O
as	O
other	O
leading	O
international	O
experts	O
,	O
we	O
were	O
greatly	O
humbled	O

by	O
the	O
great	O
enthusiasm	O
,	O
contribution	O
and	O
desire	O
from	O
all	O
in	O
attendance	O
to	O
make	O
this	O
occasion	O
something	O
meaningful	O
,	O
the	O
outcome	O
of	O
which	O
produced	O
some	O
concrete	O
,	O
action-orientated	O
solutions	O
to	O
our	O
shared	O
grievances	O
.	O

We	O
are	O
especially	O
delighted	O
about	O
the	O
platform	O
and	O
programme	O
of	O
work	O
established	O
in	O
the	O
declaration	O
of	O
the	O
conference	O
,	O
upon	O
which	O
we	O
sincerely	O
hope	O
will	O
be	O
built	O
a	O
strong	O
and	O
resolute	O
working	O
relationship	O
on	O
our	O
shared	O
goals	O
for	O
the	O
future	O
.	O

With	O
this	O
in	O
mind	O
,	O
we	O
thoroughly	O
look	O
forward	O
to	O
working	O
with	O
you	O
on	O
these	O
matters	O
.	O

Dolkun	O
lsa	O
Chairman	O
of	O
the	O
Executive	B-Organization
Committee	I-Organization
Word	I-Organization
Uyghur	I-Organization
Congress	I-Organization
”	O
While	O
the	O
victim	O
reads	O
this	O
fake	O
message	O
,	O
the	O
malware	O
secretly	O
reports	O
the	O
infection	O
to	O
a	O
command-and-control	O
server	O
.	O

After	O
that	O
,	O
it	O
begins	O
to	O
harvest	O
information	O
stored	O
on	O
the	O
device	O
.	O

The	O
stolen	O
data	O
includes	O
:	O
Contacts	O
(	O
stored	O
both	O
on	O
the	O
phone	O
and	O
the	O
SIM	O
card	O
)	O
.	O

Call	O
logs	O
.	O

SMS	O
messages	O
.	O

Geo-location	O
.	O

Phone	O
data	O
(	O
phone	O
number	O
,	O
OS	O
version	O
,	O
phone	O
model	O
,	O
SDK	O
version	O
)	O
.	O

It	O
is	O
important	O
to	O
note	O
that	O
the	O
data	O
won	O
’	O
t	O
be	O
uploaded	O
to	O
C	O
&	O
C	O
server	O
automatically	O
.	O

The	O
Trojan	O
waits	O
for	O
incoming	O
SMS	O
messages	O
(	O
the	O
“	O
alarmReceiver.class	B-Indicator
”	O
)	O
and	O
checks	O
whether	O
these	O
messages	O
contain	O
one	O
of	O
the	O
following	O
commands	O
:	O
“	O
sms	O
”	O
,	O
“	O
contact	O
”	O
,	O
“	O
location	O
”	O
,	O
“	O
other	O
”	O
.	O

If	O
one	O
these	O
commands	O
is	O
found	O
,	O
then	O
the	O
malware	O
will	O
encode	O
the	O
stolen	O
data	O
with	O
Base64	O
and	O
upload	O
it	O
to	O
the	O
command	O
and	O
control	O
server	O
.	O

The	O
C2	O
URL	O
is	O
:	O
hxxp	B-Indicator
:	I-Indicator
//64.78.161.133/	I-Indicator
*	I-Indicator
victims	I-Indicator
’	I-Indicator
s_cell_phone_number	I-Indicator
*	I-Indicator
/process.php	I-Indicator
In	O
addition	O
to	O
this	O
,	O
the	O
malware	O
also	O
reports	O
to	O
another	O
script	O
,	O
“	O
hxxp	B-Indicator
:	I-Indicator
//64.78.161.33/android.php	I-Indicator
”	O
.	O

First	O
,	O
it	O
will	O
get	O
the	O
“	O
nativenumber	O
”	O
variable	O
from	O
the	O
“	O
telmark	O
”	O
value	O
of	O
“	O
AndroidManifest.xml	B-System
”	O
.	O

This	O
is	O
hardcoded	O
and	O
equals	O
“	O
phone	O
”	O
.	O

Then	O
,	O
it	O
will	O
add	O
the	O
result	O
of	O
the	O
public	O
method	O
localDate.getTime	O
(	O
)	O
,	O
which	O
simply	O
gets	O
the	O
current	O
date	O
.	O

An	O
example	O
of	O
the	O
string	O
which	O
is	O
sent	O
to	O
the	O
command-and-control	O
would	O
be	O
“	O
phone	O
26.03.2013	O
”	O
.	O

It	O
is	O
interesting	O
that	O
the	O
attackers	O
used	O
Java	O
Base64	O
library	O
developed	O
by	O
Sauron	B-Organization
Software	I-Organization
.	O

This	O
software	O
is	O
free	O
and	O
distributed	O
under	O
LGPL	O
license	O
.	O

Also	O
,	O
command	O
communications	O
with	O
the	O
malware	O
are	O
parsed	O
with	O
a	O
function	O
named	O
“	O
chuli	O
(	O
)	O
”	O
prior	O
to	O
POSTing	O
stolen	O
data	O
to	O
the	O
command-and-control	O
server	O
.	O

It	O
appears	O
that	O
the	O
attackers	O
are	O
somewhat	O
familiar	O
with	O
the	O
language	O
and	O
mountain-trekking	O
culture	O
of	O
the	O
targets	O
–	O
the	O
meaning	O
of	O
“	O
chuli	O
”	O
is	O
“	O
summit	O
”	O
:	O
The	O
command-and-control	O
server	O
and	O
parameters	O
can	O
be	O
easily	O
seen	O
in	O
the	O
decompiled	O
source	O
code	O
:	O
Command	O
and	O
control	O
server	O
interaction	O
code	O
Throughout	O
the	O
code	O
,	O
the	O
attackers	O
log	O
all	O
important	O
actions	O
,	O
which	O
include	O
various	O
messages	O
in	O
Chinese	O
.	O

This	O
was	O
probably	O
done	O
for	O
debugging	O
purposes	O
,	O
indicating	O
the	O
malware	O
may	O
be	O
an	O
early	O
prototype	O
version	O
.	O

Some	O
actions	O
include	O
(	O
with	O
rough	O
translations	O
)	O
:	O
The	O
command-and-control	O
server	O
The	O
command-and-control	O
server	O
is	O
located	O
at	O
IP	O
64.78.161.133	B-Indicator
.	O

This	O
IP	O
is	O
located	O
in	O
Los	O
Angeles	O
,	O
U.S.A.	O
,	O
at	O
a	O
hosting	O
company	O
named	O
“	O
Emagine	B-Organization
Concept	I-Organization
Inc	I-Organization
”	O
.	O

Interestingly	O
,	O
there	O
is	O
a	O
domain	O
which	O
used	O
to	O
point	O
there	O
,	O
“	O
DlmDocumentsExchange.com	B-Indicator
”	O
.	O

The	O
domain	O
was	O
registered	O
on	O
March	O
8th	O
,	O
2013	O
:	O
Registration	O
Service	O
Provided	O
By	O
:	O
SHANGHAI	B-Organization
MEICHENG	I-Organization
TECHNOLOGY	I-Organization
INFORMATION	I-Organization
DEVELOPMENT	I-Organization
CO.	I-Organization
,	I-Organization
LTD.	I-Organization
Domain	O
Name	O
:	O
DLMDOCUMENTSEXCHANGE.COM	B-Indicator
Registration	O
Date	O
:	O
08-Mar-2013	O
Expiration	O
Date	O
:	O
08-Mar-2014	O
Status	O
:	O
LOCKED	O
The	O
domain	O
registration	O
data	O
indicates	O
the	O
following	O
owner	O
:	O
Registrant	O
Contact	O
Details	O
:	O
peng	O
jia	O
peng	O
jia	O
(	O
bdoufwke123010	B-Indicator
@	I-Indicator
gmail.com	I-Indicator
)	O
beijingshiahiidienquc.d	B-Indicator
beijingshi	O
beijing,100000	O

CN	O
Tel	O
.	O

+86.01078456689	O
Fax	O
.	O

+86.01078456689	O
The	O
command-and-control	O
server	O
is	O
hosting	O
an	O
index	O
page	O
which	O
also	O
serves	O
an	O
APK	O
file	O
:	O
The	O
referenced	O
“	O
Document.apk	B-Indicator
”	O
is	O
333583	O
bytes	O
in	O
size	O
,	O
MD5	O
:	O
c4c4077e9449147d754afd972e247efc	B-Indicator
.	O

It	O
has	O
the	O
same	O
functionality	O
as	O
the	O
one	O
described	O
above	O
but	O
contains	O
different	O
text	O
.	O

The	O
new	O
text	O
(	O
in	O
Chinese	O
,	O
about	O
relations	O
between	O
China	O
,	O
Japan	O
and	O
the	O
disputed	O
“	O
Senkaku	O
Islands	O
/	O
Diaoyudao	O
Islands	O
/	O
Diaoyutai	O
Islands	O
”	O
)	O
is	O
shown	O
to	O
the	O
victims	O
and	O
reads	O
as	O
following	O
:	O
When	O
opened	O
in	O
a	O
browser	O
,	O
this	O
is	O
what	O
the	O
command-and-control	O
index	O
page	O
looks	O
like	O
:	O
The	O
text	O
on	O
the	O
top	O
means	O
“	O
Title	O
Title	O
Title	O
”	O
in	O
Chinese	O
,	O
while	O
the	O
other	O
strings	O
appear	O
to	O
be	O
random	O
characters	O
typed	O
from	O
the	O
keyboard	O
.	O

Interestingly	O
,	O
the	O
command	O
and	O
control	O
server	O
includes	O
a	O
publicly	O
accessible	O
interface	O
to	O
work	O
with	O
the	O
victims	O
:	O
Some	O
of	O
the	O
commands	O
with	O
rough	O
translations	O
:	O
The	O
command-and-control	O
server	O
is	O
running	O
Windows	B-System
Server	I-System
2003	O
and	O
has	O
been	O
configured	O
for	O
Chinese	O
language	O
:	O
This	O
,	O
together	O
with	O
the	O
logs	O
,	O
is	O
a	O
strong	O
indicator	O
that	O
the	O
attackers	O
are	O
Chinese-speaking	O
.	O

Conclusions	O
Every	O
day	O
,	O
there	O
are	O
hundreds	O
if	O
not	O
thousands	O
of	O
targeted	O
attacks	O
against	O
Tibetan	O
and	O
Uyghur	O
supporters	O
.	O

The	O
vast	O
majority	O
of	O
these	O
target	O
Windows	B-System
machines	O
through	O
Word	B-System
documents	O
exploiting	O
known	O
vulnerabilities	O
such	O
as	O
CVE-2012-0158	B-Vulnerability
,	O
CVE-2010-3333	B-Vulnerability
and	O
CVE-2009-3129	B-Vulnerability
.	O

In	O
this	O
case	O
,	O
the	O
attackers	O
hacked	O
a	O
Tibetan	O
activist	O
’	O
s	O
account	O
and	O
used	O
it	O
to	O
attack	O
Uyghur	O
activists	O
.	O

It	O
indicates	O
perhaps	O
an	O
interesting	O
trend	O
which	O
is	O
exploiting	O
the	O
trust	O
relationships	O
between	O
the	O
two	O
communities	O
.	O

This	O
technique	O
reminds	O
us	O
of	O
a	O
combination	O
between	O
ages	O
old	O
war	O
strategies	O
“	O
Divide	O
et	O
impera	O
”	O
and	O
“	O
By	O
way	O
of	O
deception	O
”	O
.	O

Until	O
now	O
,	O
we	O
haven	O
’	O
t	O
seen	O
targeted	O
attacks	O
against	O
mobile	O
phones	O
,	O
although	O
we	O
’	O
ve	O
seen	O
indications	O
that	O
these	O
were	O
in	O
development	O
.	O

The	O
current	O
attack	O
took	O
advantage	O
of	O
the	O
compromise	O
of	O
a	O
high-profile	O
Tibetan	O
activist	O
.	O

It	O
is	O
perhaps	O
the	O
first	O
in	O
a	O
new	O
wave	O
of	O
targeted	O
attacks	O
aimed	O
at	O
Android	B-System
users	O
.	O

So	O
far	O
,	O
the	O
attackers	O
relied	O
entirely	O
on	O
social	O
engineering	O
to	O
infect	O
the	O
targets	O
.	O

History	O
has	O
shown	O
us	O
that	O
,	O
in	O
time	O
,	O
these	O
attacks	O
will	O
use	O
zero-day	B-Vulnerability
vulnerabilities	I-Vulnerability
,	O
exploits	O
or	O
a	O
combination	O
of	O
techniques	O
.	O

For	O
now	O
,	O
the	O
best	O
protection	O
is	O
to	O
avoid	O
any	O
APK	O
attachments	O
that	O
arrive	O
on	O
mobile	O
phones	O
via	O
e-mail	O
.	O

We	O
detect	O
the	O
malware	O
used	O
in	O
this	O
attack	O
as	O
“	O
Backdoor.AndroidOS.Chuli.a	B-Malware
”	O
.	O

MD5s	O
:	O
c4c4077e9449147d754afd972e247efc	B-Indicator
Document.apk	B-Indicator
0b8806b38b52bebfe39ff585639e2ea2	B-Indicator
WUC	O
’	O
s	O
Conference.apk	B-Indicator
Triada	B-Malware
:	O
organized	O
crime	O
on	O
Android	B-System
Triada	B-Malware
is	O
a	O
modular	O
mobile	O
Trojan	O
that	O
actively	O
uses	O
root	O
privileges	O
to	O
substitute	O
system	O
files	O
and	O
uses	O
several	O
clever	O
methods	O
to	O
become	O
almost	O
invisible	O
March	O
3	O
,	O
2016	O
You	O
know	O
how	O
armies	O
typically	O
move	O
:	O
first	O
come	O
the	O
scouts	O
to	O
make	O
sure	O
everything	O
is	O
ok.	O
Then	O
the	O
heavy	O
troops	O

arrive	O
;	O
at	O
least	O
that	O
was	O
how	O
it	O
used	O
to	O
be	O
before	O
the	O
age	O
of	O
cyber	O
wars	O
.	O

It	O
turns	O
out	O
,	O
that	O
Trojans	O
behave	O
quite	O
the	O
same	O
way	O
.	O

There	O
are	O
a	O
lot	O
of	O
small	O
Trojans	O
for	O
Android	B-System
capable	O
of	O
leveraging	O
access	O
privileges	O
,	O
in	O
other	O
words	O
—	O
gaining	O
root	O
access	O
.	O

Our	O
malware	O
analysts	O
Nikita	O
Buchka	O
and	O
Mikhail	O
Kuzin	O
can	O
easily	O
name	O
11	O
families	O
of	O
such	O
Trojans	O
.	O

Most	O
of	O
them	O
are	O
almost	O
harmless	O
—	O
all	O
they	O
did	O
until	O
recently	O
was	O
injecting	O
tons	O
of	O
ads	O
and	O
downloading	O
others	O
of	O
their	O
kind	O
.	O

If	O
you	O
want	O
to	O
know	O
more	O
about	O
them	O
—	O
our	O
researchers	O
have	O
an	O
article	O
about	O
them	O
on	O
Securelist	B-Organization
.	O

If	O
you	O
follow	O
the	O
military	O
analogy	O
—	O
those	O
are	O
the	O
scouts	O
.	O

As	O
you	O
probably	O
have	O
noticed	O
,	O
gaining	O
root	O
access	O
gives	O
them	O
the	O
capability	O
to	O
download	O
and	O
install	O
applications	O
—	O
that	O
’	O
s	O
the	O
reason	O
why	O
once	O
one	O
of	O
them	O
get	O
into	O
the	O
system	O
,	O
in	O
a	O
few	O
minutes	O
there	O
are	O
all	O
the	O
others	O
.	O

But	O
our	O
researchers	O
have	O
predicted	O
that	O
these	O
small	O
Trojans	O
would	O
certainly	O
be	O
used	O
to	O
download	O
some	O
really	O
bad	O
malware	O
that	O
can	O
actually	O
harm	O
the	O
owners	O
of	O
the	O
infected	O
devices	O
.	O

And	O
that	O
’	O
s	O
exactly	O
what	O
has	O
happened	O
recently	O
.	O

Small	O
Trojans	O
like	O
Leech	B-Malware
,	O
Ztorg	B-Malware
and	O
Gopro	B-Malware
now	O
download	O
one	O
of	O
the	O
most	O
advanced	O
mobile	O
Trojans	O
our	O
malware	O
analysts	O
have	O
ever	O
encountered	O
—	O
we	O
call	O
it	O
Triada	B-Malware
.	O

Triada	B-Malware
is	O
a	O
modular	O
mobile	O
Trojan	O
that	O
actively	O
uses	O
root	O
privileges	O
to	O
substitute	O
system	O
files	O
and	O
exists	O
mostly	O
in	O
the	O
device	O
’	O
s	O
RAM	O
,	O
which	O
makes	O
it	O
extremely	O
hard	O
to	O
detect	O
.	O

The	O
dark	O
ways	O
of	O
the	O
Triada	B-Malware
Once	O
downloaded	O
and	O
installed	O
,	O
the	O
Triada	B-Malware
Trojan	O
first	O
tries	O
to	O
collect	O
some	O
information	O
about	O
the	O
system	O
—	O
like	O
the	O
device	O
model	O
,	O
the	O
OS	O
version	O
,	O
the	O
amount	O
of	O
the	O
SD	O
card	O
space	O
,	O
the	O
list	O
of	O
the	O
installed	O
applications	O
and	O
other	O
things	O
.	O

Then	O
it	O
sends	O
all	O
that	O
information	O
to	O
the	O
Command	O
&	O
Control	O
server	O
.	O

We	O
have	O
detected	O
a	O
total	O
of	O
17	O
C	O
&	O
C	O
servers	O
on	O
4	O
different	O
domains	O
,	O
which	O
probably	O
means	O
the	O
bad	O
guys	O
are	O
quite	O
familiar	O
with	O
what	O
redundancy	O
is	O
.	O

The	O
C	O
&	O
C	O
server	O
then	O
responds	O
with	O
a	O
configuration	O
file	O
,	O
containing	O
the	O
personal	O
identification	O
number	O
for	O
the	O
device	O
and	O
some	O
settings	O
—	O
the	O
time	O
interval	O
between	O
contacting	O
the	O
server	O
,	O
the	O
list	O
of	O
modules	O
to	O
be	O
installed	O
and	O
so	O
on	O
.	O

After	O
the	O
modules	O
are	O
installed	O
they	O
are	O
deployed	O
to	O
the	O
short	O
term	O
memory	O
and	O
deleted	O
from	O
the	O
device	O
storage	O
,	O
which	O
makes	O
the	O
Trojan	O
a	O
lot	O
harder	O
to	O
catch	O
.	O

There	O
are	O
two	O
more	O
reasons	O
why	O
Triada	B-Malware
is	O
so	O
hard	O
to	O
detect	O
and	O
why	O
it	O
had	O
impressed	O
our	O
researchers	O
so	O
much	O
.	O

First	O
,	O
it	O
modifies	O
the	O
Zygote	B-System
process	O
.	O

Zygote	B-System
is	O
the	O
core	O
process	O
in	O
the	O
Android	B-System
OS	O
that	O
is	O
used	O
as	O
a	O
template	O
for	O
every	O
application	O
,	O
which	O
means	O
that	O
once	O
the	O
Trojan	O
gets	O
into	O
Zygote	B-System
,	O
it	O
becomes	O
a	O
part	O
of	O
literally	O
every	O
app	O
that	O
is	O
launched	O
on	O
the	O
device	O
.	O

Triada	B-Malware
:	O
organized	O
crime	O
on	O
Android	B-System
Second	O
,	O
it	O
substitutes	O
the	O
system	O
functions	O
and	O
conceals	O
its	O
modules	O
from	O
the	O
list	O
of	O
the	O
running	O
processes	O
and	O
installed	O
apps	O
.	O

So	O
the	O
system	O
doesn	O
’	O
t	O
see	O
any	O
strange	O
processes	O
running	O
and	O
thus	O
does	O
not	O
cry	O
the	O
alarm	O
.	O

Those	O
are	O
not	O
the	O
only	O
system	O
functions	O
Triada	B-Malware
modifies	O
.	O

As	O
our	O
researchers	O
discovered	O
,	O
it	O
also	O
lays	O
its	O
hands	O
on	O
the	O
outgoing	O
SMS	O
and	O
filters	O
the	O
incoming	O
ones	O
.	O

That	O
is	O
actually	O
how	O
the	O
bad	O
guys	O
decided	O
to	O
monetize	O
the	O
Trojan	O
.	O

Some	O
applications	O
rely	O
on	O
SMS	O
when	O
it	O
comes	O
to	O
in-app	O
purchases	O
—	O
the	O
transaction	O
data	O
is	O
transferred	O
via	O
a	O
short	O
text	O
message	O
.	O

The	O
main	O
reason	O
for	O
developers	O
to	O
choose	O
SMS	O
over	O
traditional	O
payments	O
via	O
Internet	O
is	O
that	O
in	O
the	O
case	O
with	O
SMS	O
no	O
Internet	O
connection	O
is	O
required	O
.	O

Users	O
do	O
not	O
see	O
those	O
SMS	O
because	O
they	O
are	O
processed	O
not	O
by	O
the	O
SMS	O
app	O
,	O
but	O
by	O
the	O
app	O
that	O
has	O
initiated	O
the	O
transaction	O
—	O
e.g	O
a	O
free-to-play	O
game	O
.	O

Triada	B-Malware
’	O
s	O
functionality	O
allows	O
it	O
to	O
modify	O
those	O
messages	O
,	O
so	O
the	O
money	O
is	O
sent	O
not	O
to	O
some	O
app	O
developer	O
,	O
but	O
to	O
the	O
malware	O
operators	O
.	O

Triada	B-Malware
steals	O
the	O
money	O
either	O
from	O
the	O
users	O
—	O
if	O
they	O
haven	O
’	O
t	O
succeeded	O
in	O
purchasing	O
whatever	O
they	O
wanted	O
,	O
or	O
from	O
the	O
app	O
developers	O
,	O
in	O
case	O
the	O
user	O
has	O
completed	O
the	O
purchase	O
successfully	O
.	O

For	O
now	O
,	O
that	O
is	O
the	O
only	O
way	O
how	O
cybercriminals	O
can	O
profit	O
from	O
Triada	B-Malware
,	O
but	O
don	O
’	O
t	O
forget	O
that	O
it	O
’	O
s	O
a	O
modular	O
Trojan	O
,	O
so	O
it	O
can	O
be	O
turned	O
into	O
literally	O
everything	O
on	O
one	O
command	O
from	O
the	O
C	O
&	O
C	O
server	O
.	O

Fighting	O
organized	O
crime	O
in	O
your	O
phone	O
One	O
of	O
the	O
main	O
problems	O
with	O
Triada	B-Malware
is	O
that	O
it	O
can	O
potentially	O
hurt	O
a	O
LOT	O
of	O
people	O
.	O

As	O
we	O
’	O
ve	O
mentioned	O
earlier	O
,	O
Triada	B-Malware
is	O
downloaded	O
by	O
smaller	O
Trojans	O
that	O
have	O
leveraged	O
the	O
access	O
privileges	O
.	O

And	O
our	O
researchers	O
estimate	O
that	O
in	O
every	O
10	O
Android	B-System
users	O
1	O
was	O
attacked	O
by	O
either	O
one	O
or	O
several	O
of	O
those	O
Trojans	O
during	O
the	O
second	O
half	O
of	O
2015	O
,	O
so	O
there	O
are	O
millions	O
of	O
devices	O
with	O
a	O
huge	O
possibility	O
of	O
being	O
infected	O
with	O
Triada	B-Malware
.	O

So	O
,	O
what	O
can	O
you	O
do	O
to	O
protect	O
yourself	O
from	O
this	O
stealthy	O
beast	O
?	O

1	O
.	O

Never	O
forget	O
to	O
update	O
your	O
system	O
.	O

It	O
turns	O
out	O
that	O
those	O
smaller	O
Trojans	O
face	O
serious	O
problems	O
trying	O
to	O
get	O
root	O
access	O
on	O
Android	B-System
4.4.4	I-System
and	O
above	O
,	O
because	O
a	O
lot	O
of	O
vulnerabilities	O
were	O
patched	O
in	O
these	O
versions	O
.	O

So	O
if	O
you	O
have	O
Android	B-System
4.4.4	I-System
or	O
some	O
more	O
recent	O
version	O
of	O
this	O
OS	O
on	O
your	O
device	O
,	O
your	O
chances	O
of	O
getting	O
infected	O
with	O
Triada	B-Malware
are	O
significantly	O
lower	O
.	O

Yet	O
our	O
statistics	O
says	O
that	O
about	O
60	O
%	O
of	O
Android	B-System
users	O
are	O
still	O
sitting	O
with	O
Android	B-System
4.4.2	I-System
and	I-System
below	I-System
.	O

Triada	B-Malware
:	O
organized	O
crime	O
on	O
Android	B-System
2	O
.	O

Better	O
not	O
to	O
take	O
any	O
chances	O
at	O
all	O
,	O
no	O
matter	O
which	O
version	O
of	O
the	O
OS	O
you	O
use	O
.	O

So	O
we	O
recommend	O
installing	O
an	O
anti-virus	O
solution	O
on	O
your	O
Android	O
device	O
.	O

Kaspersky	B-System
Internet	I-System
Security	I-System
for	O
Android	B-System
detects	O
all	O
three	O
of	O
Triada	B-Malware
’	O
s	O
modules	O
,	O
so	O
it	O
can	O
save	O
your	O
money	O
from	O
cybercriminals	O
that	O
are	O
behind	O
Triada	B-Malware
.	O

Just	O
don	O
’	O
t	O
forget	O
that	O
the	O
scan	O
does	O
not	O
run	O
automatically	O
in	O
the	O
free	O
version	O
.	O

But	O
all	O
in	O
all	O
Triada	B-Malware
is	O
yet	O
another	O
example	O
of	O
a	O
really	O
bad	O
trend	O
:	O
malware	O
developers	O
are	O
taking	O
Android	B-System
seriously	O
,	O
and	O
the	O
latest	O
samples	O
are	O
almost	O
as	O
complex	O
and	O
hard	O
to	O
withstand	O
,	O
as	O
their	O
Windows-based	B-System
kin	O
.	O

The	O
only	O
good	O
way	O
to	O
fight	O
all	O
these	O
threats	O
is	O
to	O
be	O
proactive	O
,	O
and	O
so	O
a	O
good	O
security	O
solution	O
is	O
a	O
must	O
.	O

TrickBot	B-Malware
Pushing	O
a	O
2FA	O
Bypass	O
App	O
to	O
Bank	O
Customers	O
in	O
Germany	O
March	O
24	O
,	O
2020	O
IBM	B-Organization
X-Force	I-Organization
researchers	O
analyzed	O
an	O
Android	B-System
malware	O
app	O
that	O
’	O
s	O
likely	O
being	O
pushed	O
to	O
infected	O
users	O
by	O
the	O
TrickBot	B-Malware
Trojan	O
.	O

This	O
app	O
,	O
dubbed	O
“	O
TrickMo	B-Malware
”	O
by	O
our	O
team	O
,	O
is	O
designed	O
to	O
bypass	O
second	O
factor	O
and	O
strong	O
authentication	O
pushed	O
to	O
bank	O
customers	O
when	O
they	O
need	O
to	O
authorize	O
a	O
transaction	O
.	O

While	O
it	O
’	O
s	O
not	O
the	O
first	O
of	O
its	O
kind	O
,	O
this	O
Android	B-System
malware	O
app	O
is	O
more	O
sophisticated	O
than	O
similar	O
apps	O
and	O
possesses	O
interesting	O
features	O
that	O
enable	O
its	O
operators	O
to	O
steal	O
transaction	O
authorization	O
codes	O
from	O
victims	O
who	O
download	O
the	O
app	O
.	O

According	O
to	O
our	O
research	O
,	O
TrickMo	B-Malware
is	O
still	O
under	O
active	O
development	O
as	O
we	O
expect	O
to	O
see	O
frequent	O
changes	O
and	O
updates	O
.	O

While	O
it	O
can	O
be	O
used	O
anywhere	O
and	O
target	O
any	O
bank	O
or	O
region	O
,	O
at	O
this	O
time	O
,	O
we	O
are	O
seeing	O
it	O
deployed	O
specifically	O
in	O
Germany	O
.	O

Germany	O
is	O
one	O
of	O
the	O
first	O
attack	O
turfs	O
TrickBot	B-Malware
spread	O
to	O
when	O
it	O
first	O
emerged	O
in	O
2016	O
.	O

In	O
2020	O
,	O
it	O
appears	O
that	O
TrickBot	B-Malware
’	O
s	O
vast	O
bank	O
fraud	O
is	O
an	O
ongoing	O
project	O
that	O
helps	O
the	O
gang	O
monetize	O
compromised	O
accounts	O
.	O

First	O
Signs	O
in	O
September	O
2019	O
In	O
September	O
2019	O
,	O
a	O
tweet	O
by	O
CERT-Bund	B-Organization
caught	O
the	O
attention	O
of	O
the	O
IBM	B-Organization
Trusteer	I-Organization
Mobile	I-Organization
Security	I-Organization
Research	I-Organization
team	O
.	O

The	O
tweet	O
stated	O
that	O
TrickBot	B-Malware
,	O
a	O
well-known	O
banking	O
Trojan	O
owned	O
by	O
an	O
organized	O
cybercrime	O
gang	O
,	O
uses	O
man-in-the-browser	O
(	O
MITB	O
)	O
web	O
injects	O
in	O
online	O
banking	O
sessions	O
to	O
ask	O
infected	O
users	O
for	O
their	O
mobile	O
phone	O
number	O
and	O
device	O
type	O
.	O

Machine	O
translation	O
of	O
this	O
tweet	O
reads	O
:	O
“	O
Watch	O
out	O
for	O
online	O
banking	O
:	O
Emotet	B-Malware
reloads	O
TrickBot	B-Malware
.	O

On	O
infected	O
PCs	O
,	O
TrickBot	B-Malware
displays	O
a	O
query	O
for	O
the	O
mobile	O
phone	O
number	O
and	O
the	O
device	O
type	O
used	O
for	O
banking	O
and	O
then	O
prompts	O
users	O
to	O
install	O
an	O
alleged	O
security	O
app.	O
”	O
When	O
banking	O
Trojans	O
ask	O
for	O
this	O
type	O
of	O
information	O
,	O
it	O
usually	O
means	O
the	O
next	O
step	O
will	O
be	O
an	O
attempt	O
to	O
infect	O
the	O
victim	O
’	O
s	O
mobile	O
device	O
.	O

Our	O
team	O
went	O
ahead	O
and	O
hunted	O
for	O
samples	O
of	O
the	O
app	O
and	O
analyzed	O
it	O
in	O
our	O
labs	O
.	O

In	O
this	O
analysis	O
,	O
we	O
get	O
into	O
the	O
capabilities	O
of	O
the	O
new	O
variant	O
and	O
what	O
we	O
found	O
to	O
be	O
a	O
“	O
kill	O
switch	O
”	O
that	O
can	O
eliminate	O
the	O
malware	O
remotely	O
from	O
an	O
infected	O
device	O
.	O

Desktop	O
Trojans	O
and	O
Their	O
Mobile	O
Component	O
The	O
process	O
by	O
which	O
Trojans	O
attempt	O
to	O
infect	O
mobile	O
devices	O
is	O
at	O
least	O
a	O
decade	O
old	O
.	O

Usually	O
,	O
when	O
users	O
are	O
already	O
infected	O
with	O
malware	O
like	O
TrickBot	B-Malware
on	O
their	O
desktop	O
,	O
they	O
will	O
see	O
a	O
web	O
injection	O
asking	O
for	O
their	O
mobile	O
device	O
operating	O
system	O
(	O
OS	O
)	O
type	O
and	O
phone	O
number	O
.	O

Next	O
,	O
if	O
they	O
indicate	O
that	O
they	O
use	O
an	O
Android-based	B-System
device	O
,	O
the	O
Trojan	O
,	O
impersonating	O
their	O
bank	O
with	O
web	O
injections	O
,	O
fools	O
the	O
victim	O
into	O
installing	O
a	O
fake	O
security	O
app	O
.	O

The	O
supposed	O
purpose	O
of	O
that	O
app	O
is	O
to	O
obtain	O
and	O
use	O
a	O
required	O
“	O
security	O
code	O
”	O
to	O
log	O
in	O
to	O
their	O
online	O
banking	O
site	O
.	O

Our	O
research	O
team	O
analyzed	O
the	O
malicious	O
Android	B-System
application	O
that	O
is	O
most	O
likely	O
being	O
spread	O
by	O
TrickBot	B-Malware
and	O
dubbed	O
it	O
“	O
TrickMo.	B-Malware
”	O
Targeting	O
users	O
in	O
Germany	O
at	O
this	O
time	O
,	O
TrickMo	B-Malware
is	O
the	O
latest	O
variation	O
in	O
the	O
transaction	O
authentication	O
number	O
(	O
TAN	O
)	O
-stealing	O
malware	O
category	O
.	O

Its	O
main	O
capabilities	O
include	O
:	O
Stealing	O
personal	O
device	O
information	O
Intercepting	O
SMS	O
messages	O
Recording	O
targeted	O
applications	O
for	O
one-time	O
password	O
(	O
TAN	O
)	O
Lockdown	O
of	O
the	O
phone	O
Stealing	O
pictures	O
from	O
the	O
device	O
Self-destruction	O
and	O
removal	O
As	O
banks	O
release	O
more	O
advanced	O
security	O
measures	O
,	O
banking	O
malware	O
evolves	O
to	O
keep	O
up	O
with	O
the	O
perpetual	O
arms	O
race	O
.	O

From	O
our	O
analysis	O
of	O
the	O
TrickMo	B-Malware
mobile	O
malware	O
,	O
it	O
is	O
apparent	O
that	O
TrickMo	B-Malware
is	O
designed	O
to	O
break	O
the	O
newest	O
methods	O
of	O
OTP	O
and	O
,	O
specifically	O
,	O
TAN	O
codes	O
often	O
used	O
in	O
Germany	O
.	O

Among	O
the	O
various	O
features	O
we	O
discuss	O
in	O
this	O
post	O
,	O
we	O
believe	O
that	O
TrickMo	B-Malware
’	O
s	O
most	O
significant	O
novelty	O
is	O
an	O
app	O
recording	O
feature	O
,	O
which	O
gives	O
it	O
the	O
ability	O
to	O
overcome	O
the	O
newer	O
pushTAN	O
app	O
validations	O
used	O
by	O
German	O
banks	O
.	O

In	O
the	O
analysis	O
that	O
follows	O
,	O
we	O
describe	O
in	O
detail	O
the	O
capabilities	O
of	O
this	O
new	O
variant	O
and	O
a	O
“	O
kill	O
switch	O
”	O
that	O
can	O
remotely	O
eliminate	O
the	O
malware	O
from	O
a	O
mobile	O
device	O
.	O

Why	O
Do	O
Desktop	O
Trojans	O
Use	O
a	O
Mobile	O
Component	O
?	O

About	O
a	O
decade	O
ago	O
,	O
attackers	O
wielding	O
banking	O
Trojans	O
could	O
simply	O
use	O
stolen	O
credentials	O
to	O
access	O
a	O
victim	O
’	O
s	O
online	O
banking	O
account	O
and	O
perform	O
money	O
transfers	O
.	O

As	O
a	O
countermeasure	O
,	O
financial	O
institutions	O
introduced	O
various	O
second	O
factor	O
authentication	O
(	O
2FA	O
)	O
methods	O
.	O

One	O
method	O
,	O
which	O
was	O
popular	O
in	O
Germany	O
,	O
is	O
known	O
as	O
mobile	O
TAN	O
(	O
mTAN	O
)	O
.	O

It	O
was	O
implemented	O
by	O
sending	O
an	O
SMS	O
message	O
containing	O
a	O
one-time	O
password	O
(	O
OTP	O
)	O
to	O
the	O
client	O
’	O
s	O
mobile	O
device	O
.	O

The	O
transaction	O
would	O
only	O
be	O
authorized	O
after	O
the	O
client	O
enters	O
the	O
TAN	O
into	O
the	O
online	O
banking	O
website	O
in	O
their	O
browser	O
.	O

Keep	O
in	O
mind	O
that	O
while	O
this	O
case	O
is	O
about	O
TANs	O
,	O
it	O
can	O
be	O
any	O
OTP	O
,	O
depending	O
on	O
which	O
bank	O
is	O
being	O
targeted	O
.	O

Meanwhile	O
,	O
desktop	O
banking	O
Trojans	O
developed	O
the	O
ability	O
to	O
execute	O
various	O
social	O
engineering	O
schemes	O
by	O
using	O
web	O
injections	O
,	O
a	O
method	O
that	O
alters	O
the	O
content	O
presented	O
to	O
the	O
infected	O
victim	O
in	O
their	O
browser	O
.	O

In	O
some	O
cases	O
,	O
sophisticated	O
web	O
injects	O
were	O
used	O
to	O
trick	O
victims	O
into	O
entering	O
their	O
2FA	O
codes	O
directly	O
into	O
the	O
web	O
forms	O
controlled	O
by	O
the	O
malware	O
to	O
eliminate	O
the	O
need	O
for	O
the	O
mobile	O
malware	O
component	O
.	O

But	O
attackers	O
were	O
still	O
constantly	O
looking	O
for	O
new	O
methods	O
to	O
steal	O
TANs	O
.	O

Around	O
2011	O
,	O
the	O
infamous	O
Zeus	B-Malware
Trojan	I-Malware
started	O
using	O
web	O
injects	O
that	O
tricked	O
users	O
into	O
downloading	O
a	O
mobile	O
component	O
called	O
“	O
ZitMo	B-Malware
”	O
(	O
Zeus	B-Malware
in	O
the	O
Mobile	O
)	O
.	O

This	O
was	O
used	O
to	O
bypass	O
2FA	O
methods	O
by	O
intercepting	O
the	O
SMS	O
messages	O
coming	O
from	O
the	O
bank	O
and	O
stealing	O
the	O
mTANs	O
without	O
the	O
victim	O
’	O
s	O
knowledge	O
.	O

Many	O
other	O
banking	O
malware	O
families	O
followed	O
suit	O
and	O
released	O
their	O
own	O
Android	O
malware	O
components	O
designed	O
to	O
steal	O
those	O
OTPs	O
and	O
TANs	O
.	O

From	O
mTAN	O
to	O
pushTAN	O
In	O
the	O
past	O
few	O
years	O
,	O
some	O
banks	O
in	O
Europe	O
,	O
especially	O
in	O
Germany	O
,	O
stopped	O
using	O
SMS-based	O
authentication	O
and	O
switched	O
to	O
dedicated	O
pushTAN	O
applications	O
for	O
2FA	O
schemes	O
.	O

Instead	O
of	O
relying	O
on	O
SMS	O
messages	O
,	O
which	O
can	O
be	O
easily	O
intercepted	O
by	O
third-party	O
apps	O
,	O
these	O
applications	O
started	O
using	O
push	O
notifications	O
for	O
users	O
,	O
containing	O
the	O
transaction	O
details	O
and	O
the	O
TAN	O
.	O

The	O
pushTAN	O
method	O
has	O
a	O
clear	O
advantage	O
:	O
It	O
improves	O
security	O
by	O
mitigating	O
the	O
risk	O
of	O
SIM	O
swapping	O
attacks	O
and	O
SMS	O
stealers	O
.	O

TrickMo	B-Malware
Calls	O
pushTAN	O
The	O
pushTAN	O
method	O
is	O
a	O
hurdle	O
for	O
malware	O
apps	O
that	O
may	O
reside	O
on	O
the	O
same	O
device	O
,	O
and	O
it	O
’	O
s	O
particularly	O
challenging	O
for	O
mobile	O
malware	O
due	O
to	O
Android	B-System
’	O
s	O
application	O
sandbox	O
.	O

This	O
feature	O
is	O
designed	O
to	O
block	O
one	O
application	O
from	O
accessing	O
the	O
data	O
of	O
other	O
applications	O
without	O
rooting	O
the	O
device	O
.	O

To	O
get	O
around	O
this	O
challenge	O
,	O
TrickMo	B-Malware
’	O
s	O
developers	O
added	O
some	O
new	O
features	O
to	O
steal	O
TANs	O
using	O
screen	O
video	O
recording	O
and	O
screen	O
data	O
scraping	O
.	O

The	O
Root	O
of	O
All	O
(	O
Android	B-System
)	O
Evil	O
So	O
how	O
does	O
TrickMo	B-Malware
get	O
around	O
these	O
security	O
features	O
?	O

It	O
abuses	O
accessibility	O
services	O
.	O

Android	B-System
’	O
s	O
accessibility	O
services	O
were	O
originally	O
developed	O
by	O
Google	B-Organization
for	O
the	O
benefit	O
of	O
users	O
with	O
disabilities	O
.	O

Any	O
app	O
can	O
ask	O
for	O
accessibility	O
permissions	O
and	O
implement	O
features	O
such	O
as	O
screen	O
reading	O
,	O
changing	O
sizes	O
and	O
colors	O
of	O
objects	O
,	O
hearing	O
enhancements	O
,	O
replacing	O
touch	O
with	O
other	O
forms	O
of	O
control	O
and	O
more	O
.	O

In	O
recent	O
years	O
,	O
some	O
malicious	O
Android	B-System
applications	O
abused	O
these	O
accessibility	O
services	O
in	O
various	O
attack	O
scenarios	O
.	O

Once	O
on	O
the	O
device	O
,	O
as	O
installed	O
by	O
a	O
duped	O
user	O
,	O
the	O
TrickMo	B-Malware
component	O
opens	O
and	O
sends	O
an	O
intent	O
to	O
start	O
the	O
accessibility	O
settings	O
activity	O
,	O
coercing	O
the	O
user	O
to	O
grant	O
it	O
with	O
accessibility	O
permissions	O
.	O

Then	O
,	O
it	O
uses	O
the	O
accessibility	O
service	O
for	O
its	O
malicious	O
operations	O
,	O
some	O
of	O
which	O
include	O
:	O
Preventing	O
the	O
user	O
from	O
uninstalling	O
the	O
app	O
Becoming	O
the	O
default	O
SMS	O
app	O
by	O
changing	O
device	O
settings	O
Monitoring	O
the	O
currently	O
running	O
application	O
(	O
s	O
)	O
Scraping	O
on-screen	O
text	O
Android	B-System
operating	O
systems	O
include	O
many	O
dialog	O
screens	O
that	O
require	O
the	O
denial	O
,	O
or	O
approval	O
,	O
of	O
app	O
permissions	O
and	O
actions	O
that	O
have	O
to	O
receive	O
input	O
from	O
the	O
user	O
by	O
tapping	O
a	O
button	O
on	O
the	O
screen	O
.	O

TrickMo	B-Malware
uses	O
accessibility	O
services	O
to	O
identify	O
and	O
control	O
some	O
of	O
these	O
screens	O
and	O
make	O
its	O
own	O
choices	O
before	O
giving	O
the	O
user	O
a	O
chance	O
to	O
react	O
.	O

In	O
the	O
image	O
below	O
,	O
we	O
see	O
the	O
malware	O
function	O
that	O
detects	O
such	O
dialogs	O
when	O
they	O
are	O
presented	O
to	O
the	O
user	O
,	O
asking	O
them	O
to	O
tap	O
an	O
option	O
based	O
on	O
predefined	O
choices	O
.	O

TrickMo	B-Malware
’	O
s	O
Persistence	O
Capabilities	O
When	O
it	O
comes	O
to	O
Android-based	B-System
devices	O
,	O
many	O
applications	O
must	O
find	O
a	O
way	O
to	O
run	O
on	O
the	O
device	O
after	O
a	O
system	O
reboot	O
.	O

The	O
most	O
common	O
way	O
to	O
achieve	O
this	O
is	O
by	O
creating	O
a	O
broadcast	O
receiver	O
that	O
is	O
registered	O
to	O
the	O
“	O
android.intent.action.BOOT_COMPLETED	B-Indicator
”	O
broadcast	O
action	O
and	O
adding	O
code	O
that	O
boots	O
the	O
application	O
when	O
the	O
broadcast	O
is	O
fired	O
.	O

This	O
instruction	O
is	O
especially	O
important	O
for	O
malware	O
that	O
tries	O
to	O
avoid	O
user	O
interaction	O
by	O
running	O
in	O
the	O
background	O
as	O
a	O
service	O
.	O

But	O
TrickMo	B-Malware
does	O
things	O
differently	O
.	O

Instead	O
of	O
running	O
its	O
service	O
only	O
at	O
boot	O
time	O
,	O
it	O
registers	O
a	O
receiver	O
that	O
listens	O
to	O
the	O
“	O
android.intent.action.SCREEN_ON	B-Indicator
”	O
and	O
“	O
android.provider.Telephony.SMS_DELIVER	B-Indicator
”	O
broadcast	O
actions	O
.	O

It	O
then	O
uses	O
the	O
AlarmManager	B-System
to	O
set	O
a	O
pending	O
intent	O
that	O
will	O
run	O
its	O
own	O
service	O
after	O
a	O
predefined	O
interval	O
.	O

In	O
other	O
words	O
,	O
TrickMo	B-Malware
’	O
s	O
service	O
will	O
start	O
either	O
after	O
the	O
device	O
becomes	O
interactive	O
or	O
after	O
a	O
new	O
SMS	O
message	O
is	O
received	O
.	O

Tricky	O
Configurations	O
TrickMo	B-Malware
uses	O
the	O
shared	O
preferences	O
mechanism	O
to	O
store	O
settings	O
and	O
data	O
that	O
the	O
malware	O
uses	O
at	O
runtime	O
.	O

Some	O
of	O
the	O
settings	O
are	O
Boolean	O
values	O
that	O
act	O
as	O
switches	O
.	O

They	O
represent	O
features	O
and	O
can	O
be	O
turned	O
on	O
and	O
off	O
from	O
the	O
command-and-control	O
(	O
C	O
&	O
C	O
)	O
server	O
or	O
by	O
an	O
SMS	O
message	O
,	O
effectively	O
instructing	O
the	O
malware	O
to	O
execute	O
certain	O
tasks	O
.	O

Some	O
of	O
the	O
settings	O
include	O
:	O
The	O
URL	O
of	O
the	O
C	O
&	O
C	O
server	O
Service	O
wake-up	O
intervals	O
Important	O
package	O
names	O
Accessibility	O
permissions	O
status	O
Lockdown	O
screen	O
status	O
Recording	O
status	O
SMS	O
app	O
status	O
Kill	O
switch	O
status	O
Stealth	O
To	O
keep	O
its	O
resources	O
safer	O
and	O
make	O
analysis	O
more	O
difficult	O
for	O
researchers	O
,	O
TrickMo	B-Malware
uses	O
an	O
obfuscator	O
to	O
scramble	O
the	O
names	O
of	O
its	O
functions	O
,	O
classes	O
and	O
variables	O
.	O

A	O
TrickMo	B-Malware
version	O
from	O
January	O
2020	O
contained	O
code	O
that	O
checks	O
if	O
the	O
app	O
is	O
running	O
on	O
a	O
rooted	O
device	O
or	O
an	O
emulator	O
to	O
prevent	O
analysis	O
.	O

As	O
an	O
example	O
,	O
in	O
the	O
two	O
images	O
below	O
,	O
we	O
can	O
see	O
the	O
encrypted	O
and	O
decrypted	O
shared	O
preferences	O
file	O
,	O
which	O
is	O
encrypted	O
using	O
the	O
java	O
“	O
PBEWithMD5AndDES	O
”	O
algorithm	O
.	O

C	O
&	O
C	O
Communications	O
Exfiltrating	O
Device	O
Data	O
To	O
communicate	O
with	O
its	O
master	O
,	O
TrickMo	B-Malware
’	O
s	O
code	O
contains	O
a	O
hardcoded	O
URL	O
of	O
the	O
C	O
&	O
C	O
server	O
.	O

When	O
it	O
runs	O
,	O
it	O
periodically	O
connects	O
to	O
its	O
designated	O
server	O
via	O
an	O
unencrypted	O
HTTP	O
request	O
and	O
sends	O
over	O
a	O
JSON	O
object	O
that	O
contains	O
data	O
gleaned	O
from	O
the	O
victim	O
’	O
s	O
phone	O
.	O

The	O
stolen	O
parameters	O
follow	O
:	O
ID	O
IMSI	O
IMEI	O
Phone	O
number	O
Operator	O
AID	O
Model	O
Brand	O
Version	O
Build	O
Battery	O
percentage	O
Wi-Fi	O
connection	O
state	O
Wake	O
time	O
Are	O
logs	O
enabled	O
?	O

Is	O
the	O
malware	O
already	O
set	O
as	O
the	O
default	O
SMS	O
application	O
?	O

[	O
True/False	O
]	O
Signal	O
strength	O
Screen	O
active	O
[	O
True/False	O
]	O
Orientation	O
Was	O
accessibility	O
permission	O
granted	O
?	O

[	O
True/False	O
]	O
Screen	O
size	O
List	O
of	O
the	O
installed	O
applications	O
SMS	O
messages	O
saved	O
on	O
the	O
device	O
It	O
is	O
not	O
uncommon	O
for	O
banking	O
malware	O
to	O
harvest	O
extensive	O
amounts	O
of	O
data	O
from	O
the	O
victim	O
’	O
s	O
device	O
.	O

The	O
collected	O
data	O
can	O
then	O
be	O
used	O
to	O
generate	O
a	O
unique	O
identifier	O
of	O
the	O
bot	O
or	O
for	O
monetization	O
purposes	O
.	O

It	O
can	O
also	O
be	O
sold	O
on	O
the	O
dark	O
web	O
and	O
used	O
in	O
various	O
spoofing	O
attacks	O
.	O

For	O
example	O
,	O
since	O
some	O
banks	O
use	O
anti-fraud	O
solutions	O
that	O
only	O
check	O
device	O
fingerprinting	O
,	O
fraudsters	O
can	O
use	O
the	O
collected	O
information	O
to	O
perform	O
fraudulent	O
transactions	O
from	O
a	O
device	O
that	O
mimics	O
that	O
same	O
fingerprint	O
.	O

Stealing	O
and	O
Concealing	O
SMS	O
Messages	O
As	O
some	O
banks	O
still	O
use	O
SMS-based	O
transaction	O
authorization	O
,	O
TrickMo	B-Malware
is	O
configured	O
to	O
automatically	O
steal	O
all	O
SMS	O
messages	O
that	O
are	O
stored	O
on	O
the	O
device	O
.	O

Once	O
in	O
a	O
while	O
,	O
it	O
sends	O
a	O
packet	O
to	O
its	O
C	O
&	O
C	O
server	O
containing	O
the	O
collected	O
device	O
data	O
along	O
with	O
all	O
the	O
saved	O
SMS	O
messages	O
.	O

Since	O
it	O
can	O
use	O
the	O
accessibility	O
service	O
to	O
become	O
the	O
default	O
SMS	O
app	O
,	O
it	O
can	O
also	O
delete	O
the	O
SMS	O
messages	O
so	O
only	O
the	O
attackers	O
can	O
see	O
them	O
.	O

In	O
the	O
image	O
below	O
,	O
we	O
can	O
see	O
a	O
packet	O
that	O
was	O
sent	O
to	O
the	O
attacker	O
’	O
s	O
C	O
&	O
C	O
containing	O
collected	O
information	O
along	O
with	O
stolen	O
SMS	O
data	O
.	O

A	O
Communication	O
Channel	O
via	O
Stolen	O
SMS	O
In	O
addition	O
,	O
TrickMo	B-Malware
has	O
an	O
automatic	O
mechanism	O
to	O
send	O
SMS	O
messages	O
to	O
its	O
C	O
&	O
C	O
server	O
.	O

In	O
some	O
cases	O
,	O
it	O
uses	O
this	O
mechanism	O
to	O
send	O
log	O
data	O
of	O
important	O
actions	O
.	O

It	O
can	O
save	O
an	O
SMS	O
message	O
on	O
the	O
device	O
,	O
marking	O
with	O
“	O
internal	O
”	O
in	O
the	O
phone	O
number	O
field	O
.	O

The	O
SMS	O
message	O
will	O
be	O
instantly	O
sent	O
to	O
the	O
server	O
,	O
informing	O
the	O
malware	O
operator	O
of	O
executed	O
tasks	O
.	O

In	O
the	O
image	O
below	O
,	O
we	O
see	O
a	O
log	O
TrickMo	B-Malware
sent	O
to	O
the	O
attacker	O
upon	O
becoming	O
the	O
default	O
SMS	O
app	O
.	O

If	O
the	O
malware	O
successfully	O
became	O
the	O
default	O
SMS	O
app	O
,	O
it	O
sends	O
the	O
words	O
“	O
the	O
app	O
has	O
been	O
replaced	O
”	O
in	O
Russian	O
.	O

If	O
the	O
original	O
SMS	O
app	O
has	O
been	O
restored	O
,	O
it	O
will	O
send	O
“	O
the	O
app	O
returned	O
to	O
its	O
original	O
place.	O
”	O
Controlling	O
TrickMo	B-Malware
TrickMo	B-Malware
’	O
s	O
operators	O
can	O
control	O
the	O
malware	O
via	O
two	O
channels	O
:	O
Through	O
its	O
C	O
&	O
C	O
via	O
a	O
plaintext	O
HTTP	O
protocol	O
using	O
JSON	O
objects	O
Through	O
encrypted	O
SMS	O
messages	O
There	O
are	O
predefined	O
commands	O
to	O
change	O
the	O
malware	O
’	O
s	O
configuration	O
and	O
make	O
it	O
execute	O
certain	O
tasks	O
.	O

Some	O
of	O
the	O
more	O
interesting	O
commands	O
include	O
:	O
SMS	O
Control	O
Update	O
the	O
address	O
of	O
the	O
C	O
&	O
C	O
server	O
—	O
SMS	O
starting	O
with	O
“	O
http	O
:	O
//	O
”	O
Send	O
AES-encrypted	O
SMS	O
message	O
back	O
to	O
sender	O
—	O
SMS	O
starting	O
with	O
“	O
sms	O
:	O
//	O
”	O
Update	O
service	O
wake-up	O
interval	O
—	O
“	O
2	O
”	O
Kill	O
switch	O
—	O
“	O
4	O
”	O
C	O
&	O
C	O
Control	O
Update	O
the	O
address	O
of	O
the	O
C	O
&	O
C	O
server	O
—	O
“	O
1	O
”	O
Update	O
service	O
wake-up	O
interval	O
—	O
“	O
2	O
”	O
Lock	O
the	O
screen	O
—	O
“	O
5	O
”	O
Display	O
a	O
picture	O
in	O
a	O
WebView	O
from	O
an	O
arbitrary	O
URL	O
—	O
“	O
11	O
”	O
Send	O
an	O
arbitrary	O
SMS	O
message	O
—	O
“	O
8	O
”	O
Steal	O
images	O

saved	O
on	O
the	O
device	O
—	O
“	O
12	O
”	O
and	O
“	O
13	O
”	O
Use	O
the	O
accessibility	O
service	O
to	O
become	O
the	O
default	O
SMS	O
app	O
—	O
“	O
6	O
”	O
Enable	O
recording	O
of	O
other	O
apps	O
—	O
“	O
15	O
”	O
Kill	O
switch	O
—	O
“	O
4	O
”	O
The	O
Lockdown	O
Screen	O
Most	O
thieves	O
don	O
’	O
t	O
want	O
to	O
be	O
caught	O
red-handed	O
as	O
they	O
steal	O
—	O
they	O
want	O
to	O
buy	O
some	O
time	O
to	O
get	O
away	O
with	O
the	O
loot	O
.	O

The	O
same	O
is	O
true	O
for	O
banking	O
malware	O
.	O

Desktop	O
banking	O
malware	O
often	O
blocks	O
the	O
user	O
’	O
s	O
access	O
to	O
their	O
banking	O
website	O
after	O
a	O
successful	O
transaction	O
by	O
using	O
web	O
injects	O
that	O
show	O
a	O
variety	O
of	O
“	O
service	O
unavailable	O
”	O
screens	O
.	O

TrickMo	B-Malware
is	O
no	O
different	O
;	O
the	O
goal	O
is	O
to	O
complete	O
the	O
operation	O
while	O
raising	O
minimal	O
suspicion	O
.	O

After	O
performing	O
a	O
fraudulent	O
action	O
,	O
stealing	O
the	O
OTP/mTAN	O
,	O
TrickMo	B-Malware
buys	O
some	O
time	O
by	O
activating	O
the	O
lock	O
screen	O
and	O
preventing	O
the	O
user	O
from	O
accessing	O
their	O
device	O
.	O

This	O
lockdown	O
screen	O
includes	O
two	O
parts	O
:	O
A	O
WebView	O
containing	O
a	O
background	O
picture	O
loaded	O
from	O
a	O
predefined	O
URL	O
.	O

This	O
background	O
image	O
likely	O
contains	O
a	O
fake	O
“	O
software	O
update	O
”	O
screen	O
.	O

A	O
lockdown	O
activity	O
,	O
which	O
is	O
a	O
transparent	O
window	O
shown	O
at	O
the	O
top	O
of	O
the	O
screen	O
that	O
contains	O
a	O
“	O
loading	O
”	O
cursor	O
.	O

This	O
screen	O
persists	O
on	O
the	O
screen	O
and	O
prevents	O
the	O
user	O
from	O
using	O
the	O
navigation	O
buttons	O
.	O

Due	O
to	O
TrickMo	B-Malware
’	O
s	O
persistence	O
implementation	O
mentioned	O
earlier	O
,	O
this	O
lockdown	O
screen	O
persists	O
after	O
a	O
restart	O
and	O
is	O
re-initiated	O
every	O
time	O
the	O
device	O
becomes	O
interactive	O
.	O

In	O
some	O
cases	O
,	O
TrickMo	B-Malware
may	O
use	O
this	O
feature	O
to	O
intercept	O
SMS	O
messages	O
without	O
the	O
knowledge	O
of	O
the	O
user	O
by	O
activating	O
the	O
lockdown	O
screen	O
and	O
intercepting	O
SMS	O
messages	O
in	O
the	O
background	O
.	O

Application	O
Recording	O
—	O
Stealing	O
OTPs	O
and	O
TANs	O
The	O
feature	O
that	O
makes	O
TrickMo	B-Malware
different	O
from	O
standard	O
SMS	O
stealers	O
is	O
its	O
unique	O
ability	O
to	O
record	O
the	O
screen	O
when	O
targeted	O
apps	O
are	O
running	O
.	O

This	O
feature	O
was	O
enabled	O
only	O
in	O
newer	O
versions	O
of	O
TrickMo	B-Malware
that	O
were	O
tailored	O
specifically	O
for	O
German	O
banks	O
and	O
use	O
a	O
special	O
application	O
for	O
implementing	O
TAN-based	O
2FA	O
.	O

The	O
application	O
recording	O
is	O
implemented	O
via	O
two	O
methods	O
:	O
Using	O
the	O
Android	B-System
MediaRecorder	O
class	O
to	O
capture	O
a	O
video	O
of	O
the	O
screen	O
when	O
the	O
targeted	O
application	O
is	O
presented	O
to	O
the	O
user	O
Using	O
the	O
accessibility	O
service	O
to	O
save	O
a	O
text	O
file	O
containing	O
the	O
data	O
of	O
all	O
the	O
objects	O
on	O
the	O
screen	O
Both	O
files	O
are	O
later	O
sent	O
to	O
the	O
C	O
&	O
C	O
server	O
of	O
the	O
attacker	O
.	O

In	O
the	O
following	O
image	O
,	O
we	O
can	O
see	O
how	O
the	O
malware	O
receives	O
a	O
JSON	O
object	O
from	O
the	O
C	O
&	O
C	O
server	O
containing	O
the	O
command	O
to	O
start	O
recording	O
,	O
the	O
targeted	O
apps	O
and	O
the	O
recorded	O
video	O
size	O
ratio	O
.	O

In	O
the	O
image	O
below	O
,	O
the	O
function	O
recursively	O
collects	O
all	O
the	O
text	O
data	O
from	O
the	O
child	O
nodes	O
of	O
each	O
accessibility	O
node	O
.	O

In	O
other	O
words	O
,	O
it	O
goes	O
through	O
every	O
object	O
on	O
the	O
screen	O
and	O
saves	O
its	O
text	O
data	O
.	O

A	O
TrickMo	B-Malware
Kill	O
Switch	O
One	O
of	O
the	O
most	O
interesting	O
features	O
of	O
the	O
TrickMo	B-Malware
malware	I-Malware
is	O
having	O
its	O
own	O
kill	O
switch	O
.	O

Kill	O
switches	O
are	O
used	O
by	O
many	O
malware	O
authors	O
to	O
remove	O
traces	O
from	O
a	O
device	O
after	O
a	O
successful	O
operation	O
.	O

Since	O
TrickMo	O
’	O
s	O
HTTP	B-Indicator
traffic	O
with	O
its	O
C	O
&	O
C	O
server	O
is	O
not	O
encrypted	O
,	O
it	O
can	O
easily	O
be	O
tampered	O
with	O
.	O

In	O
the	O
following	O
image	O
,	O
we	O
can	O
see	O
the	O
function	O
that	O
parses	O
the	O
commands	O
from	O
the	O
C	O
&	O
C	O
server	O
.	O

If	O
the	O
returned	O
JSON	O
object	O
has	O
the	O
“	O
4	O
”	O
key	O
,	O
it	O
will	O
turn	O
on	O
the	O
kill	O
switch	O
and	O
initiate	O
its	O
own	O
removal	O
by	O
sending	O
an	O
intent	O
and	O
seamlessly	O
confirming	O
the	O
uninstall	O
using	O
the	O
accessibility	O
service	O
,	O
all	O
without	O
the	O
victim	O
ever	O
noticing	O
anything	O
.	O

The	O
kill	O
switch	O
can	O
also	O
be	O
turned	O
on	O
by	O
SMS	O
.	O

This	O
is	O
a	O
bit	O
more	O
complicated	O
since	O
the	O
SMS	O
commands	O
are	O
encrypted	O
and	O
encoded	O
with	O
base64	O
.	O

The	O
encryption	O
algorithm	O
used	O
is	O
RSA	O
,	O
and	O
interestingly	O
,	O
the	O
authors	O
chose	O
to	O
use	O
the	O
private	O
key	O
for	O
decryption	O
and	O
leave	O
it	O
in	O
the	O
code	O
as	O
a	O
hardcoded	O
string	O
.	O

The	O
image	O
below	O
shows	O
the	O
function	O
that	O
parses	O
the	O
SMS	O
messages	O
,	O
decrypts	O
them	O
using	O
the	O
hardcoded	O
RSA	O
private	O
key	O
and	O
executes	O
the	O
commands	O
.	O

Having	O
analyzed	O
a	O
few	O
variants	O
of	O
the	O
malware	O
,	O
we	O
noticed	O
that	O
the	O
private	O
key	O
was	O
exposed	O
in	O
the	O
code	O
and	O
did	O
not	O
change	O
.	O

Therefore	O
,	O
our	O
team	O
managed	O
to	O
generate	O
the	O
public	O
key	O
and	O
craft	O
an	O
SMS	O
message	O
that	O
activated	O
the	O
kill	O
switch	O
.	O

This	O
means	O
that	O
the	O
malware	O
can	O
be	O
remotely	O
eliminated	O
by	O
an	O
SMS	O
message	O
.	O

Our	O
team	O
was	O
also	O
able	O
to	O
test	O
other	O
commands	O
in	O
the	O
lab	O
either	O
by	O
tampering	O
with	O
the	O
HTTP	O
traffic	O
from	O
the	O
C	O
&	O
C	O
or	O
by	O
sending	O
crafted	O
SMS	O
messages	O
.	O

Suspect	O
You	O
’	O
re	O
Infected	O
?	O

The	O
following	O
SMS	O
message	O
can	O
be	O
used	O
to	O
kill	O
the	O
sample	O
analyzed	O
in	O
this	O
research	O
and	O
all	O
other	O
variants	O
that	O
use	O
the	O
same	O
private	O
key	O
:	O
HrLbpr3x/htAVnAgYepBuH2xmFDb68TYTt7FwGn0ddGlQJv/hqsctL57ocFU0Oz3L+uhLcOGG7GVBAfHKL1TBQ==	O
Sending	O
this	O
SMS	O
will	O
trigger	O
TrickMo	B-Malware
’	O
s	O
kill	O
switch	O
by	O
sending	O
the	O
string	O
“	O
4	O
”	O
encrypted	O
with	O
the	O
generated	O
RSA	O
public	O
key	O
and	O
base64	O

encoded	O
.	O

Indicators	O
of	O
Compromise	O
(	O
IoCs	O
)	O
hxxp	B-Indicator
:	I-Indicator
//mcsoft365.com/c	I-Indicator
hxxp	I-Indicator
:	I-Indicator
//pingconnect.net/c	I-Indicator
Hashes	O
MD5	O
:	O
5c749c9fce8c41bf6bcc9bd8a691621b	B-Indicator
SHA256	O
:	O
284bd2d16092b4d13b6bc85d87950eb4c5e8cbba9af2a04d76d88da2f26c485c	B-Indicator
MD5	O
:	O
b264af5d2f3390e465052ab502b0726d	B-Indicator

SHA256	O
:	O
8ab1712ce9ca2d7952ab763d8a4872aa6a278c3f60dc13e0aebe59f50e6e30f6	B-Indicator
The	O
TrickMo	B-Malware
Factor	O
The	O
TrickBot	B-Malware
Trojan	I-Malware
was	O
one	O
of	O
the	O
most	O
active	O
banking	O
malware	O
strains	O
in	O
the	O
cybercrime	O
arena	O
in	O
2019	O
.	O

From	O
our	O
analysis	O
,	O
it	O
is	O
apparent	O
that	O
TrickMo	B-Malware
is	O
designed	O
to	O
help	O
TrickBot	B-Malware
break	O
the	O
most	O
recent	O
methods	O
of	O
TAN-based	O
authentication	O
.	O

One	O
of	O
the	O
most	O
significant	O
features	O
TrickMo	B-Malware
possesses	O
is	O
the	O
app	O
recording	O
feature	O
,	O
which	O
is	O
what	O
gives	O
TrickBot	B-Malware
the	O
ability	O
to	O
overcome	O
the	O
newer	O
pushTAN	O
app	O
validations	O
deployed	O
by	O
banks	O
.	O

SimBad	B-Malware
:	O
A	O
Rogue	O
Adware	O
Campaign	O
On	O
Google	B-System
Play	I-System
March	O
13	O
,	O
2019	O
Check	B-Organization
Point	I-Organization
researchers	O
from	O
the	O
Mobile	O
Threat	O
Team	O
have	O
discovered	O
a	O
new	O
adware	O
campaign	O
on	O
the	O
Google	B-System
Play	I-System
Store	I-System
.	O

This	O
particular	O
strain	O
of	O
Adware	O
was	O
found	O
in	O
206	O
applications	O
,	O
and	O
the	O
combined	O
download	O
count	O
has	O
reached	O
almost	O
150	O
million	O
.	O

Google	B-Organization
was	O
swiftly	O
notified	O
and	O
removed	O
the	O
infected	O
applications	O
from	O
the	O
Google	B-System
Play	I-System
Store	O
.	O

Inside	O
the	O
SDK	O
The	O
malware	O
resides	O
within	O
the	O
‘	O
RXDrioder	O
’	O
Software	O
Development	O
Kit	O
(	O
SDK	O
)	O
,	O
which	O
is	O
provided	O
by	O
‘	O
addroider	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
’	O
as	O
an	O
ad-related	O
SDK	O
.	O

We	O
believe	O
the	O
developers	O
were	O
scammed	O
to	O
use	O
this	O
malicious	O
SDK	O
,	O
unaware	O
of	O
its	O
content	O
,	O
leading	O
to	O
the	O
fact	O
that	O
this	O
campaign	O
was	O
not	O
targeting	O
a	O
specific	O
county	O
or	O
developed	O
by	O
the	O
same	O
developer	O
.	O

The	O
malware	O
has	O
been	O
dubbed	O
‘	O
SimBad	B-Malware
’	O
due	O
to	O
the	O
fact	O
that	O
a	O
large	O
portion	O
of	O
the	O
infected	O
applications	O
are	O
simulator	O
games	O
.	O

The	O
Infection	O
Chain	O
Once	O
the	O
user	O
downloads	O
and	O
installs	O
one	O
of	O
the	O
infected	O
applications	O
,	O
‘	O
SimBad	B-Malware
’	O
registers	O
itself	O
to	O
the	O
‘	O
BOOT_COMPLETE	O
’	O
and	O
‘	O
USER_PRESENT	O
’	O
intents	O
,	O
which	O
lets	O
‘	O
SimBad	B-Malware
’	O
to	O
perform	O
actions	O
after	O
the	O
device	O
has	O
finished	O
booting	O
and	O
while	O
the	O
user	O
is	O
using	O
his	O
device	O
respectively	O
.	O

After	O
installation	O
,	O
the	O
malware	O
connects	O
to	O
the	O
designated	O
Command	O
and	O
Control	O
(	O
C	O
&	O
C	O
)	O
server	O
,	O
and	O
receives	O
a	O
command	O
to	O
perform	O
.	O

‘	O
SimBad	B-Malware
’	O
comes	O
with	O
a	O
respected	O
list	O
of	O
capabilities	O
on	O
the	O
user	O
’	O
s	O
device	O
,	O
such	O
as	O
removing	O
the	O
icon	O
from	O
the	O
launcher	O
,	O
thus	O
making	O
it	O
harder	O
for	O
the	O
user	O
to	O
uninstall	O
,	O
start	O
to	O
display	O
background	O
ads	O
and	O
open	O
a	O
browser	O
with	O
a	O
given	O
URL	O
.	O

What	O
Does	O
SimBad	B-Malware
Do	O
?	O

‘	O
SimBad	B-Malware
’	O
has	O
capabilities	O
that	O
can	O
be	O
divided	O
into	O
three	O
groups	O
–	O
Show	O
Ads	O
,	O
Phishing	O
,	O
and	O
Exposure	O
to	O
other	O
applications	O
.	O

With	O
the	O
capability	O
to	O
open	O
a	O
given	O
URL	O
in	O
a	O
browser	O
,	O
the	O
actor	O
behind	O
‘	O
SimBad	B-Malware
’	O
can	O
generate	O
phishing	O
pages	O
for	O
multiple	O
platforms	O
and	O
open	O
them	O
in	O
a	O
browser	O
,	O
thus	O
performing	O
spear-phishing	O
attacks	O
on	O
the	O
user	O
.	O

With	O
the	O
capability	O
to	O
open	O
market	O
applications	O
,	O
such	O
as	O
Google	B-System
Play	I-System
and	O
9Apps	B-System
,	O
with	O
a	O
specific	O
keyword	O
search	O
or	O
even	O
a	O
single	O
application	O
’	O
s	O
page	O
,	O
the	O
actor	O
can	O
gain	O
exposure	O
for	O
other	O
threat	O
actors	O
and	O
increase	O
his	O
profits	O
.	O

The	O
actor	O
can	O
even	O
take	O
his	O
malicious	O
activities	O
to	O
the	O
next	O
level	O
by	O
installing	O
a	O
remote	O
application	O
from	O
a	O
designated	O
server	O
,	O
thus	O
allowing	O
him	O
to	O
install	O
new	O
malware	O
once	O
it	O
is	O
required	O
.	O

The	O
C	O
&	O
C	O
server	O
observed	O
in	O
this	O
campaign	O
is	O
‘	O
www	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
addroider.com	I-Indicator
’	O
.	O

This	O
server	O
runs	O
an	O
instance	O
of	O
‘	O
Parse	O
Server	O
’	O
(	O
source	O
on	O
GitHub	B-Organization
)	O
,	O
an	O
open	O
source	O
version	O
of	O
the	O
Parse	O
Backend	O
infrastructure	O
,	O
which	O
is	O
a	O
model	O
for	O
providing	O
web	O
app	O
and	O
mobile	O
app	O
developers	O
with	O
a	O
way	O
to	O
link	O
their	O
applications	O
to	O
backend	O
cloud	O
storage	O
and	O
APIs	O
exposed	O
by	O
back-end	O
applications	O
,	O
while	O
also	O
providing	O
features	O
such	O
as	O
user	O
management	O
,	O
push	O
notifications	O
and	O
more	O
.	O

The	O
domain	O
‘	O
addroider	B-Indicator
[	I-Indicator
.	I-Indicator

]	I-Indicator
com	I-Indicator
’	O
was	O
registered	O
via	O
GoDaddy	B-Organization
,	O
and	O
uses	O
privacy	O
protection	O
service	O
.	O

While	O
accessing	O
the	O
domain	O
from	O
a	O
browser	O
you	O
get	O
a	O
login	O
page	O
very	O
similar	O
to	O
other	O
malware	O
panels	O
.	O

The	O
‘	O
Register	O
’	O
and	O
‘	O
Sign	O
Up	O
’	O
links	O
are	O
broken	O
and	O
‘	O
redirects	O
’	O
the	O
user	O
back	O
to	O
the	O
login	O
page	O
.	O

According	O
to	O
RiskIQ	B-System
’	O
s	O
PassiveTotal	O
,	O
the	O
domain	O
expired	O
7	O
months	O
ago	O
.	O

As	O
a	O
result	O
,	O
it	O
may	O
be	O
that	O
are	O
looking	O
into	O
a	O
compromised	O
,	O
parked	O
domain	O
that	O
was	O
initially	O
used	O
legitimately	O
,	O
but	O
is	O
now	O
participating	O
in	O
malicious	O
activities	O
.	O

With	O
the	O
capabilities	O
of	O
showing	O
out-of-scope	O
ads	O
,	O
exposing	O
the	O
user	O
to	O
other	O
applications	O
,	O
and	O
opening	O
a	O
URL	O
in	O
a	O
browser	O
,	O
‘	O
SimBad	B-Malware
’	O
acts	O
now	O
as	O
an	O
Adware	O
,	O
but	O
already	O
has	O
the	O
infrastructure	O
to	O
evolve	O
into	O
a	O
much	O
larger	O
threat	O
.	O
